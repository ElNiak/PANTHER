{
    "quic_server_test.ivy": [
        {
            "actions": {
                "line": 55,
                "action_name": "_finalize",
                "implementation": [
                    {
                        "line": 55,
                        "file": "quic_server_test.ivy",
                        "instruction": "    # chris TODO \n"
                    },
                    {
                        "line": 56,
                        "file": "quic_server_test.ivy",
                        "instruction": "    require is_no_error;\n"
                    },
                    {
                        "line": 57,
                        "file": "quic_server_test.ivy",
                        "instruction": "    require conn_total_data(the_cid) > 0;\n"
                    },
                    {
                        "line": 58,
                        "file": "quic_server_test.ivy",
                        "instruction": "    #call \n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": null,
                "exported": true,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "functions": [],
            "relations": []
        }
    ],
    "quic_transport_parameters.ivy": [
        {
            "ack_delay_exponent": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "exponent_8",
                        "type": "microsecs"
                    }
                ]
            },
            "active_connection_id_limit": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "stream_pos_32",
                        "type": "stream_pos"
                    }
                ]
            },
            "disable_active_migration": {
                "called_from": [],
                "attributes": []
            },
            "enable_time_stamp": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "stream_pos_32",
                        "type": "stream_pos"
                    }
                ]
            },
            "grease_quic_bit": {
                "called_from": [],
                "attributes": []
            },
            "initial_max_data": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "stream_pos_32",
                        "type": "stream_pos"
                    }
                ]
            },
            "initial_max_stream_data_bidi_local": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "stream_pos_32",
                        "type": "stream_pos"
                    }
                ]
            },
            "initial_max_stream_data_bidi_remote": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "stream_pos_32",
                        "type": "stream_pos"
                    }
                ]
            },
            "initial_max_stream_data_uni": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "stream_pos_32",
                        "type": "stream_pos"
                    }
                ]
            },
            "initial_max_stream_id_bidi": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "stream_id_16",
                        "type": "stream_id"
                    }
                ]
            },
            "initial_max_stream_id_uni": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "stream_id_16",
                        "type": "stream_id"
                    }
                ]
            },
            "initial_source_connection_id": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "scid",
                        "type": "cid"
                    }
                ]
            },
            "loss_bits": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "unknown",
                        "type": "stream_pos"
                    }
                ]
            },
            "max_ack_delay": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "exponent_8",
                        "type": "microsecs"
                    }
                ]
            },
            "max_idle_timeout": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "seconds_16",
                        "type": "microsecs"
                    }
                ]
            },
            "max_packet_size": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "stream_pos_16",
                        "type": "stream_pos"
                    }
                ]
            },
            "min_ack_delay": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "exponent_8",
                        "type": "microsecs"
                    }
                ]
            },
            "original_destination_connection_id": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "dcid",
                        "type": "cid"
                    }
                ]
            },
            "preferred_address": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "ip_addr",
                        "type": "ip.addr,"
                    },
                    {
                        "name": "ip_port",
                        "type": "ip.port,"
                    },
                    {
                        "name": "ip6_addr",
                        "type": "ipv6.addr,"
                    },
                    {
                        "name": "ip6_port",
                        "type": "ipv6.port,"
                    },
                    {
                        "name": "pcid_len",
                        "type": "stream_pos,"
                    },
                    {
                        "name": "pcid",
                        "type": "cid,"
                    },
                    {
                        "name": "pref_token",
                        "type": "ipv6.addr"
                    }
                ]
            },
            "retry_source_connection_id": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "rcid",
                        "type": "cid"
                    }
                ]
            },
            "stateless_reset_token": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "data_8",
                        "type": "ipv6.addr"
                    }
                ]
            },
            "transport_parameter": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "action set(p",
                        "type": "this,s"
                    },
                    {
                        "name": "destructor is_set(S",
                        "type": "trans_params_struct)"
                    },
                    {
                        "name": "destructor value(S",
                        "type": "trans_params_struct)"
                    },
                    {
                        "name": "action set(p",
                        "type": "ptype,s"
                    },
                    {
                        "name": "is_set(s)",
                        "type": "= true;"
                    },
                    {
                        "name": "value(s)",
                        "type": "= p;"
                    },
                    {
                        "name": "dcid",
                        "type": "cid"
                    }
                ]
            },
            "unknown_ignore": {
                "called_from": [],
                "attributes": []
            },
            "unknown_transport_parameter": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "unknown",
                        "type": "stream_pos"
                    }
                ]
            },
            "version_information": {
                "called_from": [],
                "attributes": [
                    {
                        "name": "chosen_version",
                        "type": "version,"
                    },
                    {
                        "name": "other_version",
                        "type": "versions_bv"
                    }
                ]
            }
        },
        {
            "functions": [
                {
                    "name": "initial_max_stream_data_uni_server_0rtt : stream_pos\n",
                    "comment": "",
                    "line": 226,
                    "file": "quic_transport_parameters.ivy"
                },
                {
                    "name": "initial_max_stream_data_bidi_remote_server_0rtt : stream_pos\n",
                    "comment": "",
                    "line": 227,
                    "file": "quic_transport_parameters.ivy"
                },
                {
                    "name": "initial_max_data_server_0rtt : stream_pos\n",
                    "comment": "",
                    "line": 228,
                    "file": "quic_transport_parameters.ivy"
                },
                {
                    "name": "initial_max_stream_data_bidi_local_server_0rtt : stream_pos\n",
                    "comment": "",
                    "line": 229,
                    "file": "quic_transport_parameters.ivy"
                },
                {
                    "name": "initial_max_stream_id_bidi_server_0rtt : stream_id\n",
                    "comment": "",
                    "line": 230,
                    "file": "quic_transport_parameters.ivy"
                },
                {
                    "name": "active_connection_id_limit_server_0rtt : stream_pos\n",
                    "comment": "",
                    "line": 231,
                    "file": "quic_transport_parameters.ivy"
                }
            ],
            "relations": []
        }
    ],
    "quic_frame.ivy": [
        {
            "actions": {
                "line": 1992,
                "action_name": "acti_coid_check",
                "implementation": [
                    {
                        "line": 1992,
                        "file": "quic_frame.ivy",
                        "instruction": "    ok := true;\n"
                    },
                    {
                        "line": 1993,
                        "file": "quic_frame.ivy",
                        "instruction": "    var max : stream_pos := 0;\n"
                    },
                    {
                        "line": 1994,
                        "file": "quic_frame.ivy",
                        "instruction": "    var tp := trans_params(scid);\n"
                    },
                    {
                        "line": 1995,
                        "file": "quic_frame.ivy",
                        "instruction": "    if active_connection_id_limit.is_set(tp) {\n"
                    },
                    {
                        "line": 1996,
                        "file": "quic_frame.ivy",
                        "instruction": "        max := active_connection_id_limit.value(tp).stream_pos_32;\n"
                    },
                    {
                        "line": 1997,
                        "file": "quic_frame.ivy",
                        "instruction": "        ok := count <= max;\n"
                    },
                    {
                        "line": 1998,
                        "file": "quic_frame.ivy",
                        "instruction": "    };\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "ok",
                    "type": "bool"
                },
                "action_parameters": [
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "count",
                        "type": "stream_pos"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 1821,
                "action_name": "enqueue_frame",
                "implementation": [
                    {
                        "line": 1821,
                        "file": "quic_frame.ivy",
                        "instruction": "    queued_frames(scid) := queued_frames(scid).append(f);\n"
                    },
                    {
                        "line": 1822,
                        "file": "quic_frame.ivy",
                        "instruction": "    num_queued_frames(scid) := queued_frames(scid).end;\n"
                    },
                    {
                        "line": 1823,
                        "file": "quic_frame.ivy",
                        "instruction": "    queued_level(scid) := e;\n"
                    },
                    {
                        "line": 1824,
                        "file": "quic_frame.ivy",
                        "instruction": "    if ~probing {\n"
                    },
                    {
                        "line": 1825,
                        "file": "quic_frame.ivy",
                        "instruction": "        queued_non_probing(scid) := true;\n"
                    },
                    {
                        "line": 1826,
                        "file": "quic_frame.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 1827,
                        "file": "quic_frame.ivy",
                        "instruction": "    if ~(f isa frame.ack){ #& ~(f isa frame.padding){\n"
                    },
                    {
                        "line": 1828,
                        "file": "quic_frame.ivy",
                        "instruction": "        queued_non_ack(scid) := true;\n"
                    },
                    {
                        "line": 1829,
                        "file": "quic_frame.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 1830,
                        "file": "quic_frame.ivy",
                        "instruction": "    if  f isa frame.path_challenge {\n"
                    },
                    {
                        "line": 1831,
                        "file": "quic_frame.ivy",
                        "instruction": "        queued_challenge(scid) := true;\n"
                    },
                    {
                        "line": 1832,
                        "file": "quic_frame.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 1833,
                        "file": "quic_frame.ivy",
                        "instruction": "    if (f isa frame.connection_close) | (f isa frame.application_close) {\n"
                    },
                    {
                        "line": 1834,
                        "file": "quic_frame.ivy",
                        "instruction": "        queued_close(scid) := true;\n"
                    },
                    {
                        "line": 1835,
                        "file": "quic_frame.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 1836,
                        "file": "quic_frame.ivy",
                        "instruction": "#Hamid\n"
                    },
                    {
                        "line": 1837,
                        "file": "quic_frame.ivy",
                        "instruction": "    if ~(f isa frame.ack) & ~(f isa frame.connection_close) { #& ~(f isa frame.padding){ & ~queued_ack_eliciting(scid)\n"
                    },
                    {
                        "line": 1838,
                        "file": "quic_frame.ivy",
                        "instruction": "\t    queued_ack_eliciting(scid) := true;\n"
                    },
                    {
                        "line": 1839,
                        "file": "quic_frame.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 1840,
                        "file": "quic_frame.ivy",
                        "instruction": "#Hamid\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "f",
                        "type": "frame"
                    },
                    {
                        "name": "e",
                        "type": "quic_packet_type"
                    },
                    {
                        "name": "probing",
                        "type": "bool"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame_rtt",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame_rtt",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 1844,
                "action_name": "enqueue_frame_rtt",
                "implementation": [
                    {
                        "line": 1844,
                        "file": "quic_frame.ivy",
                        "instruction": "    queued_frames_rtt(scid) := queued_frames_rtt(scid).append(f);\n"
                    },
                    {
                        "line": 1845,
                        "file": "quic_frame.ivy",
                        "instruction": "    num_queued_frames_rtt(scid) := queued_frames_rtt(scid).end;\n"
                    },
                    {
                        "line": 1846,
                        "file": "quic_frame.ivy",
                        "instruction": "    queued_level_rtt(scid) := e;\n"
                    },
                    {
                        "line": 1847,
                        "file": "quic_frame.ivy",
                        "instruction": "    if ~(f isa frame.ack){ #& ~(f isa frame.padding){\n"
                    },
                    {
                        "line": 1848,
                        "file": "quic_frame.ivy",
                        "instruction": "        queued_non_ack(scid) := true;\n"
                    },
                    {
                        "line": 1849,
                        "file": "quic_frame.ivy",
                        "instruction": "    };\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "f",
                        "type": "frame"
                    },
                    {
                        "name": "e",
                        "type": "quic_packet_type"
                    },
                    {
                        "name": "probing",
                        "type": "bool"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "frame_ack_name": "ack",
            "frame_ack_object": [
                {
                    "name": "gap",
                    "type": "pkt_num,"
                },
                {
                    "name": "ranges",
                    "type": "pkt_num"
                }
            ],
            "frame_ack_module": null,
            "actions": [
                {
                    "line": 655,
                    "action_name": "frame.ack.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 272,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 273,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 274,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        force_new_ack := true;\n"
                            },
                            {
                                "line": 275,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        #call handle_sending_ack(f.largest_acked);\n"
                            },
                            {
                                "line": 276,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    } \n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 657,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 658,
                                "file": "quic_frame.ivy",
                                "instruction": "            if _generating  {\n"
                            },
                            {
                                "line": 659,
                                "file": "quic_frame.ivy",
                                "instruction": "            \trequire ~(e = quic_packet_type.initial) & ~(e = quic_packet_type.handshake); #& ~(e = quic_packet_type.handshake)\n"
                            },
                            {
                                "line": 660,
                                "file": "quic_frame.ivy",
                                "instruction": "                require ~conn_closed(scid);\n"
                            },
                            {
                                "line": 661,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 662,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 663,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.handshake -> established_handshake_keys(scid);  # [4]\n"
                            },
                            {
                                "line": 664,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt -> established_1rtt_keys(scid);  # [4]\n"
                            },
                            {
                                "line": 665,
                                "file": "quic_frame.ivy",
                                "instruction": "            #Chris\n"
                            },
                            {
                                "line": 666,
                                "file": "quic_frame.ivy",
                                "instruction": "            #TODO ECN\n"
                            },
                            {
                                "line": 667,
                                "file": "quic_frame.ivy",
                                "instruction": "            require ~(e = quic_packet_type.version_negociation) & ~(e = quic_packet_type.retry) & ~(e = quic_packet_type.zero_rtt);\n"
                            },
                            {
                                "line": 668,
                                "file": "quic_frame.ivy",
                                "instruction": "            #Chris\n"
                            },
                            {
                                "line": 669,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 670,
                                "file": "quic_frame.ivy",
                                "instruction": "            var idx : frame.ack.range.idx := 0;\n"
                            },
                            {
                                "line": 671,
                                "file": "quic_frame.ivy",
                                "instruction": "            var last := f.largest_acked;\n"
                            },
                            {
                                "line": 672,
                                "file": "quic_frame.ivy",
                                "instruction": "            if max_acked(dcid,e) < last {\n"
                            },
                            {
                                "line": 673,
                                "file": "quic_frame.ivy",
                                "instruction": "                max_acked(dcid,e) := last;  # [3]\n"
                            },
                            {
                                "line": 674,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 675,
                                "file": "quic_frame.ivy",
                                "instruction": "            require f.ack_ranges.end > 0;\n"
                            },
                            {
                                "line": 676,
                                "file": "quic_frame.ivy",
                                "instruction": "            var some_new_ack := false;\n"
                            },
                            {
                                "line": 677,
                                "file": "quic_frame.ivy",
                                "instruction": "            while idx < f.ack_ranges.end {\n"
                            },
                            {
                                "line": 678,
                                "file": "quic_frame.ivy",
                                "instruction": "                var ack_range := f.ack_ranges.value(idx);\n"
                            },
                            {
                                "line": 679,
                                "file": "quic_frame.ivy",
                                "instruction": "                require idx > 0 -> ack_range.gap < last - 1;\n"
                            },
                            {
                                "line": 680,
                                "file": "quic_frame.ivy",
                                "instruction": "                var upper := last - ((ack_range.gap+2) if idx > 0 else 0);\n"
                            },
                            {
                                "line": 681,
                                "file": "quic_frame.ivy",
                                "instruction": "                require ack_range.ranges <= upper;\n"
                            },
                            {
                                "line": 682,
                                "file": "quic_frame.ivy",
                                "instruction": "                last := upper - ack_range.ranges;\n"
                            },
                            {
                                "line": 683,
                                "file": "quic_frame.ivy",
                                "instruction": "                var jdx := last;\n"
                            },
                            {
                                "line": 684,
                                "file": "quic_frame.ivy",
                                "instruction": "                while jdx <= upper {\n"
                            },
                            {
                                "line": 685,
                                "file": "quic_frame.ivy",
                                "instruction": "                        require sent_pkt(dcid,e,jdx);  # [1]\n"
                            },
                            {
                                "line": 686,
                                "file": "quic_frame.ivy",
                                "instruction": "                        if pkt_has_close(dcid,e,jdx) {\n"
                            },
                            {
                                "line": 687,
                                "file": "quic_frame.ivy",
                                "instruction": "                            conn_draining(scid) := true  # [5]\n"
                            },
                            {
                                "line": 688,
                                "file": "quic_frame.ivy",
                                "instruction": "                        };\n"
                            },
                            {
                                "line": 689,
                                "file": "quic_frame.ivy",
                                "instruction": "                        if ~acked_pkt(dcid,e,jdx) {\n"
                            },
                            {
                                "line": 690,
                                "file": "quic_frame.ivy",
                                "instruction": "                            some_new_ack := true;\n"
                            },
                            {
                                "line": 691,
                                "file": "quic_frame.ivy",
                                "instruction": "                        };\n"
                            },
                            {
                                "line": 692,
                                "file": "quic_frame.ivy",
                                "instruction": "                    acked_pkt(dcid,e,jdx) := true;\n"
                            },
                            {
                                "line": 693,
                                "file": "quic_frame.ivy",
                                "instruction": "                    jdx := jdx + 1\n"
                            },
                            {
                                "line": 694,
                                "file": "quic_frame.ivy",
                                "instruction": "                };\n"
                            },
                            {
                                "line": 695,
                                "file": "quic_frame.ivy",
                                "instruction": "    #           acked_pkt(dcid,N) := (last <= N & N <= upper) | acked_pkt(dcid,N);  # [2]\n"
                            },
                            {
                                "line": 696,
                                "file": "quic_frame.ivy",
                                "instruction": "                idx := idx.next;\n"
                            },
                            {
                                "line": 697,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 698,
                                "file": "quic_frame.ivy",
                                "instruction": "            if _generating {\n"
                            },
                            {
                                "line": 699,
                                "file": "quic_frame.ivy",
                                "instruction": "                require some_new_ack;\n"
                            },
                            {
                                "line": 700,
                                "file": "quic_frame.ivy",
                                "instruction": "                require f.largest_acked = max_acked(dcid,e);\n"
                            },
                            {
                                "line": 701,
                                "file": "quic_frame.ivy",
                                "instruction": "            }\n"
                            },
                            {
                                "line": 702,
                                "file": "quic_frame.ivy",
                                "instruction": "\t    ...\n"
                            },
                            {
                                "line": 703,
                                "file": "quic_frame.ivy",
                                "instruction": "            force_new_ack := false;\n"
                            },
                            {
                                "line": 704,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.ack"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": true,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.ack.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_ack_ecn_name": "ack_ecn",
            "frame_ack_ecn_object": [
                {
                    "name": "gap",
                    "type": "pkt_num,"
                },
                {
                    "name": "ranges",
                    "type": "pkt_num"
                }
            ],
            "frame_ack_ecn_module": null,
            "actions": [
                {
                    "line": 714,
                    "action_name": "frame.ack_ecn.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": [
                            {
                                "line": 716,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 717,
                                "file": "quic_frame.ivy",
                                "instruction": "            if _generating  {\n"
                            },
                            {
                                "line": 718,
                                "file": "quic_frame.ivy",
                                "instruction": "            \trequire ~(e = quic_packet_type.initial) & ~(e = quic_packet_type.handshake); #& ~(e = quic_packet_type.handshake)\n"
                            },
                            {
                                "line": 719,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 720,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 721,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.handshake -> established_handshake_keys(scid);  # [4]\n"
                            },
                            {
                                "line": 722,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt -> established_1rtt_keys(scid);  # [4]\n"
                            },
                            {
                                "line": 723,
                                "file": "quic_frame.ivy",
                                "instruction": "            #Chris\n"
                            },
                            {
                                "line": 724,
                                "file": "quic_frame.ivy",
                                "instruction": "            #TODO ECN\n"
                            },
                            {
                                "line": 725,
                                "file": "quic_frame.ivy",
                                "instruction": "            #require ~(e = quic_packet_type.version_negociation) & ~(e = quic_packet_type.retry);\n"
                            },
                            {
                                "line": 726,
                                "file": "quic_frame.ivy",
                                "instruction": "            #Chris\n"
                            },
                            {
                                "line": 727,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 728,
                                "file": "quic_frame.ivy",
                                "instruction": "            var idx : frame.ack_ecn.range.idx := 0;\n"
                            },
                            {
                                "line": 729,
                                "file": "quic_frame.ivy",
                                "instruction": "            var last := f.largest_acked;\n"
                            },
                            {
                                "line": 730,
                                "file": "quic_frame.ivy",
                                "instruction": "            if max_acked(dcid,e) < last {\n"
                            },
                            {
                                "line": 731,
                                "file": "quic_frame.ivy",
                                "instruction": "                max_acked(dcid,e) := last;  # [3]\n"
                            },
                            {
                                "line": 732,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 733,
                                "file": "quic_frame.ivy",
                                "instruction": "            require f.ack_ranges.end > 0;\n"
                            },
                            {
                                "line": 734,
                                "file": "quic_frame.ivy",
                                "instruction": "            var some_new_ack := false;\n"
                            },
                            {
                                "line": 735,
                                "file": "quic_frame.ivy",
                                "instruction": "            while idx < f.ack_ranges.end {\n"
                            },
                            {
                                "line": 736,
                                "file": "quic_frame.ivy",
                                "instruction": "                var ack_range := f.ack_ranges.value(idx);\n"
                            },
                            {
                                "line": 737,
                                "file": "quic_frame.ivy",
                                "instruction": "                require idx > 0 -> ack_range.gap < last - 1;\n"
                            },
                            {
                                "line": 738,
                                "file": "quic_frame.ivy",
                                "instruction": "                var upper := last - ((ack_range.gap+2) if idx > 0 else 0);\n"
                            },
                            {
                                "line": 739,
                                "file": "quic_frame.ivy",
                                "instruction": "                require ack_range.ranges <= upper;\n"
                            },
                            {
                                "line": 740,
                                "file": "quic_frame.ivy",
                                "instruction": "                last := upper - ack_range.ranges;\n"
                            },
                            {
                                "line": 741,
                                "file": "quic_frame.ivy",
                                "instruction": "                var jdx := last;\n"
                            },
                            {
                                "line": 742,
                                "file": "quic_frame.ivy",
                                "instruction": "                while jdx <= upper {\n"
                            },
                            {
                                "line": 743,
                                "file": "quic_frame.ivy",
                                "instruction": "                        require sent_pkt(dcid,e,jdx);  # [1]\n"
                            },
                            {
                                "line": 744,
                                "file": "quic_frame.ivy",
                                "instruction": "                        if pkt_has_close(dcid,e,jdx) {\n"
                            },
                            {
                                "line": 745,
                                "file": "quic_frame.ivy",
                                "instruction": "                            conn_draining(scid) := true  # [5]\n"
                            },
                            {
                                "line": 746,
                                "file": "quic_frame.ivy",
                                "instruction": "                        };\n"
                            },
                            {
                                "line": 747,
                                "file": "quic_frame.ivy",
                                "instruction": "                        if ~acked_pkt(dcid,e,jdx) {\n"
                            },
                            {
                                "line": 748,
                                "file": "quic_frame.ivy",
                                "instruction": "                            some_new_ack := true;\n"
                            },
                            {
                                "line": 749,
                                "file": "quic_frame.ivy",
                                "instruction": "                        };\n"
                            },
                            {
                                "line": 750,
                                "file": "quic_frame.ivy",
                                "instruction": "                    acked_pkt(dcid,e,jdx) := true;\n"
                            },
                            {
                                "line": 751,
                                "file": "quic_frame.ivy",
                                "instruction": "                    jdx := jdx + 1\n"
                            },
                            {
                                "line": 752,
                                "file": "quic_frame.ivy",
                                "instruction": "                };\n"
                            },
                            {
                                "line": 753,
                                "file": "quic_frame.ivy",
                                "instruction": "    #           acked_pkt(dcid,N) := (last <= N & N <= upper) | acked_pkt(dcid,N);  # [2]\n"
                            },
                            {
                                "line": 754,
                                "file": "quic_frame.ivy",
                                "instruction": "                idx := idx.next;\n"
                            },
                            {
                                "line": 755,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 756,
                                "file": "quic_frame.ivy",
                                "instruction": "            if _generating {\n"
                            },
                            {
                                "line": 757,
                                "file": "quic_frame.ivy",
                                "instruction": "                require some_new_ack;\n"
                            },
                            {
                                "line": 758,
                                "file": "quic_frame.ivy",
                                "instruction": "            }\n"
                            },
                            {
                                "line": 759,
                                "file": "quic_frame.ivy",
                                "instruction": "\t    ...\n"
                            },
                            {
                                "line": 760,
                                "file": "quic_frame.ivy",
                                "instruction": "            force_new_ack := false;\n"
                            },
                            {
                                "line": 761,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.ack_ecn"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.ack_ecn.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_ack_frequency_name": "ack_frequency",
            "frame_ack_frequency_object": [
                {
                    "name": "\t\t\tseq_num",
                    "type": "pkt_num,"
                },
                {
                    "name": "packet_tolerence",
                    "type": "stream_pos,"
                },
                {
                    "name": "update_max_ack_delay",
                    "type": "microsecs,\n"
                },
                {
                    "name": "ignore_order",
                    "type": "bool\n"
                }
            ],
            "frame_ack_frequency_module": null,
            "actions": [
                {
                    "line": 1752,
                    "action_name": "frame.ack_frequency.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": [
                            {
                                "line": 1753,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1754,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1755,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1756,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1757,
                                "file": "quic_frame.ivy",
                                "instruction": "            ...\n"
                            },
                            {
                                "line": 1758,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1759,
                                "file": "quic_frame.ivy",
                                "instruction": "            var tp := trans_params(dcid);\n"
                            },
                            {
                                "line": 1760,
                                "file": "quic_frame.ivy",
                                "instruction": "            var min : microsecs := 0;\n"
                            },
                            {
                                "line": 1761,
                                "file": "quic_frame.ivy",
                                "instruction": "            if min_ack_delay.is_set(tp) {\n"
                            },
                            {
                                "line": 1762,
                                "file": "quic_frame.ivy",
                                "instruction": "                min := min_ack_delay.value(trans_params(dcid)).exponent_8\n"
                            },
                            {
                                "line": 1763,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 1764,
                                "file": "quic_frame.ivy",
                                "instruction": "            require f.packet_tolerence > 0;\n"
                            },
                            {
                                "line": 1765,
                                "file": "quic_frame.ivy",
                                "instruction": "            require f.update_max_ack_delay > min; \n"
                            },
                            {
                                "line": 1766,
                                "file": "quic_frame.ivy",
                                "instruction": "            require f.ignore_order = 1 | f.ignore_order = 0;\n"
                            },
                            {
                                "line": 1767,
                                "file": "quic_frame.ivy",
                                "instruction": " \n"
                            },
                            {
                                "line": 1768,
                                "file": "quic_frame.ivy",
                                "instruction": "            if first_ack_freq_received {\n"
                            },
                            {
                                "line": 1769,
                                "file": "quic_frame.ivy",
                                "instruction": "                require f.seq_num = 0;\n"
                            },
                            {
                                "line": 1770,
                                "file": "quic_frame.ivy",
                                "instruction": "                first_ack_freq_received := false;\n"
                            },
                            {
                                "line": 1771,
                                "file": "quic_frame.ivy",
                                "instruction": "            } else {\n"
                            },
                            {
                                "line": 1772,
                                "file": "quic_frame.ivy",
                                "instruction": "                require f.seq_num > last_ack_freq_seq(scid);\n"
                            },
                            {
                                "line": 1773,
                                "file": "quic_frame.ivy",
                                "instruction": "                last_ack_freq_seq(scid) := f.seq_num;\n"
                            },
                            {
                                "line": 1774,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 1775,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.ack_frequency"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.ack_frequency.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_application_close_name": "application_close",
            "frame_application_close_object": [
                {
                    "name": "err_code",
                    "type": "error_code,"
                },
                {
                    "name": "reason_phrase_length",
                    "type": "stream_pos,"
                },
                {
                    "name": "reason_phrase",
                    "type": "stream_data"
                }
            ],
            "frame_application_close_module": null,
            "actions": [
                {
                    "line": 1254,
                    "action_name": "frame.application_close.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 349,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 350,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 351,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    } else {\n"
                            },
                            {
                                "line": 352,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require is_no_error;\n"
                            },
                            {
                                "line": 353,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        call _finalize;\n"
                            },
                            {
                                "line": 354,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    }\n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 1255,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1256,
                                "file": "quic_frame.ivy",
                                "instruction": "            #require e ~= quic_packet_type.initial;\n"
                            },
                            {
                                "line": 1257,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1258,
                                "file": "quic_frame.ivy",
                                "instruction": "            #require e = quic_packet_type.handshake -> established_handshake_keys(scid);\n"
                            },
                            {
                                "line": 1259,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1260,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(scid) & connected_to(scid) = dcid;\n"
                            },
                            {
                                "line": 1261,
                                "file": "quic_frame.ivy",
                                "instruction": "            require f.reason_phrase_length = f.reason_phrase.end;\n"
                            },
                            {
                                "line": 1262,
                                "file": "quic_frame.ivy",
                                "instruction": "            conn_closed(scid) := true;\n"
                            },
                            {
                                "line": 1263,
                                "file": "quic_frame.ivy",
                                "instruction": "            call handle_transport_error(f.err_code);\n"
                            },
                            {
                                "line": 1264,
                                "file": "quic_frame.ivy",
                                "instruction": "\t    ...\n"
                            },
                            {
                                "line": 1265,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.application_close"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "_finalize;",
                            "component": "ivy_quic_client_behavior.ivy"
                        },
                        {
                            "caller_func": "frame.application_close.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [
                            {
                                "caller_func": "frame.application_close.handle",
                                "component": "quic_frame.ivy"
                            }
                        ],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_connection_close_name": "connection_close",
            "frame_connection_close_object": [
                {
                    "name": "err_code",
                    "type": "error_code,"
                },
                {
                    "name": "frame_type",
                    "type": "error_code,"
                },
                {
                    "name": "reason_phrase_length",
                    "type": "stream_pos,"
                },
                {
                    "name": "reason_phrase",
                    "type": "stream_data"
                }
            ],
            "frame_connection_close_module": null,
            "actions": [
                {
                    "line": 1200,
                    "action_name": "frame.connection_close.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 336,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 337,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require conn_total_data(the_cid) > 30; # tricks\n"
                            },
                            {
                                "line": 338,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 339,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require f.err_code = 0;\n"
                            },
                            {
                                "line": 340,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    } else {\n"
                            },
                            {
                                "line": 341,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require is_no_error;\n"
                            },
                            {
                                "line": 342,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        call _finalize;\n"
                            },
                            {
                                "line": 343,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    }\n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 1201,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1202,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt -> established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1203,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.handshake -> established_handshake_keys(scid);\n"
                            },
                            {
                                "line": 1204,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1205,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(scid) & connected_to(scid) = dcid;\n"
                            },
                            {
                                "line": 1206,
                                "file": "quic_frame.ivy",
                                "instruction": "            require f.reason_phrase_length = f.reason_phrase.end;\n"
                            },
                            {
                                "line": 1207,
                                "file": "quic_frame.ivy",
                                "instruction": "            if _generating {\n"
                            },
                            {
                                "line": 1208,
                                "file": "quic_frame.ivy",
                                "instruction": "                require e = quic_packet_type.one_rtt;\n"
                            },
                            {
                                "line": 1209,
                                "file": "quic_frame.ivy",
                                "instruction": "                require ~conn_closed(scid);\n"
                            },
                            {
                                "line": 1210,
                                "file": "quic_frame.ivy",
                                "instruction": "            }; \n"
                            },
                            {
                                "line": 1211,
                                "file": "quic_frame.ivy",
                                "instruction": "            conn_closed(scid) := true;\n"
                            },
                            {
                                "line": 1212,
                                "file": "quic_frame.ivy",
                                "instruction": "            call handle_transport_error(f.err_code);\n"
                            },
                            {
                                "line": 1213,
                                "file": "quic_frame.ivy",
                                "instruction": "\t    ...\n"
                            },
                            {
                                "line": 1214,
                                "file": "quic_frame.ivy",
                                "instruction": "            # if _generating {\n"
                            },
                            {
                                "line": 1215,
                                "file": "quic_frame.ivy",
                                "instruction": "            #     call _finalize;\n"
                            },
                            {
                                "line": 1216,
                                "file": "quic_frame.ivy",
                                "instruction": "            # };\n"
                            },
                            {
                                "line": 1217,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.connection_close"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": true,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "_finalize;",
                            "component": "ivy_quic_client_behavior.ivy"
                        },
                        {
                            "caller_func": "frame.connection_close.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [
                            {
                                "caller_func": "frame.connection_close.handle",
                                "component": "quic_frame.ivy"
                            }
                        ],
                        "assertions": [
                            {
                                "line": 57,
                                "file": "quic_server_test.ivy",
                                "assertion": "require is_no_error;\n"
                            },
                            {
                                "line": 58,
                                "file": "quic_server_test.ivy",
                                "assertion": "require conn_total_data(the_cid) > 0;\n"
                            },
                            {
                                "line": 1140,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1141,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);  # [3]\n"
                            },
                            {
                                "line": 1142,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1143,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(scid) & connected_to(scid) = dcid;\n"
                            },
                            {
                                "line": 1144,
                                "file": "quic_frame.ivy",
                                "assertion": "require ~conn_closed(scid);  # [2]\n"
                            },
                            {
                                "line": 1638,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1639,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1641,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid); \n"
                            },
                            {
                                "line": 1644,
                                "file": "quic_frame.ivy",
                                "assertion": "require f.seq_num <= max_seq_num(dcid); #[1]\n"
                            },
                            {
                                "line": 326,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require scid = the_cid;\n"
                            },
                            {
                                "line": 1331,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1332,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1333,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 373,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require scid = the_cid;\n"
                            },
                            {
                                "line": 374,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require f.id = 4;\n"
                            }
                        ]
                    },
                    "assertions_as_assumption": {
                        "called_from": [
                            {
                                "caller_func": "frame.connection_close.handle",
                                "component": "quic_frame.ivy"
                            },
                            {
                                "caller_func": "Environment",
                                "component": "Environment"
                            }
                        ],
                        "assertions": [
                            {
                                "line": 57,
                                "file": "quic_server_test.ivy",
                                "assertion": "require is_no_error;\n"
                            },
                            {
                                "line": 58,
                                "file": "quic_server_test.ivy",
                                "assertion": "require conn_total_data(the_cid) > 0;\n"
                            },
                            {
                                "line": 831,
                                "file": "quic_frame.ivy",
                                "assertion": "require (connected(dcid) & connected_to(dcid) = scid); # | (e = quic_packet_type.zero_rtt & established_0rtt_keys(scid)); #e = quic_packet_type.zero_rtt & \n"
                            },
                            {
                                "line": 832,
                                "file": "quic_frame.ivy",
                                "assertion": "require (e = quic_packet_type.one_rtt & established_1rtt_keys(scid)); # | (e = quic_packet_type.zero_rtt & established_0rtt_keys(scid)); # | e = quic_packet_type.zero_rtt  | e = quic_packet_type.zero_rtt & established_0rtt_keys(scid)  \n"
                            },
                            {
                                "line": 835,
                                "file": "quic_frame.ivy",
                                "assertion": "require (e = quic_packet_type.one_rtt & established_1rtt_keys(scid)) | (e = quic_packet_type.zero_rtt & ~established_1rtt_keys(scid));\n"
                            },
                            {
                                "line": 845,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 853,
                                "file": "quic_frame.ivy",
                                "assertion": "require ~conn_closed(scid);  # [8]\n"
                            },
                            {
                                "line": 857,
                                "file": "quic_frame.ivy",
                                "assertion": "require ((offset) + (f.length)) <= stream_app_data_end(dcid,f.id);\n"
                            },
                            {
                                "line": 860,
                                "file": "quic_frame.ivy",
                                "assertion": "require f.data = stream_app_data(dcid,f.id).segment(offset,offset+f.length); # TODO\n"
                            },
                            {
                                "line": 861,
                                "file": "quic_frame.ivy",
                                "assertion": "require f.fin <-> (stream_app_data_finished(dcid,f.id) & offset+f.length = stream_app_data_end(dcid,f.id));\n"
                            },
                            {
                                "line": 870,
                                "file": "quic_frame.ivy",
                                "assertion": "require conn_seen(scid);  # [9]\n"
                            },
                            {
                                "line": 878,
                                "file": "quic_frame.ivy",
                                "assertion": "require stream_reset(dcid,f.id) ->\n"
                            },
                            {
                                "line": 883,
                                "file": "quic_frame.ivy",
                                "assertion": "require stream_id_allowed(dcid,f.id,e);  # [6]\n"
                            },
                            {
                                "line": 886,
                                "file": "quic_frame.ivy",
                                "assertion": "require  f.id = 4; #  f.id = 8 |f.id = 4 |\n"
                            },
                            {
                                "line": 244,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require scid = the_cid;\n"
                            },
                            {
                                "line": 246,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require connected(the_cid) & dcid = connected_to(the_cid);\n"
                            },
                            {
                                "line": 248,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require f.len & f.off; \n"
                            },
                            {
                                "line": 249,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require f.length > 0;\n"
                            },
                            {
                                "line": 250,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require f.offset = stream_length(dcid,f.id);\n"
                            },
                            {
                                "line": 251,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require f.length = (stream_app_data_end(dcid,f.id)) - f.offset;\n"
                            },
                            {
                                "line": 1705,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1706,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1707,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1708,
                                "file": "quic_frame.ivy",
                                "assertion": "require f.data.end = 8;\n"
                            },
                            {
                                "line": 1709,
                                "file": "quic_frame.ivy",
                                "assertion": "require path_challenge_pending(scid,f.data);\n"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "frame_crypto_name": "crypto",
            "frame_crypto_object": [
                {
                    "name": "offset",
                    "type": "stream_pos,"
                },
                {
                    "name": "length",
                    "type": "stream_pos,"
                },
                {
                    "name": "data",
                    "type": "stream_data"
                }
            ],
            "frame_crypto_module": null,
            "actions": [
                {
                    "line": 934,
                    "action_name": "frame.crypto.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 258,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 259,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 260,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require f.length > 0;\n"
                            },
                            {
                                "line": 261,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require f.offset = crypto_length(scid,e);\n"
                            },
                            {
                                "line": 262,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require f.length = (crypto_data_end(scid,e)) - f.offset;\n"
                            },
                            {
                                "line": 263,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    }\n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 936,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        #if ~scid=0 {\n"
                            },
                            {
                                "line": 937,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 938,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        #};\n"
                            },
                            {
                                "line": 939,
                                "file": "quic_frame.ivy",
                                "instruction": "            require ~conn_closed(scid);  # [1]\n"
                            },
                            {
                                "line": 940,
                                "file": "quic_frame.ivy",
                                "instruction": "            #chris\n"
                            },
                            {
                                "line": 941,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e ~= quic_packet_type.zero_rtt;  # [4]\n"
                            },
                            {
                                "line": 942,
                                "file": "quic_frame.ivy",
                                "instruction": "            #chris\n"
                            },
                            {
                                "line": 943,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        #if  ~is_crypto_limit_test | ~_generating { #For crypto limit test\n"
                            },
                            {
                                "line": 944,
                                "file": "quic_frame.ivy",
                                "instruction": "                require ((f.offset) + (f.length)) <= crypto_data_end(scid,e);  # [2]\n"
                            },
                            {
                                "line": 945,
                                "file": "quic_frame.ivy",
                                "instruction": "                require f.data = crypto_data(scid,e).segment(f.offset,f.offset+f.length);  # [2]\n"
                            },
                            {
                                "line": 946,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        #};\n"
                            },
                            {
                                "line": 947,
                                "file": "quic_frame.ivy",
                                "instruction": "            ...\n"
                            },
                            {
                                "line": 948,
                                "file": "quic_frame.ivy",
                                "instruction": "            #require e ~= quic_packet_type.zero_rtt;  # [4]\n"
                            },
                            {
                                "line": 949,
                                "file": "quic_frame.ivy",
                                "instruction": "            var length := f.offset + f.length;\n"
                            },
                            {
                                "line": 950,
                                "file": "quic_frame.ivy",
                                "instruction": "            if crypto_length(scid,e) < length {\n"
                            },
                            {
                                "line": 951,
                                "file": "quic_frame.ivy",
                                "instruction": "                crypto_length(scid,e) := length;   # [3]\n"
                            },
                            {
                                "line": 952,
                                "file": "quic_frame.ivy",
                                "instruction": "                #call show_crypto_length(crypto_length(scid,e));\n"
                            },
                            {
                                "line": 953,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 954,
                                "file": "quic_frame.ivy",
                                "instruction": "            var idx := f.offset;\n"
                            },
                            {
                                "line": 955,
                                "file": "quic_frame.ivy",
                                "instruction": "            while idx < f.offset + f.length {\n"
                            },
                            {
                                "line": 956,
                                "file": "quic_frame.ivy",
                                "instruction": "                crypto_data_present(scid,e,idx) := true;  # [3]\n"
                            },
                            {
                                "line": 957,
                                "file": "quic_frame.ivy",
                                "instruction": "                idx := idx.next\n"
                            },
                            {
                                "line": 958,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 959,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            },
                            {
                                "line": 960,
                                "file": "quic_frame.ivy",
                                "instruction": "            # TODO: is the following needed? Maybe it belongs somewhere else?\n"
                            },
                            {
                                "line": 961,
                                "file": "quic_frame.ivy",
                                "instruction": "            if e = quic_packet_type.handshake {\n"
                            },
                            {
                                "line": 962,
                                "file": "quic_frame.ivy",
                                "instruction": "                established_1rtt_keys(scid) := true;\n"
                            },
                            {
                                "line": 963,
                                "file": "quic_frame.ivy",
                                "instruction": "            }\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.crypto"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": true,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.crypto.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_data_blocked_name": "data_blocked",
            "frame_data_blocked_object": [
                {
                    "name": "pos",
                    "type": "stream_pos"
                }
            ],
            "frame_data_blocked_module": null,
            "actions": [
                {
                    "line": 1356,
                    "action_name": "frame.data_blocked.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": [
                            {
                                "line": 1357,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1358,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1359,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1360,
                                "file": "quic_frame.ivy",
                                "instruction": "\t    ...\n"
                            },
                            {
                                "line": 1361,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.data_blocked"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.data_blocked.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_name": "frame",
            "frame_object": [],
            "frame_module": null,
            "actions": [
                {
                    "line": 387,
                    "action_name": "frame.handle",
                    "implementation": [
                        {
                            "line": 386,
                            "file": "quic_frame.ivy",
                            "instruction": "       require false; # this generic action should never be called\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "this"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [
                            {
                                "caller_func": "infer_tls_events",
                                "component": "quic_infer.ivy"
                            },
                            {
                                "caller_func": "infer_tls_events_0rtt",
                                "component": "quic_infer.ivy"
                            }
                        ],
                        "assertions": [
                            {
                                "line": 387,
                                "file": "quic_frame.ivy",
                                "assertion": "require false; # this generic action should never be called\n"
                            },
                            {
                                "line": 1570,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1571,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1572,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid); #Will change with implementing TODO\n"
                            },
                            {
                                "line": 1576,
                                "file": "quic_frame.ivy",
                                "assertion": "require ~issued_zero_length_cid; # [7]\n"
                            },
                            {
                                "line": 1579,
                                "file": "quic_frame.ivy",
                                "assertion": "require f.retire_prior_to <= f.seq_num; #[4]\n"
                            },
                            {
                                "line": 1581,
                                "file": "quic_frame.ivy",
                                "assertion": "require f.seq_num < max_rtp_num(scid) -> send_retire_cid(dcid); #[6] \n"
                            },
                            {
                                "line": 319,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require scid = the_cid;\n"
                            },
                            {
                                "line": 1599,
                                "file": "quic_frame.ivy",
                                "assertion": "require acti_coid_check(dcid,num_conn(dcid));\n"
                            }
                        ]
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_handshake_done_name": "handshake_done",
            "frame_handshake_done_object": [],
            "frame_handshake_done_module": null,
            "actions": [
                {
                    "line": 1520,
                    "action_name": "frame.handshake_done.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": [
                            {
                                "line": 1521,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1522,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);  # [3]\n"
                            },
                            {
                                "line": 1523,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e ~= quic_packet_type.initial;\n"
                            },
                            {
                                "line": 1524,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        require e ~= quic_packet_type.handshake;\n"
                            },
                            {
                                "line": 1525,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1526,
                                "file": "quic_frame.ivy",
                                "instruction": "            require tls_handshake_finished;\n"
                            },
                            {
                                "line": 1527,
                                "file": "quic_frame.ivy",
                                "instruction": "                ...\n"
                            },
                            {
                                "line": 1528,
                                "file": "quic_frame.ivy",
                                "instruction": "            if _generating {\n"
                            },
                            {
                                "line": 1529,
                                "file": "quic_frame.ivy",
                                "instruction": "                handshake_done_send := true;\n"
                            },
                            {
                                "line": 1530,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 1531,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.handshake_done"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.handshake_done.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_malicious_frame_name": "malicious_frame",
            "frame_malicious_frame_object": [
                {
                    "name": "data",
                    "type": "stream_data\n"
                }
            ],
            "frame_malicious_frame_module": null,
            "actions": [
                {
                    "line": 1786,
                    "action_name": "frame.malicious_frame.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": [
                            {
                                "line": 1788,
                                "file": "quic_frame.ivy",
                                "instruction": "            require tls_handshake_finished;\n"
                            },
                            {
                                "line": 1789,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1790,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1791,
                                "file": "quic_frame.ivy",
                                "instruction": "            require (e = quic_packet_type.one_rtt) & established_1rtt_keys(scid); # | e = quic_packet_type.zero_rtt  | e = quic_packet_type.zero_rtt & established_0rtt_keys(scid) \n"
                            },
                            {
                                "line": 1792,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1793,
                                "file": "quic_frame.ivy",
                                "instruction": "            require ~conn_closed(scid);  # [8]\n"
                            },
                            {
                                "line": 1794,
                                "file": "quic_frame.ivy",
                                "instruction": "            require conn_seen(scid);  # [9]\n"
                            },
                            {
                                "line": 1795,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        ...\n"
                            },
                            {
                                "line": 1796,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.malicious_frame"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.malicious_frame.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_max_data_name": "max_data",
            "frame_max_data_object": [
                {
                    "name": "pos",
                    "type": "stream_pos"
                }
            ],
            "frame_max_data_module": null,
            "actions": [
                {
                    "line": 1437,
                    "action_name": "frame.max_data.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 382,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 383,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 384,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require f.pos = 4000;\n"
                            },
                            {
                                "line": 385,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    }\n"
                            },
                            {
                                "line": 386,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    else {\n"
                            },
                            {
                                "line": 387,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require ~(max_data_set(scid) & max_data_val(scid) > f.pos);\n"
                            },
                            {
                                "line": 388,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        var tp := trans_params(scid);\n"
                            },
                            {
                                "line": 389,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        if initial_max_data.is_set(tp) {\n"
                            },
                            {
                                "line": 390,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "# TEMORARY: commented out until fixed\n"
                            },
                            {
                                "line": 391,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "#            require initial_max_data.value(tp).stream_pos_32 <= f.pos;\n"
                            },
                            {
                                "line": 392,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        }\n"
                            },
                            {
                                "line": 393,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    }\n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 1438,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1439,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1440,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1441,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1442,
                                "file": "quic_frame.ivy",
                                "instruction": "            if ~max_data_set(scid) | f.pos > max_data_val(scid) {\n"
                            },
                            {
                                "line": 1443,
                                "file": "quic_frame.ivy",
                                "instruction": "                max_data_set(scid) := true;\n"
                            },
                            {
                                "line": 1444,
                                "file": "quic_frame.ivy",
                                "instruction": "                max_data_val(scid) := f.pos;  # [2]\n"
                            },
                            {
                                "line": 1445,
                                "file": "quic_frame.ivy",
                                "instruction": "            }\n"
                            },
                            {
                                "line": 1446,
                                "file": "quic_frame.ivy",
                                "instruction": "\t    ...\n"
                            },
                            {
                                "line": 1447,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.max_data"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.max_data.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_max_stream_data_name": "max_stream_data",
            "frame_max_stream_data_object": [
                {
                    "name": "id",
                    "type": "stream_id,"
                },
                {
                    "name": "pos",
                    "type": "stream_pos"
                }
            ],
            "frame_max_stream_data_module": null,
            "actions": [
                {
                    "line": 1293,
                    "action_name": "frame.max_stream_data.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 361,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 362,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 363,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require 4 <= f.id & f.id <= 16;\n"
                            },
                            {
                                "line": 364,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    }\n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 1294,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1295,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1296,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1297,
                                "file": "quic_frame.ivy",
                                "instruction": "            require stream_seen(scid,f.id);\n"
                            },
                            {
                                "line": 1298,
                                "file": "quic_frame.ivy",
                                "instruction": "            if ~max_stream_data_set(scid,f.id) | f.pos > max_stream_data_val(scid,f.id) {\n"
                            },
                            {
                                "line": 1299,
                                "file": "quic_frame.ivy",
                                "instruction": "                max_stream_data_set(scid,f.id) := true;\n"
                            },
                            {
                                "line": 1300,
                                "file": "quic_frame.ivy",
                                "instruction": "                max_stream_data_val(scid,f.id) := f.pos;  # [2]\n"
                            },
                            {
                                "line": 1301,
                                "file": "quic_frame.ivy",
                                "instruction": "            }\n"
                            },
                            {
                                "line": 1302,
                                "file": "quic_frame.ivy",
                                "instruction": "\t    ...\n"
                            },
                            {
                                "line": 1303,
                                "file": "quic_frame.ivy",
                                "instruction": "            #receiving_ready := true;\n"
                            },
                            {
                                "line": 1304,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.max_stream_data"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.max_stream_data.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_max_streams_name": "max_streams",
            "frame_max_streams_object": [
                {
                    "name": "id",
                    "type": "stream_id"
                }
            ],
            "frame_max_streams_module": null,
            "actions": [
                {
                    "line": 1107,
                    "action_name": "frame.max_streams.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 311,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 312,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 313,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    }\n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 1109,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1110,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);  # [3]\n"
                            },
                            {
                                "line": 1111,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1112,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(scid) & connected_to(scid) = dcid;\n"
                            },
                            {
                                "line": 1113,
                                "file": "quic_frame.ivy",
                                "instruction": "            require ~conn_closed(scid);  # [2]\n"
                            },
                            {
                                "line": 1114,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1115,
                                "file": "quic_frame.ivy",
                                "instruction": "            var kind := bidir;\n"
                            },
                            {
                                "line": 1116,
                                "file": "quic_frame.ivy",
                                "instruction": "            if ~ (max_stream_set(dcid,kind) & f.id < max_stream(dcid,kind)) { #[5]\n"
                            },
                            {
                                "line": 1117,
                                "file": "quic_frame.ivy",
                                "instruction": "                max_stream_set(dcid,kind) := true;\n"
                            },
                            {
                                "line": 1118,
                                "file": "quic_frame.ivy",
                                "instruction": "                max_stream(dcid,kind) := f.id; #  [1]\n"
                            },
                            {
                                "line": 1119,
                                "file": "quic_frame.ivy",
                                "instruction": "\t\t        #max_stream_id(dcid,kind) := cid_to_stream_id(f.id);\n"
                            },
                            {
                                "line": 1120,
                                "file": "quic_frame.ivy",
                                "instruction": "            }\n"
                            },
                            {
                                "line": 1121,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1122,
                                "file": "quic_frame.ivy",
                                "instruction": "            #  if _generating {\n"
                            },
                            {
                                "line": 1123,
                                "file": "quic_frame.ivy",
                                "instruction": "            #      require some_max_streams;\n"
                            },
                            {
                                "line": 1124,
                                "file": "quic_frame.ivy",
                                "instruction": "            #      require f.id = ms;\n"
                            },
                            {
                                "line": 1125,
                                "file": "quic_frame.ivy",
                                "instruction": "            #  }\n"
                            },
                            {
                                "line": 1126,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1127,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        ...\n"
                            },
                            {
                                "line": 1128,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1129,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.max_streams"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.max_streams.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_max_streams_bidi_name": "max_streams_bidi",
            "frame_max_streams_bidi_object": [
                {
                    "name": "id",
                    "type": "stream_id"
                }
            ],
            "frame_max_streams_bidi_module": null,
            "actions": [
                {
                    "line": 1137,
                    "action_name": "frame.max_streams_bidi.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": [
                            {
                                "line": 1139,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1140,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);  # [3]\n"
                            },
                            {
                                "line": 1141,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1142,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(scid) & connected_to(scid) = dcid;\n"
                            },
                            {
                                "line": 1143,
                                "file": "quic_frame.ivy",
                                "instruction": "            require ~conn_closed(scid);  # [2]\n"
                            },
                            {
                                "line": 1144,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1145,
                                "file": "quic_frame.ivy",
                                "instruction": "            var kind := bidir;\n"
                            },
                            {
                                "line": 1146,
                                "file": "quic_frame.ivy",
                                "instruction": "            if ~ (max_stream_set(dcid,kind) & f.id < max_stream(dcid,kind)) { #[5]\n"
                            },
                            {
                                "line": 1147,
                                "file": "quic_frame.ivy",
                                "instruction": "                max_stream_set(dcid,kind) := true;\n"
                            },
                            {
                                "line": 1148,
                                "file": "quic_frame.ivy",
                                "instruction": "                max_stream(dcid,kind) := f.id; #  [1]\n"
                            },
                            {
                                "line": 1149,
                                "file": "quic_frame.ivy",
                                "instruction": "\t\t        #max_stream_id(dcid,kind) := cid_to_stream_id(f.id);\n"
                            },
                            {
                                "line": 1150,
                                "file": "quic_frame.ivy",
                                "instruction": "            }\n"
                            },
                            {
                                "line": 1151,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1152,
                                "file": "quic_frame.ivy",
                                "instruction": "            #  if _generating {\n"
                            },
                            {
                                "line": 1153,
                                "file": "quic_frame.ivy",
                                "instruction": "            #      require some_max_streams;\n"
                            },
                            {
                                "line": 1154,
                                "file": "quic_frame.ivy",
                                "instruction": "            #      require f.id = ms;\n"
                            },
                            {
                                "line": 1155,
                                "file": "quic_frame.ivy",
                                "instruction": "            #  }\n"
                            },
                            {
                                "line": 1156,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1157,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        ...\n"
                            },
                            {
                                "line": 1158,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1159,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.max_streams_bidi"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.max_streams_bidi.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_new_connection_id_name": "new_connection_id",
            "frame_new_connection_id_object": [
                {
                    "name": "seq_num",
                    "type": "cid_seq,"
                },
                {
                    "name": "retire_prior_to",
                    "type": "cid_seq,"
                },
                {
                    "name": "length",
                    "type": "cid_length,"
                },
                {
                    "name": "scid",
                    "type": "cid,"
                },
                {
                    "name": "token",
                    "type": "reset_token"
                }
            ],
            "frame_new_connection_id_module": null,
            "actions": [
                {
                    "line": 1568,
                    "action_name": "frame.new_connection_id.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 317,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 318,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 319,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    }\n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 1569,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1570,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1571,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid); #Will change with implementing TODO\n"
                            },
                            {
                                "line": 1572,
                                "file": "quic_frame.ivy",
                                "instruction": "            #chris\n"
                            },
                            {
                                "line": 1573,
                                "file": "quic_frame.ivy",
                                "instruction": "            #require f.length >= 0x1 & f.length <= 0x14; #[1]\n"
                            },
                            {
                                "line": 1574,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1575,
                                "file": "quic_frame.ivy",
                                "instruction": "            require ~issued_zero_length_cid; # [7]\n"
                            },
                            {
                                "line": 1576,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1577,
                                "file": "quic_frame.ivy",
                                "instruction": "            if ~_generating { # For error test, carefull, should be specified in generating so\n"
                            },
                            {
                                "line": 1578,
                                "file": "quic_frame.ivy",
                                "instruction": "                require f.retire_prior_to <= f.seq_num; #[4]\n"
                            },
                            {
                                "line": 1579,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 1580,
                                "file": "quic_frame.ivy",
                                "instruction": "            require f.seq_num < max_rtp_num(scid) -> send_retire_cid(dcid); #[6] \n"
                            },
                            {
                                "line": 1581,
                                "file": "quic_frame.ivy",
                                "instruction": "            #chris\n"
                            },
                            {
                                "line": 1582,
                                "file": "quic_frame.ivy",
                                "instruction": "            ...\n"
                            },
                            {
                                "line": 1583,
                                "file": "quic_frame.ivy",
                                "instruction": "            \n"
                            },
                            {
                                "line": 1584,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        cid_mapped(f.scid) := true;\n"
                            },
                            {
                                "line": 1585,
                                "file": "quic_frame.ivy",
                                "instruction": "                #cid_mapped(f.dcid) := true;\n"
                            },
                            {
                                "line": 1586,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        cid_to_aid(f.scid) := scid;\n"
                            },
                            {
                                "line": 1587,
                                "file": "quic_frame.ivy",
                                "instruction": "                #cid_to_aid(f.dcid) := dcid;\n"
                            },
                            {
                                "line": 1588,
                                "file": "quic_frame.ivy",
                                "instruction": "            seqnum_to_cid(scid,f.seq_num) := f.scid;\n"
                            },
                            {
                                "line": 1589,
                                "file": "quic_frame.ivy",
                                "instruction": "            last_cid_seq(scid) := f.seq_num; # ncid quant vuln\n"
                            },
                            {
                                "line": 1590,
                                "file": "quic_frame.ivy",
                                "instruction": "            #seqnum_to_cid(dcid,f.seq_num) := f.dcid;\n"
                            },
                            {
                                "line": 1591,
                                "file": "quic_frame.ivy",
                                "instruction": "            #call map_cids(scid,dcid); # ncid quant vuln ?\n"
                            },
                            {
                                "line": 1592,
                                "file": "quic_frame.ivy",
                                "instruction": "            #call map_cids(dcid,scid);\n"
                            },
                            {
                                "line": 1593,
                                "file": "quic_frame.ivy",
                                "instruction": "            count_newcid_frame(f.seq_num,f.retire_prior_to,f.length,f.scid,f.token) := count_newcid_frame(f.seq_num,f.retire_prior_to,f.length,f.scid,f.token) + 1;\n"
                            },
                            {
                                "line": 1594,
                                "file": "quic_frame.ivy",
                                "instruction": "            if  count_newcid_frame(f.seq_num,f.retire_prior_to,f.length,f.scid,f.token) = 1 {\n"
                            },
                            {
                                "line": 1595,
                                "file": "quic_frame.ivy",
                                "instruction": "                num_conn(dcid) := num_conn(dcid) + 1;\n"
                            },
                            {
                                "line": 1596,
                                "file": "quic_frame.ivy",
                                "instruction": "                var tp := trans_params(dcid);\n"
                            },
                            {
                                "line": 1597,
                                "file": "quic_frame.ivy",
                                "instruction": "                if ~_generating & active_connection_id_limit.is_set(tp)  {\n"
                            },
                            {
                                "line": 1598,
                                "file": "quic_frame.ivy",
                                "instruction": "                    require acti_coid_check(dcid,num_conn(dcid));\n"
                            },
                            {
                                "line": 1599,
                                "file": "quic_frame.ivy",
                                "instruction": "                };\n"
                            },
                            {
                                "line": 1600,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 1601,
                                "file": "quic_frame.ivy",
                                "instruction": "            \n"
                            },
                            {
                                "line": 1602,
                                "file": "quic_frame.ivy",
                                "instruction": "            #chris\n"
                            },
                            {
                                "line": 1603,
                                "file": "quic_frame.ivy",
                                "instruction": "            if (f.retire_prior_to > max_rtp_num(scid)) {\n"
                            },
                            {
                                "line": 1604,
                                "file": "quic_frame.ivy",
                                "instruction": "               max_rtp_num(scid) := f.retire_prior_to; #[5] \n"
                            },
                            {
                                "line": 1605,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 1606,
                                "file": "quic_frame.ivy",
                                "instruction": "            #chris\n"
                            },
                            {
                                "line": 1607,
                                "file": "quic_frame.ivy",
                                "instruction": "            #Hamid\n"
                            },
                            {
                                "line": 1608,
                                "file": "quic_frame.ivy",
                                "instruction": "            if (f.seq_num > max_seq_num(scid)) {\n"
                            },
                            {
                                "line": 1609,
                                "file": "quic_frame.ivy",
                                "instruction": "                max_seq_num(scid) := f.seq_num;\n"
                            },
                            {
                                "line": 1610,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 1611,
                                "file": "quic_frame.ivy",
                                "instruction": "            #Hamid \n"
                            },
                            {
                                "line": 1612,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        call enqueue_frame(scid,f,e,true);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.new_connection_id"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.new_connection_id.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_new_token_name": "new_token",
            "frame_new_token_object": [
                {
                    "name": "length",
                    "type": "stream_pos,"
                },
                {
                    "name": "data",
                    "type": "stream_data"
                }
            ],
            "frame_new_token_module": null,
            "actions": [
                {
                    "line": 1725,
                    "action_name": "frame.new_token.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 290,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 291,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 292,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        #call handle_sending_ack(f.largest_acked);\n"
                            },
                            {
                                "line": 293,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    } \n"
                            },
                            {
                                "line": 294,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    else {\n"
                            },
                            {
                                "line": 295,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        call tls_api.upper.save_token(f.data);\n"
                            },
                            {
                                "line": 296,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    }\n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 1726,
                                "file": "quic_frame.ivy",
                                "instruction": "            # TODO for now we save token in clinet & server\n"
                            },
                            {
                                "line": 1727,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1728,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1729,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1730,
                                "file": "quic_frame.ivy",
                                "instruction": "            if ~_generating {\n"
                            },
                            {
                                "line": 1731,
                                "file": "quic_frame.ivy",
                                "instruction": "                require ~is_client(scid);\n"
                            },
                            {
                                "line": 1732,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 1733,
                                "file": "quic_frame.ivy",
                                "instruction": "            ...\n"
                            },
                            {
                                "line": 1734,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1735,
                                "file": "quic_frame.ivy",
                                "instruction": "            # call tls_api.upper.save_token(f.data);\n"
                            },
                            {
                                "line": 1736,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.new_token"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "tls_api.upper.save_token",
                            "component": "ivy_quic_client_behavior.ivy"
                        },
                        {
                            "caller_func": "frame.new_token.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_path_challenge_name": "path_challenge",
            "frame_path_challenge_object": [
                {
                    "name": "data",
                    "type": "stream_data"
                }
            ],
            "frame_path_challenge_module": null,
            "actions": [
                {
                    "line": 1681,
                    "action_name": "frame.path_challenge.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": [
                            {
                                "line": 1682,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1683,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1684,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1685,
                                "file": "quic_frame.ivy",
                                "instruction": "            require f.data.end = 8;\n"
                            },
                            {
                                "line": 1686,
                                "file": "quic_frame.ivy",
                                "instruction": "            require ~path_challenge_pending(dcid,f.data);\n"
                            },
                            {
                                "line": 1687,
                                "file": "quic_frame.ivy",
                                "instruction": "            ...\n"
                            },
                            {
                                "line": 1688,
                                "file": "quic_frame.ivy",
                                "instruction": "            path_challenge_pending(dcid,f.data) := true;\n"
                            },
                            {
                                "line": 1689,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,true);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.path_challenge"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.path_challenge.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_path_response_name": "path_response",
            "frame_path_response_object": [
                {
                    "name": "data",
                    "type": "stream_data"
                }
            ],
            "frame_path_response_module": null,
            "actions": [
                {
                    "line": 1703,
                    "action_name": "frame.path_response.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": [
                            {
                                "line": 1704,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1705,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1706,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1707,
                                "file": "quic_frame.ivy",
                                "instruction": "            require f.data.end = 8;\n"
                            },
                            {
                                "line": 1708,
                                "file": "quic_frame.ivy",
                                "instruction": "            require path_challenge_pending(scid,f.data);\n"
                            },
                            {
                                "line": 1709,
                                "file": "quic_frame.ivy",
                                "instruction": "            ...\n"
                            },
                            {
                                "line": 1710,
                                "file": "quic_frame.ivy",
                                "instruction": "            path_challenge_pending(scid,f.data) := false;\n"
                            },
                            {
                                "line": 1711,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,true);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.path_response"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": true,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.path_response.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_ping_name": "ping",
            "frame_ping_object": [],
            "frame_ping_module": null,
            "actions": [
                {
                    "line": 1462,
                    "action_name": "frame.ping.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": [
                            {
                                "line": 1463,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1464,
                                "file": "quic_frame.ivy",
                                "instruction": "            ...\n"
                            },
                            {
                                "line": 1465,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.ping"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.ping.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_retire_connection_id_name": "retire_connection_id",
            "frame_retire_connection_id_object": [
                {
                    "name": "seq_num",
                    "type": "cid_seq"
                }
            ],
            "frame_retire_connection_id_module": null,
            "actions": [
                {
                    "line": 1636,
                    "action_name": "frame.retire_connection_id.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 324,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 325,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 326,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    }\n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 1637,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1638,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1639,
                                "file": "quic_frame.ivy",
                                "instruction": "            # Will change with implementing TODO\n"
                            },
                            {
                                "line": 1640,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid); \n"
                            },
                            {
                                "line": 1641,
                                "file": "quic_frame.ivy",
                                "instruction": "            # TODO remember the highest sequence number that was sent\n"
                            },
                            {
                                "line": 1642,
                                "file": "quic_frame.ivy",
                                "instruction": "            #Hamid\n"
                            },
                            {
                                "line": 1643,
                                "file": "quic_frame.ivy",
                                "instruction": "            require f.seq_num <= max_seq_num(dcid); #[1]\n"
                            },
                            {
                                "line": 1644,
                                "file": "quic_frame.ivy",
                                "instruction": "            #Hamid \n"
                            },
                            {
                                "line": 1645,
                                "file": "quic_frame.ivy",
                                "instruction": "            # TODO specify that you cannot retire the connection id of the current packet\n"
                            },
                            {
                                "line": 1646,
                                "file": "quic_frame.ivy",
                                "instruction": "            #\n"
                            },
                            {
                                "line": 1647,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        ... \n"
                            },
                            {
                                "line": 1648,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        cid_mapped(seqnum_to_cid(dcid, f.seq_num)) := false; #[2]\n"
                            },
                            {
                                "line": 1649,
                                "file": "quic_frame.ivy",
                                "instruction": "            count_rcid_frame(f.seq_num) := count_rcid_frame(f.seq_num) + 1;\n"
                            },
                            {
                                "line": 1650,
                                "file": "quic_frame.ivy",
                                "instruction": "            if  count_rcid_frame(f.seq_num) = 1 {\n"
                            },
                            {
                                "line": 1651,
                                "file": "quic_frame.ivy",
                                "instruction": "                num_conn(dcid) := num_conn(dcid) - 1;\n"
                            },
                            {
                                "line": 1652,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 1653,
                                "file": "quic_frame.ivy",
                                "instruction": "            #Hamid\n"
                            },
                            {
                                "line": 1654,
                                "file": "quic_frame.ivy",
                                "instruction": "            # the connection id seqnum_to_cid is being retired, append it to an array and iterate over the array in packet\n"
                            },
                            {
                                "line": 1655,
                                "file": "quic_frame.ivy",
                                "instruction": "            #Hamid\n"
                            },
                            {
                                "line": 1656,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.retire_connection_id"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.retire_connection_id.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_rst_stream_name": "rst_stream",
            "frame_rst_stream_object": [
                {
                    "name": "id",
                    "type": "stream_id,"
                },
                {
                    "name": "err_code",
                    "type": "error_code,"
                },
                {
                    "name": "final_offset",
                    "type": "stream_pos"
                }
            ],
            "frame_rst_stream_module": null,
            "actions": [
                {
                    "line": 1000,
                    "action_name": "frame.rst_stream.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 282,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 283,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 284,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require f.id = 4;\n"
                            },
                            {
                                "line": 285,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    }\n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 1002,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1003,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);  # [6]\n"
                            },
                            {
                                "line": 1004,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1005,
                                "file": "quic_frame.ivy",
                                "instruction": "            require ~conn_closed(scid);  # [5]\n"
                            },
                            {
                                "line": 1006,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(scid) & connected_to(scid) = dcid;\n"
                            },
                            {
                                "line": 1007,
                                "file": "quic_frame.ivy",
                                "instruction": "            require stream_length(dcid,f.id) <= f.final_offset;  # [1]\n"
                            },
                            {
                                "line": 1008,
                                "file": "quic_frame.ivy",
                                "instruction": "            require (stream_reset(dcid,f.id) | stream_finished(dcid,f.id))\n"
                            },
                            {
                                "line": 1009,
                                "file": "quic_frame.ivy",
                                "instruction": "                        -> stream_length(dcid,f.id) = f.final_offset;\n"
                            },
                            {
                                "line": 1010,
                                "file": "quic_frame.ivy",
                                "instruction": "            stream_reset(dcid,f.id) := true;  # [2]\n"
                            },
                            {
                                "line": 1011,
                                "file": "quic_frame.ivy",
                                "instruction": "            stream_length(dcid,f.id) := f.final_offset;  #[3]\n"
                            },
                            {
                                "line": 1012,
                                "file": "quic_frame.ivy",
                                "instruction": "            #require stream_seen(dcid,f.id);  # [8]\n"
                            },
                            {
                                "line": 1013,
                                "file": "quic_frame.ivy",
                                "instruction": "            require stream_id_allowed(dcid,f.id,e);  # [4]\n"
                            },
                            {
                                "line": 1014,
                                "file": "quic_frame.ivy",
                                "instruction": "\t    ...\n"
                            },
                            {
                                "line": 1015,
                                "file": "quic_frame.ivy",
                                "instruction": "            if ~_generating {\n"
                            },
                            {
                                "line": 1016,
                                "file": "quic_frame.ivy",
                                "instruction": "                call handle_transport_error(f.err_code);\n"
                            },
                            {
                                "line": 1017,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 1018,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.rst_stream"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.rst_stream.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_stop_sending_name": "stop_sending",
            "frame_stop_sending_object": [
                {
                    "name": "id",
                    "type": "stream_id,"
                },
                {
                    "name": "err_code",
                    "type": "error_code"
                }
            ],
            "frame_stop_sending_module": null,
            "actions": [
                {
                    "line": 1050,
                    "action_name": "frame.stop_sending.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 302,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 303,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 304,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require f.id = 4;\n"
                            },
                            {
                                "line": 305,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    }\n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 1052,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1053,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);  # [6]\n"
                            },
                            {
                                "line": 1054,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1055,
                                "file": "quic_frame.ivy",
                                "instruction": "            require ~conn_closed(scid);  # [5]\n"
                            },
                            {
                                "line": 1056,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(scid) & connected_to(scid) = dcid;\n"
                            },
                            {
                                "line": 1057,
                                "file": "quic_frame.ivy",
                                "instruction": "            if ~_generating { # For tests\n"
                            },
                            {
                                "line": 1058,
                                "file": "quic_frame.ivy",
                                "instruction": "                require stream_seen(dcid,f.id);  # [8]\n"
                            },
                            {
                                "line": 1059,
                                "file": "quic_frame.ivy",
                                "instruction": "                require stream_id_allowed(dcid,f.id,e);  # [4]\n"
                            },
                            {
                                "line": 1060,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 1061,
                                "file": "quic_frame.ivy",
                                "instruction": "\t    ...\n"
                            },
                            {
                                "line": 1062,
                                "file": "quic_frame.ivy",
                                "instruction": "            if ~_generating {\n"
                            },
                            {
                                "line": 1063,
                                "file": "quic_frame.ivy",
                                "instruction": "                call handle_transport_error(f.err_code);\n"
                            },
                            {
                                "line": 1064,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 1065,
                                "file": "quic_frame.ivy",
                                "instruction": "            stream_seen(scid,f.id) := true;\n"
                            },
                            {
                                "line": 1066,
                                "file": "quic_frame.ivy",
                                "instruction": "            #receiving_ready := true;\n"
                            },
                            {
                                "line": 1067,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.stop_sending"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.stop_sending.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_stream_name": "stream",
            "frame_stream_object": [
                {
                    "name": "off",
                    "type": "bool,"
                },
                {
                    "name": "len",
                    "type": "bool,"
                },
                {
                    "name": "fin",
                    "type": "bool,"
                },
                {
                    "name": "id",
                    "type": "stream_id,"
                },
                {
                    "name": "offset",
                    "type": "stream_pos,"
                },
                {
                    "name": "length",
                    "type": "stream_pos,"
                },
                {
                    "name": "data",
                    "type": "stream_data"
                }
            ],
            "frame_stream_module": null,
            "actions": [
                {
                    "line": 817,
                    "action_name": "frame.stream.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 242,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 243,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 244,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        if ~zero_rtt_server_test | zero_rtt_sent {\n"
                            },
                            {
                                "line": 245,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "            require connected(the_cid) & dcid = connected_to(the_cid);\n"
                            },
                            {
                                "line": 246,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        };\n"
                            },
                            {
                                "line": 247,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require f.len & f.off; \n"
                            },
                            {
                                "line": 248,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require f.length > 0;\n"
                            },
                            {
                                "line": 249,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require f.offset = stream_length(dcid,f.id);\n"
                            },
                            {
                                "line": 250,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require f.length = (stream_app_data_end(dcid,f.id)) - f.offset;\n"
                            },
                            {
                                "line": 251,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    };\n"
                            },
                            {
                                "line": 252,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "\n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 819,
                                "file": "quic_frame.ivy",
                                "instruction": "            # if  e = quic_packet_type.one_rtt { #  & established_0rtt_keys(scid)\n"
                            },
                            {
                                "line": 820,
                                "file": "quic_frame.ivy",
                                "instruction": "            #     require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 821,
                                "file": "quic_frame.ivy",
                                "instruction": "            #     require e = quic_packet_type.one_rtt & established_1rtt_keys(scid); #  | e = quic_packet_type.zero_rtt & established_0rtt_keys(scid) \n"
                            },
                            {
                                "line": 822,
                                "file": "quic_frame.ivy",
                                "instruction": "            #     require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 823,
                                "file": "quic_frame.ivy",
                                "instruction": "            # } else {\n"
                            },
                            {
                                "line": 824,
                                "file": "quic_frame.ivy",
                                "instruction": "            #call show_enc_level(e);\n"
                            },
                            {
                                "line": 825,
                                "file": "quic_frame.ivy",
                                "instruction": "            #     require num_queued_frames_rtt(scid) > 0 -> e = queued_level_rtt(scid); # TODO\n"
                            },
                            {
                                "line": 826,
                                "file": "quic_frame.ivy",
                                "instruction": "            # };\n"
                            },
                            {
                                "line": 827,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 828,
                                "file": "quic_frame.ivy",
                                "instruction": "            if (~zero_rtt_allowed | zero_rtt_sent) & ~(e = quic_packet_type.zero_rtt) {\n"
                            },
                            {
                                "line": 829,
                                "file": "quic_frame.ivy",
                                "instruction": "            #     #require tls_handshake_finished;\n"
                            },
                            {
                                "line": 830,
                                "file": "quic_frame.ivy",
                                "instruction": "                require (connected(dcid) & connected_to(dcid) = scid); # | (e = quic_packet_type.zero_rtt & established_0rtt_keys(scid)); #e = quic_packet_type.zero_rtt & \n"
                            },
                            {
                                "line": 831,
                                "file": "quic_frame.ivy",
                                "instruction": "                require (e = quic_packet_type.one_rtt & established_1rtt_keys(scid)); # | (e = quic_packet_type.zero_rtt & established_0rtt_keys(scid)); # | e = quic_packet_type.zero_rtt  | e = quic_packet_type.zero_rtt & established_0rtt_keys(scid)  \n"
                            },
                            {
                                "line": 832,
                                "file": "quic_frame.ivy",
                                "instruction": "            } else {\n"
                            },
                            {
                                "line": 833,
                                "file": "quic_frame.ivy",
                                "instruction": "                #require e = quic_packet_type.one_rtt | e = quic_packet_type.zero_rtt;\n"
                            },
                            {
                                "line": 834,
                                "file": "quic_frame.ivy",
                                "instruction": "                require (e = quic_packet_type.one_rtt & established_1rtt_keys(scid)) | (e = quic_packet_type.zero_rtt & ~established_1rtt_keys(scid));\n"
                            },
                            {
                                "line": 835,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 836,
                                "file": "quic_frame.ivy",
                                "instruction": "                #require dcid ~= the_cid;\n"
                            },
                            {
                                "line": 837,
                                "file": "quic_frame.ivy",
                                "instruction": "            #     # dcid := 2;\n"
                            },
                            {
                                "line": 838,
                                "file": "quic_frame.ivy",
                                "instruction": "            #     #require e = quic_packet_type.zero_rtt;\n"
                            },
                            {
                                "line": 839,
                                "file": "quic_frame.ivy",
                                "instruction": "            #     #require (connected(dcid) & connected_to(dcid) = scid) | (established_0rtt_keys(scid)); #e = quic_packet_type.zero_rtt & \n"
                            },
                            {
                                "line": 840,
                                "file": "quic_frame.ivy",
                                "instruction": "            #     #require (e = quic_packet_type.one_rtt & established_1rtt_keys(scid)) | (established_0rtt_keys(scid)); # | e = quic_packet_type.zero_rtt  | e = quic_packet_type.zero_rtt & established_0rtt_keys(scid)  \n"
                            },
                            {
                                "line": 841,
                                "file": "quic_frame.ivy",
                                "instruction": "            }\n"
                            },
                            {
                                "line": 842,
                                "file": "quic_frame.ivy",
                                "instruction": "            #require e = quic_packet_type.zero_rtt -> established_0rtt_keys(scid);  # [11]\n"
                            },
                            {
                                "line": 843,
                                "file": "quic_frame.ivy",
                                "instruction": "            if ~zero_rtt_allowed | zero_rtt_sent {\n"
                            },
                            {
                                "line": 844,
                                "file": "quic_frame.ivy",
                                "instruction": "                require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 845,
                                "file": "quic_frame.ivy",
                                "instruction": "            }\n"
                            },
                            {
                                "line": 846,
                                "file": "quic_frame.ivy",
                                "instruction": "            #require num_queued_frames_rtt(scid) > 0 -> e = queued_level_rtt(scid); # TODO\n"
                            },
                            {
                                "line": 847,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 848,
                                "file": "quic_frame.ivy",
                                "instruction": "            # [11] (e = quic_packet_type.zero_rtt & established_0rtt_keys(scid)\n"
                            },
                            {
                                "line": 849,
                                "file": "quic_frame.ivy",
                                "instruction": "            #require e = quic_packet_type.zero_rtt -> established_0rtt_keys(scid);  # [11]\n"
                            },
                            {
                                "line": 850,
                                "file": "quic_frame.ivy",
                                "instruction": "            #require e = quic_packet_type.one_rtt -> established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 851,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 852,
                                "file": "quic_frame.ivy",
                                "instruction": "            require ~conn_closed(scid);  # [8]\n"
                            },
                            {
                                "line": 853,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 854,
                                "file": "quic_frame.ivy",
                                "instruction": "            var offset := f.offset if f.off else 0;\n"
                            },
                            {
                                "line": 855,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 856,
                                "file": "quic_frame.ivy",
                                "instruction": "            require ((offset) + (f.length)) <= stream_app_data_end(dcid,f.id);\n"
                            },
                            {
                                "line": 857,
                                "file": "quic_frame.ivy",
                                "instruction": "    \n"
                            },
                            {
                                "line": 858,
                                "file": "quic_frame.ivy",
                                "instruction": "            #if is_stream_limit_test = false { #For stream limit test & pico vuln| ~_generating  not working\n"
                            },
                            {
                                "line": 859,
                                "file": "quic_frame.ivy",
                                "instruction": "            require f.data = stream_app_data(dcid,f.id).segment(offset,offset+f.length); # TODO\n"
                            },
                            {
                                "line": 860,
                                "file": "quic_frame.ivy",
                                "instruction": "            require f.fin <-> (stream_app_data_finished(dcid,f.id) & offset+f.length = stream_app_data_end(dcid,f.id));\n"
                            },
                            {
                                "line": 861,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 862,
                                "file": "quic_frame.ivy",
                                "instruction": "            var kind := get_stream_kind(f.id);\n"
                            },
                            {
                                "line": 863,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 864,
                                "file": "quic_frame.ivy",
                                "instruction": "            # Following assertion could fail because of packet\n"
                            },
                            {
                                "line": 865,
                                "file": "quic_frame.ivy",
                                "instruction": "            # re-ordering. QUESTION: what can we say?  require\n"
                            },
                            {
                                "line": 866,
                                "file": "quic_frame.ivy",
                                "instruction": "            # ~stream_reset(dcid,f.id); # [7]\n"
                            },
                            {
                                "line": 867,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 868,
                                "file": "quic_frame.ivy",
                                "instruction": "            if (~zero_rtt_allowed | zero_rtt_sent)  {  \n"
                            },
                            {
                                "line": 869,
                                "file": "quic_frame.ivy",
                                "instruction": "                require conn_seen(scid);  # [9]\n"
                            },
                            {
                                "line": 870,
                                "file": "quic_frame.ivy",
                                "instruction": "            }\n"
                            },
                            {
                                "line": 871,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 872,
                                "file": "quic_frame.ivy",
                                "instruction": "            # & ~cid_mapped(f.scid)\n"
                            },
                            {
                                "line": 873,
                                "file": "quic_frame.ivy",
                                "instruction": "            #quinn bug: +-deadlock with new_connection_id\n"
                            },
                            {
                                "line": 874,
                                "file": "quic_frame.ivy",
                                "instruction": "            #require ((offset) + (f.length)) <= stream_max_data(dcid,f.id,e);  # [2]\n"
                            },
                            {
                                "line": 875,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 876,
                                "file": "quic_frame.ivy",
                                "instruction": "            \n"
                            },
                            {
                                "line": 877,
                                "file": "quic_frame.ivy",
                                "instruction": "            require stream_reset(dcid,f.id) ->\n"
                            },
                            {
                                "line": 878,
                                "file": "quic_frame.ivy",
                                "instruction": "                       ((offset) + (f.length)) <= stream_length(dcid,f.id);  # [13]\n"
                            },
                            {
                                "line": 879,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        \n"
                            },
                            {
                                "line": 880,
                                "file": "quic_frame.ivy",
                                "instruction": "            #remove for stream limit test\n"
                            },
                            {
                                "line": 881,
                                "file": "quic_frame.ivy",
                                "instruction": "            if ~zero_rtt_allowed | zero_rtt_sent  { # | ~_generating\n"
                            },
                            {
                                "line": 882,
                                "file": "quic_frame.ivy",
                                "instruction": "                require stream_id_allowed(dcid,f.id,e);  # [6]\n"
                            },
                            {
                                "line": 883,
                                "file": "quic_frame.ivy",
                                "instruction": "            } \n"
                            },
                            {
                                "line": 884,
                                "file": "quic_frame.ivy",
                                "instruction": "            else if _generating {\n"
                            },
                            {
                                "line": 885,
                                "file": "quic_frame.ivy",
                                "instruction": "                require  f.id = 4; #  f.id = 8 |f.id = 4 |\n"
                            },
                            {
                                "line": 886,
                                "file": "quic_frame.ivy",
                                "instruction": "            }\n"
                            },
                            {
                                "line": 887,
                                "file": "quic_frame.ivy",
                                "instruction": "\t        ...\n"
                            },
                            {
                                "line": 888,
                                "file": "quic_frame.ivy",
                                "instruction": "            stream_seen(scid,f.id) := true;\n"
                            },
                            {
                                "line": 889,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 890,
                                "file": "quic_frame.ivy",
                                "instruction": "            var offset := f.offset if f.off else 0;\n"
                            },
                            {
                                "line": 891,
                                "file": "quic_frame.ivy",
                                "instruction": "            var length := offset + f.length;\n"
                            },
                            {
                                "line": 892,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 893,
                                "file": "quic_frame.ivy",
                                "instruction": "            # require stream_finished(dcid,f.id) -> length <= stream_length(dcid,f.id);  # [5] deadlock client\n"
                            },
                            {
                                "line": 894,
                                "file": "quic_frame.ivy",
                                "instruction": "            if stream_length(dcid,f.id) < length {\n"
                            },
                            {
                                "line": 895,
                                "file": "quic_frame.ivy",
                                "instruction": "                conn_total_data(dcid) := conn_total_data(dcid) +\n"
                            },
                            {
                                "line": 896,
                                "file": "quic_frame.ivy",
                                "instruction": "                                             (length - stream_length(dcid,f.id));  # [12]\n"
                            },
                            {
                                "line": 897,
                                "file": "quic_frame.ivy",
                                "instruction": "                stream_length(dcid,f.id) := length\n"
                            },
                            {
                                "line": 898,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 899,
                                "file": "quic_frame.ivy",
                                "instruction": "            if f.fin {\n"
                            },
                            {
                                "line": 900,
                                "file": "quic_frame.ivy",
                                "instruction": "                stream_finished(dcid,f.id) := true;\n"
                            },
                            {
                                "line": 901,
                                "file": "quic_frame.ivy",
                                "instruction": "            };\n"
                            },
                            {
                                "line": 902,
                                "file": "quic_frame.ivy",
                                "instruction": "            if (~zero_rtt_allowed | zero_rtt_sent) & ~(e = quic_packet_type.zero_rtt) { #TODO\n"
                            },
                            {
                                "line": 903,
                                "file": "quic_frame.ivy",
                                "instruction": "                call enqueue_frame(scid,f,e,false);\n"
                            },
                            {
                                "line": 904,
                                "file": "quic_frame.ivy",
                                "instruction": "            } else {\n"
                            },
                            {
                                "line": 905,
                                "file": "quic_frame.ivy",
                                "instruction": "                first_zrtt_pkt := dcid;\n"
                            },
                            {
                                "line": 906,
                                "file": "quic_frame.ivy",
                                "instruction": "                call enqueue_frame_rtt(scid,f,e,false);\n"
                            },
                            {
                                "line": 907,
                                "file": "quic_frame.ivy",
                                "instruction": "            }\n"
                            },
                            {
                                "line": 908,
                                "file": "quic_frame.ivy",
                                "instruction": "        }\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.stream"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": true,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.stream.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_stream_data_blocked_name": "stream_data_blocked",
            "frame_stream_data_blocked_object": [
                {
                    "name": "id",
                    "type": "stream_id,"
                },
                {
                    "name": "pos",
                    "type": "stream_pos"
                }
            ],
            "frame_stream_data_blocked_module": null,
            "actions": [
                {
                    "line": 1329,
                    "action_name": "frame.stream_data_blocked.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [
                            {
                                "line": 371,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    if _generating {\n"
                            },
                            {
                                "line": 372,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require scid = the_cid;\n"
                            },
                            {
                                "line": 373,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "        require f.id = 4;\n"
                            },
                            {
                                "line": 374,
                                "file": "ivy_quic_client_behavior.ivy",
                                "instruction": "    }\n"
                            }
                        ],
                        "after": [],
                        "around": [
                            {
                                "line": 1330,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1331,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1332,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1333,
                                "file": "quic_frame.ivy",
                                "instruction": "\t    ...\n"
                            },
                            {
                                "line": 1334,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.stream_data_blocked"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.stream_data_blocked.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_streams_blocked_name": "streams_blocked",
            "frame_streams_blocked_object": [
                {
                    "name": "id",
                    "type": "cid"
                }
            ],
            "frame_streams_blocked_module": null,
            "actions": [
                {
                    "line": 1389,
                    "action_name": "frame.streams_blocked.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": [
                            {
                                "line": 1390,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1391,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1392,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1393,
                                "file": "quic_frame.ivy",
                                "instruction": "            #  some_max_streams := true;\n"
                            },
                            {
                                "line": 1394,
                                "file": "quic_frame.ivy",
                                "instruction": "            #  ms := f.id; #TODO not finished, should distinguish uni and bidi\n"
                            },
                            {
                                "line": 1395,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1396,
                                "file": "quic_frame.ivy",
                                "instruction": "\t    ...\n"
                            },
                            {
                                "line": 1397,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.streams_blocked"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.streams_blocked.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_streams_blocked_bidi_name": "streams_blocked_bidi",
            "frame_streams_blocked_bidi_object": [
                {
                    "name": "id",
                    "type": "cid"
                }
            ],
            "frame_streams_blocked_bidi_module": null,
            "actions": [
                {
                    "line": 1405,
                    "action_name": "frame.streams_blocked_bidi.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": [
                            {
                                "line": 1406,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1407,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1408,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1409,
                                "file": "quic_frame.ivy",
                                "instruction": "            #  some_max_streams := true;\n"
                            },
                            {
                                "line": 1410,
                                "file": "quic_frame.ivy",
                                "instruction": "            #  ms := f.id; #TODO not finished, should distinguish uni and bidi\n"
                            },
                            {
                                "line": 1411,
                                "file": "quic_frame.ivy",
                                "instruction": "\n"
                            },
                            {
                                "line": 1412,
                                "file": "quic_frame.ivy",
                                "instruction": "\t    ...\n"
                            },
                            {
                                "line": 1413,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.streams_blocked_bidi"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.streams_blocked_bidi.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "frame_unknown_frame_name": "unknown_frame",
            "frame_unknown_frame_object": [],
            "frame_unknown_frame_module": null,
            "actions": [
                {
                    "line": 1480,
                    "action_name": "frame.unknown_frame.handle",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": [
                            {
                                "line": 1481,
                                "file": "quic_frame.ivy",
                                "instruction": "            require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1482,
                                "file": "quic_frame.ivy",
                                "instruction": "            require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1483,
                                "file": "quic_frame.ivy",
                                "instruction": "            #volontary at any time or not ?\n"
                            },
                            {
                                "line": 1484,
                                "file": "quic_frame.ivy",
                                "instruction": "            require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);            \n"
                            },
                            {
                                "line": 1485,
                                "file": "quic_frame.ivy",
                                "instruction": "            #require e ~= quic_packet_type.initial & e ~= quic_packet_type.handshake;\n"
                            },
                            {
                                "line": 1486,
                                "file": "quic_frame.ivy",
                                "instruction": "            #require e ~= quic_packet_type.retry & e ~= quic_packet_type.version_negociation;\n"
                            },
                            {
                                "line": 1487,
                                "file": "quic_frame.ivy",
                                "instruction": "            require ~conn_closed(scid); \n"
                            },
                            {
                                "line": 1488,
                                "file": "quic_frame.ivy",
                                "instruction": "            ...\n"
                            },
                            {
                                "line": 1489,
                                "file": "quic_frame.ivy",
                                "instruction": "            call enqueue_frame(scid,f,e,false);\n"
                            }
                        ]
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "f",
                            "type": "frame.unknown_frame"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "e",
                            "type": "quic_packet_type"
                        },
                        {
                            "name": "seq_num",
                            "type": "pkt_num"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "frame.unknown_frame.handle",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "actions": {
                "line": 1918,
                "action_name": "stream_id_allowed",
                "implementation": [
                    {
                        "line": 1918,
                        "file": "quic_frame.ivy",
                        "instruction": "    ok := false;\n"
                    },
                    {
                        "line": 1919,
                        "file": "quic_frame.ivy",
                        "instruction": "    var tp := trans_params(dcid);\n"
                    },
                    {
                        "line": 1920,
                        "file": "quic_frame.ivy",
                        "instruction": "    var kind := get_stream_kind(id);\n"
                    },
                    {
                        "line": 1921,
                        "file": "quic_frame.ivy",
                        "instruction": "    var idhi : stream_id := id / 4;\n"
                    },
                    {
                        "line": 1922,
                        "file": "quic_frame.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 1923,
                        "file": "quic_frame.ivy",
                        "instruction": "    # if (zero_rtt_allowed & ~zero_rtt_sent) | e = quic_packet_type.zero_rtt { # TODO\n"
                    },
                    {
                        "line": 1924,
                        "file": "quic_frame.ivy",
                        "instruction": "    #     ok := idhi <= 20;\n"
                    },
                    {
                        "line": 1925,
                        "file": "quic_frame.ivy",
                        "instruction": "    # }\n"
                    },
                    {
                        "line": 1926,
                        "file": "quic_frame.ivy",
                        "instruction": "    # else \n"
                    },
                    {
                        "line": 1927,
                        "file": "quic_frame.ivy",
                        "instruction": "    if ~(is_client(dcid) <-> get_stream_role(id) = role.client) {  # if stream remotely initiated\n"
                    },
                    {
                        "line": 1928,
                        "file": "quic_frame.ivy",
                        "instruction": "        if kind = unidir {\n"
                    },
                    {
                        "line": 1929,
                        "file": "quic_frame.ivy",
                        "instruction": "            if initial_max_stream_id_uni.is_set(tp) {\n"
                    },
                    {
                        "line": 1930,
                        "file": "quic_frame.ivy",
                        "instruction": "                ok := idhi < (initial_max_stream_id_uni.value(tp).stream_id_16)  # [3]\n"
                    },
                    {
                        "line": 1931,
                        "file": "quic_frame.ivy",
                        "instruction": "            }\n"
                    },
                    {
                        "line": 1932,
                        "file": "quic_frame.ivy",
                        "instruction": "        } else {\n"
                    },
                    {
                        "line": 1933,
                        "file": "quic_frame.ivy",
                        "instruction": "            if initial_max_stream_id_bidi.is_set(tp) {\n"
                    },
                    {
                        "line": 1934,
                        "file": "quic_frame.ivy",
                        "instruction": "                ok := idhi < (initial_max_stream_id_bidi.value(tp).stream_id_16);  # [4]\n"
                    },
                    {
                        "line": 1935,
                        "file": "quic_frame.ivy",
                        "instruction": "            }\n"
                    },
                    {
                        "line": 1936,
                        "file": "quic_frame.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 1937,
                        "file": "quic_frame.ivy",
                        "instruction": "        ok := ok | max_stream_set(dcid,kind) & idhi < max_stream(dcid,kind);\n"
                    },
                    {
                        "line": 1938,
                        "file": "quic_frame.ivy",
                        "instruction": "    }\n"
                    },
                    {
                        "line": 1939,
                        "file": "quic_frame.ivy",
                        "instruction": "    else  {\n"
                    },
                    {
                        "line": 1940,
                        "file": "quic_frame.ivy",
                        "instruction": "        ok := stream_seen(dcid, id); # TODO: locally initiated streams must have been seen!\n"
                    },
                    {
                        "line": 1941,
                        "file": "quic_frame.ivy",
                        "instruction": "    }\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "ok",
                    "type": "bool"
                },
                "action_parameters": [
                    {
                        "name": "dcid",
                        "type": "cid"
                    },
                    {
                        "name": "id",
                        "type": "stream_id"
                    },
                    {
                        "name": "e",
                        "type": "quic_packet_type"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "functions": [
                {
                    "name": "max_stream_data_val(C:cid,S:stream_id) : stream_pos\n",
                    "comment": "",
                    "line": 514,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "max_data_val(C:cid) : stream_pos\n",
                    "comment": "",
                    "line": 516,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "stream_length(C:cid,S:stream_id) : stream_pos\n",
                    "comment": "",
                    "line": 518,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "max_stream(C:cid,K:stream_kind) : stream_id \n",
                    "comment": "",
                    "line": 522,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "queued_frames(C:cid) : frame.arr\n",
                    "comment": "",
                    "line": 524,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "queued_frames_rtt(C:cid) : frame.arr\n",
                    "comment": "",
                    "line": 525,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "queued_level(C:cid) : quic_packet_type\n",
                    "comment": "",
                    "line": 526,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "queued_level_rtt(C:cid) : quic_packet_type\n",
                    "comment": "",
                    "line": 527,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "num_queued_frames(C:cid) : frame.idx\n",
                    "comment": "",
                    "line": 532,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "num_queued_frames_rtt(C:cid) : frame.idx\n",
                    "comment": "",
                    "line": 533,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "conn_total_data(C:cid) : stream_pos\n",
                    "comment": "",
                    "line": 535,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "queued_level_type(C:cid,T:quic_packet_type) : frame.arr\n",
                    "comment": "",
                    "line": 541,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "max_rtp_num(C:cid) : cid_seq\n",
                    "comment": "",
                    "line": 543,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "count_stream_frame(I:stream_id,O:stream_pos, \n",
                    "comment": "",
                    "line": 545,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "count_reset_frame(I:stream_id,E:error_code,O:stream_pos) : stream_pos\n",
                    "comment": "",
                    "line": 549,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "count_sdb_frame(I:stream_id,O:stream_pos) : stream_pos\n",
                    "comment": "",
                    "line": 552,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "first_ack_freq_received : bool\n",
                    "comment": "",
                    "line": 555,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "last_ack_freq_seq(C:cid) : pkt_num\n",
                    "comment": "",
                    "line": 557,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "count_newcid_frame(I:cid_seq,O:cid_seq, \n",
                    "comment": "",
                    "line": 559,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "count_rcid_frame(I:cid_seq) : stream_pos\n",
                    "comment": "",
                    "line": 562,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "last_cid_seq(C:cid):cid_seq\n",
                    "comment": "",
                    "line": 568,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "first_zrtt_pkt : cid\n",
                    "comment": "",
                    "line": 570,
                    "file": "quic_frame.ivy"
                }
            ],
            "relations": [
                {
                    "name": "stream_seen(C:cid,S:stream_id)\n",
                    "comment": "",
                    "line": 513,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "max_stream_data_set(C:cid,S:stream_id)\n",
                    "comment": "",
                    "line": 515,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "max_data_set(C:cid)\n",
                    "comment": "",
                    "line": 517,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "stream_finished(C:cid,S:stream_id)\n",
                    "comment": "",
                    "line": 519,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "stream_reset(C:cid,S:stream_id)\n",
                    "comment": "",
                    "line": 520,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "max_stream_set(C:cid,K:stream_kind)\n",
                    "comment": "",
                    "line": 521,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "queued_non_probing(C:cid)\n",
                    "comment": "",
                    "line": 528,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "queued_non_ack(C:cid)\n",
                    "comment": "",
                    "line": 529,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "queued_challenge(C:cid)\n",
                    "comment": "",
                    "line": 530,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "queued_close(C:cid)\n",
                    "comment": "",
                    "line": 531,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "path_challenge_pending(C:cid,D:stream_data)\n",
                    "comment": "",
                    "line": 534,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "queued_ack_eliciting(C:cid)\n",
                    "comment": "",
                    "line": 537,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "send_retire_cid(C:cid)\n",
                    "comment": "",
                    "line": 542,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "stream_frame_restransmitted(S:stream_id)\n",
                    "comment": "",
                    "line": 547,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "reset_frame_restransmitted(S:stream_id)\n",
                    "comment": "",
                    "line": 550,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "sdb_frame_restransmitted(S:stream_id)\n",
                    "comment": "",
                    "line": 553,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "connection_closed \n",
                    "comment": "",
                    "line": 564,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "handshake_done_send ",
                    "comment": " TODO add src-endpoints",
                    "line": 566,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "zrtt_pkt_update \n",
                    "comment": "",
                    "line": 571,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "is_crypto_limit_test\n",
                    "comment": "",
                    "line": 575,
                    "file": "quic_frame.ivy"
                },
                {
                    "name": "stop_sending_in_bad_state\n",
                    "comment": "",
                    "line": 578,
                    "file": "quic_frame.ivy"
                }
            ]
        }
    ],
    "quic_application.ivy": [
        {
            "actions": {
                "line": 53,
                "action_name": "app_send_event",
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [
                        {
                            "line": 145,
                            "file": "quic_application.ivy",
                            "instruction": "    # call show_app_send_event(data);\n"
                        },
                        {
                            "line": 146,
                            "file": "quic_application.ivy",
                            "instruction": "    var send_end := pos + data.end;\n"
                        },
                        {
                            "line": 147,
                            "file": "quic_application.ivy",
                            "instruction": "    require ~(send_end > stream_app_data_end(dcid,s) & stream_app_data_finished(dcid,s));  # [4]\n"
                        },
                        {
                            "line": 148,
                            "file": "quic_application.ivy",
                            "instruction": "    var end := stream_app_data(dcid,s).end;\n"
                        },
                        {
                            "line": 149,
                            "file": "quic_application.ivy",
                            "instruction": "    if end < send_end {\n"
                        },
                        {
                            "line": 150,
                            "file": "quic_application.ivy",
                            "instruction": "        end := send_end\n"
                        },
                        {
                            "line": 151,
                            "file": "quic_application.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 152,
                            "file": "quic_application.ivy",
                            "instruction": "    stream_app_data(dcid,s) := stream_app_data(dcid,s).resize(end,0);  # [1]\n"
                        },
                        {
                            "line": 153,
                            "file": "quic_application.ivy",
                            "instruction": "    var idx := data.begin;\n"
                        },
                        {
                            "line": 154,
                            "file": "quic_application.ivy",
                            "instruction": "    while idx < data.end {\n"
                        },
                        {
                            "line": 155,
                            "file": "quic_application.ivy",
                            "instruction": "        var val := stream_app_data(dcid,s).value(pos + idx);\n"
                        },
                        {
                            "line": 156,
                            "file": "quic_application.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 157,
                            "file": "quic_application.ivy",
                            "instruction": "        # TODO: using zero as a \"null\" value is not correct here.\n"
                        },
                        {
                            "line": 158,
                            "file": "quic_application.ivy",
                            "instruction": "        # We need a data structure to capture the known intervals!\n"
                        },
                        {
                            "line": 159,
                            "file": "quic_application.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 160,
                            "file": "quic_application.ivy",
                            "instruction": "        require val ~= 0 ->  data.value(idx) = val;  # [2]\n"
                        },
                        {
                            "line": 161,
                            "file": "quic_application.ivy",
                            "instruction": "\t    stream_app_data(dcid,s) := stream_app_data(dcid,s).set(pos+idx,data.value(idx));\n"
                        },
                        {
                            "line": 162,
                            "file": "quic_application.ivy",
                            "instruction": "\t    idx := idx.next\n"
                        },
                        {
                            "line": 163,
                            "file": "quic_application.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 164,
                            "file": "quic_application.ivy",
                            "instruction": "    stream_app_data_end(dcid,s) := end;  # [1]\n"
                        },
                        {
                            "line": 165,
                            "file": "quic_application.ivy",
                            "instruction": "    if close {\n"
                        },
                        {
                            "line": 166,
                            "file": "quic_application.ivy",
                            "instruction": "        stream_app_data_finished(dcid,s) := true;  # [3]\n"
                        },
                        {
                            "line": 167,
                            "file": "quic_application.ivy",
                            "instruction": "    }\n"
                        }
                    ],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dcid",
                        "type": "cid"
                    },
                    {
                        "name": "s",
                        "type": "stream_id"
                    },
                    {
                        "name": "data",
                        "type": "stream_data"
                    },
                    {
                        "name": "pos",
                        "type": "stream_pos"
                    },
                    {
                        "name": "close",
                        "type": "bool"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "app_send_event",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "app_send_event",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "app_send_event",
                        "component": "ivy_quic_client_behavior.ivy"
                    },
                    {
                        "caller_func": "app_send_event",
                        "component": "ivy_quic_client_behavior.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [
                        {
                            "caller_func": "infer_tls_events",
                            "component": "quic_infer.ivy"
                        },
                        {
                            "caller_func": "infer_tls_events_0rtt",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions": [
                        {
                            "line": 148,
                            "file": "quic_application.ivy",
                            "assertion": "require ~(send_end > stream_app_data_end(dcid,s) & stream_app_data_finished(dcid,s));  # [4]\n"
                        },
                        {
                            "line": 161,
                            "file": "quic_application.ivy",
                            "assertion": "require val ~= 0 ->  data.value(idx) = val;  # [2]\n"
                        },
                        {
                            "line": 938,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 940,
                            "file": "quic_frame.ivy",
                            "assertion": "require ~conn_closed(scid);  # [1]\n"
                        },
                        {
                            "line": 942,
                            "file": "quic_frame.ivy",
                            "assertion": "require e ~= quic_packet_type.zero_rtt;  # [4]\n"
                        },
                        {
                            "line": 945,
                            "file": "quic_frame.ivy",
                            "assertion": "require ((f.offset) + (f.length)) <= crypto_data_end(scid,e);  # [2]\n"
                        },
                        {
                            "line": 946,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.data = crypto_data(scid,e).segment(f.offset,f.offset+f.length);  # [2]\n"
                        },
                        {
                            "line": 260,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require scid = the_cid;\n"
                        },
                        {
                            "line": 261,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require f.length > 0;\n"
                        },
                        {
                            "line": 262,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require f.offset = crypto_length(scid,e);\n"
                        },
                        {
                            "line": 263,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require f.length = (crypto_data_end(scid,e)) - f.offset;\n"
                        },
                        {
                            "line": 1003,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 1004,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);  # [6]\n"
                        },
                        {
                            "line": 1005,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 1006,
                            "file": "quic_frame.ivy",
                            "assertion": "require ~conn_closed(scid);  # [5]\n"
                        },
                        {
                            "line": 1007,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(scid) & connected_to(scid) = dcid;\n"
                        },
                        {
                            "line": 1008,
                            "file": "quic_frame.ivy",
                            "assertion": "require stream_length(dcid,f.id) <= f.final_offset;  # [1]\n"
                        },
                        {
                            "line": 1009,
                            "file": "quic_frame.ivy",
                            "assertion": "require (stream_reset(dcid,f.id) | stream_finished(dcid,f.id))\n"
                        },
                        {
                            "line": 1014,
                            "file": "quic_frame.ivy",
                            "assertion": "require stream_id_allowed(dcid,f.id,e);  # [4]\n"
                        },
                        {
                            "line": 284,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require scid = the_cid;\n"
                        },
                        {
                            "line": 285,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require f.id = 4;\n"
                        }
                    ]
                },
                "assertions_as_assumption": {
                    "called_from": [
                        {
                            "caller_func": "client_send_event",
                            "component": "ivy_quic_client_behavior.ivy"
                        }
                    ],
                    "assertions": [
                        {
                            "line": 148,
                            "file": "quic_application.ivy",
                            "assertion": "require ~(send_end > stream_app_data_end(dcid,s) & stream_app_data_finished(dcid,s));  # [4]\n"
                        },
                        {
                            "line": 161,
                            "file": "quic_application.ivy",
                            "assertion": "require val ~= 0 ->  data.value(idx) = val;  # [2]\n"
                        }
                    ]
                }
            }
        },
        {
            "actions": {
                "line": 32,
                "action_name": "app_server_open_event",
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": [
                        {
                            "line": 100,
                            "file": "quic_application.ivy",
                            "instruction": "    require conn_requested(dst,src,dcid);  # [1] \n"
                        },
                        {
                            "line": 101,
                            "file": "quic_application.ivy",
                            "instruction": "    require ~connected(dcid) & ~connected(scid);  # [2]\n"
                        },
                        {
                            "line": 102,
                            "file": "quic_application.ivy",
                            "instruction": "    ...\n"
                        },
                        {
                            "line": 103,
                            "file": "quic_application.ivy",
                            "instruction": "    call map_cids(scid,dcid);\n"
                        },
                        {
                            "line": 104,
                            "file": "quic_application.ivy",
                            "instruction": "    call map_cids(dcid,scid);\n"
                        },
                        {
                            "line": 105,
                            "file": "quic_application.ivy",
                            "instruction": "    ack_credit(scid) := ack_credit(scid) + 1;\n"
                        }
                    ]
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "dcid",
                        "type": "cid"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "app_server_open_event",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "app_server_open_event",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "app_server_open_event",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "app_server_open_event",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "app_server_open_event",
                        "component": "quic_endpoint.ivy"
                    },
                    {
                        "caller_func": "app_server_open_event",
                        "component": "quic_endpoint.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [
                        {
                            "caller_func": "infer_tls_events",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 109,
                "action_name": "map_cids",
                "implementation": [
                    {
                        "line": 109,
                        "file": "quic_application.ivy",
                        "instruction": "    used_cid(dcid) := true;\n"
                    },
                    {
                        "line": 110,
                        "file": "quic_application.ivy",
                        "instruction": "    connected(dcid) := true;\n"
                    },
                    {
                        "line": 111,
                        "file": "quic_application.ivy",
                        "instruction": "    connected_to(dcid) := scid\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "dcid",
                        "type": "cid"
                    },
                    {
                        "name": "scid",
                        "type": "cid"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "map_cids",
                        "component": "quic_application.ivy"
                    },
                    {
                        "caller_func": "map_cids",
                        "component": "quic_application.ivy"
                    },
                    {
                        "caller_func": "map_cids",
                        "component": "quic_application.ivy"
                    },
                    {
                        "caller_func": "map_cids",
                        "component": "quic_application.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "functions": [
                {
                    "name": "stream_app_data(C:cid,S:stream_id) : stream_data\n",
                    "comment": "",
                    "line": 77,
                    "file": "quic_application.ivy"
                },
                {
                    "name": "stream_app_data_end(C:cid,S:stream_id) : stream_pos\n",
                    "comment": "",
                    "line": 78,
                    "file": "quic_application.ivy"
                },
                {
                    "name": "stream_app_pos(C:cid,S:stream_id) : stream_pos\n",
                    "comment": "",
                    "line": 79,
                    "file": "quic_application.ivy"
                },
                {
                    "name": "stream_app_data_finished(C:cid,S:stream_id) : bool\n",
                    "comment": "",
                    "line": 80,
                    "file": "quic_application.ivy"
                }
            ],
            "relations": [
                {
                    "name": "used_cid(C:cid)\n",
                    "comment": "",
                    "line": 119,
                    "file": "quic_application.ivy"
                }
            ]
        }
    ],
    "quic_infer.ivy": [
        {
            "actions": {
                "line": 200,
                "action_name": "app_server_open_event_0rtt",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "dcid",
                        "type": "cid"
                    }
                ],
                "called_from": [
                    {
                        "caller_func": "app_server_open_event_0rtt",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "app_server_open_event_0rtt",
                        "component": "quic_infer.ivy"
                    }
                ],
                "events": true
            }
        },
        {
            "actions": {
                "line": 199,
                "action_name": "app_server_open_event_1rtt",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "dcid",
                        "type": "cid"
                    }
                ],
                "called_from": [
                    {
                        "caller_func": "app_server_open_event_1rtt",
                        "component": "quic_infer.ivy"
                    }
                ],
                "events": true
            }
        },
        {
            "actions": {
                "line": 201,
                "action_name": "app_server_open_event_retry",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "dcid",
                        "type": "cid"
                    }
                ],
                "called_from": [
                    {
                        "caller_func": "app_server_open_event_retry",
                        "component": "quic_infer.ivy"
                    }
                ],
                "events": true
            }
        },
        {
            "actions": {
                "line": 202,
                "action_name": "app_server_open_event_vn",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "dcid",
                        "type": "cid"
                    }
                ],
                "called_from": [
                    {
                        "caller_func": "app_server_open_event_vn",
                        "component": "quic_infer.ivy"
                    }
                ],
                "events": true
            }
        },
        {
            "actions": {
                "line": 203,
                "action_name": "infer_frame",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "dcid",
                        "type": "cid"
                    },
                    {
                        "name": "f",
                        "type": "frame"
                    }
                ],
                "called_from": [
                    {
                        "caller_func": "infer_frame",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "infer_frame",
                        "component": "quic_infer.ivy"
                    }
                ],
                "events": true
            }
        },
        {
            "actions": {
                "line": 26,
                "action_name": "infer_tls_events",
                "implementation": [
                    {
                        "line": 21,
                        "file": "quic_infer.ivy",
                        "instruction": "    #call infer_tls;\n"
                    },
                    {
                        "line": 22,
                        "file": "quic_infer.ivy",
                        "instruction": "    # Stream frames on id 0 indicate that a `tls_send_event` has occurred.\n"
                    },
                    {
                        "line": 23,
                        "file": "quic_infer.ivy",
                        "instruction": "    # TODO: ignore duplicate frames.\n"
                    },
                    {
                        "line": 24,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 25,
                        "file": "quic_infer.ivy",
                        "instruction": "    var scid := pkt.src_cid;\n"
                    },
                    {
                        "line": 26,
                        "file": "quic_infer.ivy",
                        "instruction": "    var dcid := pkt.dst_cid;\n"
                    },
                    {
                        "line": 27,
                        "file": "quic_infer.ivy",
                        "instruction": "    var sq   := pkt.seq_num;\n"
                    },
                    {
                        "line": 28,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 29,
                        "file": "quic_infer.ivy",
                        "instruction": "    # On short headers, the scid is not given, so we use the recorded value\n"
                    },
                    {
                        "line": 30,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 31,
                        "file": "quic_infer.ivy",
                        "instruction": "    if ~pkt.long {\n"
                    },
                    {
                        "line": 32,
                        "file": "quic_infer.ivy",
                        "instruction": "        scid := connected_to(dcid)\n"
                    },
                    {
                        "line": 33,
                        "file": "quic_infer.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 34,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 35,
                        "file": "quic_infer.ivy",
                        "instruction": "    # If this is an initial client request, we infer the nonce choice\n"
                    },
                    {
                        "line": 36,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 37,
                        "file": "quic_infer.ivy",
                        "instruction": "    if pkt.ptype = quic_packet_type.initial & ~conn_seen(dcid) & ~negocation_of_version(src) &  ~version_negociated {\n"
                    },
                    {
                        "line": 38,
                        "file": "quic_infer.ivy",
                        "instruction": "        nonce_cid(scid) := dcid;\n"
                    },
                    {
                        "line": 39,
                        "file": "quic_infer.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 40,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 41,
                        "file": "quic_infer.ivy",
                        "instruction": "    if pkt.ptype = quic_packet_type.initial & (retry_sent(scid) | version_negociated | negocation_of_version(src)) {\n"
                    },
                    {
                        "line": 42,
                        "file": "quic_infer.ivy",
                        "instruction": "        nonce_cid(scid) := dcid;\n"
                    },
                    {
                        "line": 43,
                        "file": "quic_infer.ivy",
                        "instruction": "        conn_seen(dcid) := false;\n"
                    },
                    {
                        "line": 44,
                        "file": "quic_infer.ivy",
                        "instruction": "        # nonce_cid(pkt.dst_cid) := pkt.src_cid;\n"
                    },
                    {
                        "line": 45,
                        "file": "quic_infer.ivy",
                        "instruction": "        # call show_cid(pkt.src_cid);\n"
                    },
                    {
                        "line": 46,
                        "file": "quic_infer.ivy",
                        "instruction": "        # call show_cid(pkt.dst_cid);\n"
                    },
                    {
                        "line": 47,
                        "file": "quic_infer.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 48,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 49,
                        "file": "quic_infer.ivy",
                        "instruction": "    var e := pkt.ptype;\n"
                    },
                    {
                        "line": 50,
                        "file": "quic_infer.ivy",
                        "instruction": "    \n"
                    },
                    {
                        "line": 51,
                        "file": "quic_infer.ivy",
                        "instruction": "    call set_encryption_level(src,scid,e);\n"
                    },
                    {
                        "line": 52,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 53,
                        "file": "quic_infer.ivy",
                        "instruction": "    # infer sender of packet has established keys for the packet\n"
                    },
                    {
                        "line": 54,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 55,
                        "file": "quic_infer.ivy",
                        "instruction": "    call tls_keys_established_event(scid,e);\n"
                    },
                    {
                        "line": 56,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 57,
                        "file": "quic_infer.ivy",
                        "instruction": "    # Infer an app_server_open_event.\n"
                    },
                    {
                        "line": 58,
                        "file": "quic_infer.ivy",
                        "instruction": "    if conn_requested(dst,src,dcid) & ~connected(dcid) & ~connected(scid) { # & ~negocation_of_version &  ~version_negociated \n"
                    },
                    {
                        "line": 59,
                        "file": "quic_infer.ivy",
                        "instruction": "        call app_server_open_event(src,dst,scid,dcid);\n"
                    },
                    {
                        "line": 60,
                        "file": "quic_infer.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 61,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 62,
                        "file": "quic_infer.ivy",
                        "instruction": "    var idx := pkt.payload.begin;\n"
                    },
                    {
                        "line": 63,
                        "file": "quic_infer.ivy",
                        "instruction": "    while idx < pkt.payload.end {\n"
                    },
                    {
                        "line": 64,
                        "file": "quic_infer.ivy",
                        "instruction": "        var f := pkt.payload.value(idx);\n"
                    },
                    {
                        "line": 65,
                        "file": "quic_infer.ivy",
                        "instruction": "        if some(cf:frame.crypto) f *> cf {\n"
                    },
                    {
                        "line": 66,
                        "file": "quic_infer.ivy",
                        "instruction": "            call show_biatch_2(dst);\n"
                    },
                    {
                        "line": 67,
                        "file": "quic_infer.ivy",
                        "instruction": "            call tls_send_event(src,dst,scid,dcid,cf.data,cf.offset,e,src_tls_id(src));\n"
                    },
                    {
                        "line": 68,
                        "file": "quic_infer.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 69,
                        "file": "quic_infer.ivy",
                        "instruction": "        if some(sf:frame.stream) f *> sf {\n"
                    },
                    {
                        "line": 70,
                        "file": "quic_infer.ivy",
                        "instruction": "                # require sf.offset <= stream_app_data_end(dcid,sf.id);  # TODO: deal with gaps in stream\n"
                    },
                    {
                        "line": 71,
                        "file": "quic_infer.ivy",
                        "instruction": "                # var data := sf.data.segment(stream_app_data_end(dcid,sf.id) - sf.offset,sf.data.end);\n"
                    },
                    {
                        "line": 72,
                        "file": "quic_infer.ivy",
                        "instruction": "            call app_server_open_event_1rtt(src,dst,scid,dcid);    \n"
                    },
                    {
                        "line": 73,
                        "file": "quic_infer.ivy",
                        "instruction": "            call app_send_event(src,dst,dcid,sf.id,sf.data,sf.offset,sf.fin)\n"
                    },
                    {
                        "line": 74,
                        "file": "quic_infer.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 75,
                        "file": "quic_infer.ivy",
                        "instruction": "        #if some(pf:frame.padding) f *> pf {\n"
                    },
                    {
                        "line": 76,
                        "file": "quic_infer.ivy",
                        "instruction": "            # do nothing\n"
                    },
                    {
                        "line": 77,
                        "file": "quic_infer.ivy",
                        "instruction": "        #} else {\n"
                    },
                    {
                        "line": 78,
                        "file": "quic_infer.ivy",
                        "instruction": "        call infer_frame(scid,dcid,f);\n"
                    },
                    {
                        "line": 79,
                        "file": "quic_infer.ivy",
                        "instruction": "        #};\n"
                    },
                    {
                        "line": 80,
                        "file": "quic_infer.ivy",
                        "instruction": "        call f.handle(scid,dcid,e,sq);\n"
                    },
                    {
                        "line": 81,
                        "file": "quic_infer.ivy",
                        "instruction": "        idx := idx.next\n"
                    },
                    {
                        "line": 82,
                        "file": "quic_infer.ivy",
                        "instruction": "    }\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "pkt",
                        "type": "quic_packet"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "infer_tls_events",
                        "component": "quic_endpoint.ivy"
                    },
                    {
                        "caller_func": "app_send_event",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "app_server_open_event",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "set_encryption_level",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "src_tls_id",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "tls_keys_established_event",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "tls_send_event",
                        "component": "quic_infer.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 150,
                "action_name": "infer_tls_events_0rtt",
                "implementation": [
                    {
                        "line": 145,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 146,
                        "file": "quic_infer.ivy",
                        "instruction": "    # Stream frames on id 0 indicate that a `tls_send_event` has occurred.\n"
                    },
                    {
                        "line": 147,
                        "file": "quic_infer.ivy",
                        "instruction": "    # TODO: ignore duplicate frames.\n"
                    },
                    {
                        "line": 148,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 149,
                        "file": "quic_infer.ivy",
                        "instruction": "    var scid := pkt.src_cid;\n"
                    },
                    {
                        "line": 150,
                        "file": "quic_infer.ivy",
                        "instruction": "    var dcid := pkt.dst_cid;\n"
                    },
                    {
                        "line": 151,
                        "file": "quic_infer.ivy",
                        "instruction": "    var sq   := pkt.seq_num;\n"
                    },
                    {
                        "line": 152,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 153,
                        "file": "quic_infer.ivy",
                        "instruction": "    # If this is an initial client request, we infer the nonce choice\n"
                    },
                    {
                        "line": 154,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 155,
                        "file": "quic_infer.ivy",
                        "instruction": "    if pkt.ptype = quic_packet_type.zero_rtt {  #& ~conn_seen(dcid)\n"
                    },
                    {
                        "line": 156,
                        "file": "quic_infer.ivy",
                        "instruction": "        nonce_cid(scid) := dcid;\n"
                    },
                    {
                        "line": 157,
                        "file": "quic_infer.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 158,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 159,
                        "file": "quic_infer.ivy",
                        "instruction": "    var e := quic_packet_type.zero_rtt;\n"
                    },
                    {
                        "line": 160,
                        "file": "quic_infer.ivy",
                        "instruction": "    \n"
                    },
                    {
                        "line": 161,
                        "file": "quic_infer.ivy",
                        "instruction": "    call set_encryption_level(src,scid,e);\n"
                    },
                    {
                        "line": 162,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 163,
                        "file": "quic_infer.ivy",
                        "instruction": "    # infer sender of packet has established keys for the packet\n"
                    },
                    {
                        "line": 164,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 165,
                        "file": "quic_infer.ivy",
                        "instruction": "    call tls_keys_established_event(scid,e);\n"
                    },
                    {
                        "line": 166,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 167,
                        "file": "quic_infer.ivy",
                        "instruction": "    # Infer an app_server_open_event.\n"
                    },
                    {
                        "line": 168,
                        "file": "quic_infer.ivy",
                        "instruction": "    if conn_requested(dst,src,dcid) & ~connected(dcid) & ~connected(scid) {\n"
                    },
                    {
                        "line": 169,
                        "file": "quic_infer.ivy",
                        "instruction": "         call app_server_open_event_0rtt(src,dst,scid,dcid);\n"
                    },
                    {
                        "line": 170,
                        "file": "quic_infer.ivy",
                        "instruction": "         call app_server_open_event(src,dst,scid,dcid);\n"
                    },
                    {
                        "line": 171,
                        "file": "quic_infer.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 172,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 173,
                        "file": "quic_infer.ivy",
                        "instruction": "    var idx := pkt.payload.begin;\n"
                    },
                    {
                        "line": 174,
                        "file": "quic_infer.ivy",
                        "instruction": "    while idx < pkt.payload.end {\n"
                    },
                    {
                        "line": 175,
                        "file": "quic_infer.ivy",
                        "instruction": "        var f := pkt.payload.value(idx);\n"
                    },
                    {
                        "line": 176,
                        "file": "quic_infer.ivy",
                        "instruction": "        # if some(cf:frame.crypto) f *> cf {\n"
                    },
                    {
                        "line": 177,
                        "file": "quic_infer.ivy",
                        "instruction": "        #     call tls_send_event(src,dst,scid,dcid,cf.data,cf.offset,e)\n"
                    },
                    {
                        "line": 178,
                        "file": "quic_infer.ivy",
                        "instruction": "        # };\n"
                    },
                    {
                        "line": 179,
                        "file": "quic_infer.ivy",
                        "instruction": "        if some(sf:frame.stream) f *> sf {\n"
                    },
                    {
                        "line": 180,
                        "file": "quic_infer.ivy",
                        "instruction": "            # require sf.offset <= stream_app_data_end(dcid,sf.id);  # TODO: deal with gaps in stream\n"
                    },
                    {
                        "line": 181,
                        "file": "quic_infer.ivy",
                        "instruction": "            # var data := sf.data.segment(stream_app_data_end(dcid,sf.id) - sf.offset,sf.data.end);\n"
                    },
                    {
                        "line": 182,
                        "file": "quic_infer.ivy",
                        "instruction": "            call app_server_open_event_0rtt(src,dst,scid,dcid);\n"
                    },
                    {
                        "line": 183,
                        "file": "quic_infer.ivy",
                        "instruction": "            call app_send_event(src,dst,dcid,sf.id,sf.data,sf.offset,sf.fin)\n"
                    },
                    {
                        "line": 184,
                        "file": "quic_infer.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 185,
                        "file": "quic_infer.ivy",
                        "instruction": "        #if some(pf:frame.padding) f *> pf {\n"
                    },
                    {
                        "line": 186,
                        "file": "quic_infer.ivy",
                        "instruction": "            # do nothing\n"
                    },
                    {
                        "line": 187,
                        "file": "quic_infer.ivy",
                        "instruction": "        #} else {\n"
                    },
                    {
                        "line": 188,
                        "file": "quic_infer.ivy",
                        "instruction": "            call infer_frame(scid,dcid,f);\n"
                    },
                    {
                        "line": 189,
                        "file": "quic_infer.ivy",
                        "instruction": "        #};\n"
                    },
                    {
                        "line": 190,
                        "file": "quic_infer.ivy",
                        "instruction": "        call f.handle(scid,dcid,e,sq);\n"
                    },
                    {
                        "line": 191,
                        "file": "quic_infer.ivy",
                        "instruction": "        idx := idx.next\n"
                    },
                    {
                        "line": 192,
                        "file": "quic_infer.ivy",
                        "instruction": "    }\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "pkt",
                        "type": "quic_packet_0rtt"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "app_send_event",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "app_server_open_event",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "set_encryption_level",
                        "component": "quic_infer.ivy"
                    },
                    {
                        "caller_func": "tls_keys_established_event",
                        "component": "quic_infer.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 121,
                "action_name": "infer_tls_events_retry",
                "implementation": [
                    {
                        "line": 116,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 117,
                        "file": "quic_infer.ivy",
                        "instruction": "    # Stream frames on id 0 indicate that a `tls_send_event` has occurred.\n"
                    },
                    {
                        "line": 118,
                        "file": "quic_infer.ivy",
                        "instruction": "    # TODO: ignore duplicate frames.\n"
                    },
                    {
                        "line": 119,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 120,
                        "file": "quic_infer.ivy",
                        "instruction": "    var scid := pkt.src_cid;\n"
                    },
                    {
                        "line": 121,
                        "file": "quic_infer.ivy",
                        "instruction": "    var dcid := pkt.dst_cid;\n"
                    },
                    {
                        "line": 122,
                        "file": "quic_infer.ivy",
                        "instruction": "    \n"
                    },
                    {
                        "line": 123,
                        "file": "quic_infer.ivy",
                        "instruction": "    # If this is an initial client request, we infer the nonce choice\n"
                    },
                    {
                        "line": 124,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 125,
                        "file": "quic_infer.ivy",
                        "instruction": "    if pkt.ptype = quic_packet_type.retry {  #& ~conn_seen(dcid)\n"
                    },
                    {
                        "line": 126,
                        "file": "quic_infer.ivy",
                        "instruction": "        nonce_cid(scid) := dcid;\n"
                    },
                    {
                        "line": 127,
                        "file": "quic_infer.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 128,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 129,
                        "file": "quic_infer.ivy",
                        "instruction": "    # var e := quic_packet_type.initial;\n"
                    },
                    {
                        "line": 130,
                        "file": "quic_infer.ivy",
                        "instruction": "    \n"
                    },
                    {
                        "line": 131,
                        "file": "quic_infer.ivy",
                        "instruction": "    # call set_encryption_level(src,scid,e);\n"
                    },
                    {
                        "line": 132,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 133,
                        "file": "quic_infer.ivy",
                        "instruction": "    # infer sender of packet has established keys for the packet\n"
                    },
                    {
                        "line": 134,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 135,
                        "file": "quic_infer.ivy",
                        "instruction": "    # call tls_keys_established_event(scid,e);\n"
                    },
                    {
                        "line": 136,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 137,
                        "file": "quic_infer.ivy",
                        "instruction": "    # Infer an app_server_open_event.\n"
                    },
                    {
                        "line": 138,
                        "file": "quic_infer.ivy",
                        "instruction": "    if conn_requested(dst,src,dcid) & ~connected(dcid) & ~connected(scid) {\n"
                    },
                    {
                        "line": 139,
                        "file": "quic_infer.ivy",
                        "instruction": "         call app_server_open_event_retry(src,dst,scid,dcid);\n"
                    },
                    {
                        "line": 140,
                        "file": "quic_infer.ivy",
                        "instruction": "         call app_server_open_event(src,dst,scid,dcid);\n"
                    },
                    {
                        "line": 141,
                        "file": "quic_infer.ivy",
                        "instruction": "    };\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "pkt",
                        "type": "quic_packet_retry"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "app_server_open_event",
                        "component": "quic_infer.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 92,
                "action_name": "infer_tls_events_vn",
                "implementation": [
                    {
                        "line": 88,
                        "file": "quic_infer.ivy",
                        "instruction": "    # Stream frames on id 0 indicate that a `tls_send_event` has occurred.\n"
                    },
                    {
                        "line": 89,
                        "file": "quic_infer.ivy",
                        "instruction": "    # TODO: ignore duplicate frames.\n"
                    },
                    {
                        "line": 90,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 91,
                        "file": "quic_infer.ivy",
                        "instruction": "    var scid := pkt.src_cid;\n"
                    },
                    {
                        "line": 92,
                        "file": "quic_infer.ivy",
                        "instruction": "    var dcid := pkt.dst_cid;\n"
                    },
                    {
                        "line": 93,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 94,
                        "file": "quic_infer.ivy",
                        "instruction": "    # If this is an initial client request, we infer the nonce choice\n"
                    },
                    {
                        "line": 95,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 96,
                        "file": "quic_infer.ivy",
                        "instruction": "    if pkt.ptype = quic_packet_type.version_negociation  { #& ~conn_seen(dcid)\n"
                    },
                    {
                        "line": 97,
                        "file": "quic_infer.ivy",
                        "instruction": "        nonce_cid(scid) := dcid;\n"
                    },
                    {
                        "line": 98,
                        "file": "quic_infer.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 99,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 100,
                        "file": "quic_infer.ivy",
                        "instruction": "    # var e := quic_packet_type.initial;\n"
                    },
                    {
                        "line": 101,
                        "file": "quic_infer.ivy",
                        "instruction": "    \n"
                    },
                    {
                        "line": 102,
                        "file": "quic_infer.ivy",
                        "instruction": "    # call set_encryption_level(src,scid,e);\n"
                    },
                    {
                        "line": 103,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 104,
                        "file": "quic_infer.ivy",
                        "instruction": "    # infer sender of packet has established keys for the packet\n"
                    },
                    {
                        "line": 105,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 106,
                        "file": "quic_infer.ivy",
                        "instruction": "    # call tls_keys_established_event(scid,e);\n"
                    },
                    {
                        "line": 107,
                        "file": "quic_infer.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 108,
                        "file": "quic_infer.ivy",
                        "instruction": "    # Infer an app_server_open_event.\n"
                    },
                    {
                        "line": 109,
                        "file": "quic_infer.ivy",
                        "instruction": "    if conn_requested(dst,src,dcid) & ~connected(dcid) & ~connected(scid) {\n"
                    },
                    {
                        "line": 110,
                        "file": "quic_infer.ivy",
                        "instruction": "        call app_server_open_event_vn(src,dst,scid,dcid);\n"
                    },
                    {
                        "line": 111,
                        "file": "quic_infer.ivy",
                        "instruction": "        call app_server_open_event(src,dst,scid,dcid);\n"
                    },
                    {
                        "line": 112,
                        "file": "quic_infer.ivy",
                        "instruction": "    };\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "pkt",
                        "type": "quic_packet_vn"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "app_server_open_event",
                        "component": "quic_infer.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 86,
                "action_name": "show_biatch_2",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    }
                ],
                "called_from": [],
                "events": true
            }
        },
        {
            "functions": [],
            "relations": []
        }
    ],
    "quic_endpoint.ivy": [
        {
            "attacker_ep_name": "attacker_ep",
            "attacker_ep_object": null,
            "attacker_ep_module": {
                "module_parameters": [
                    {
                        "name": "address",
                        "type": "ip.addr"
                    },
                    {
                        "name": "port",
                        "type": "ip.port"
                    }
                ],
                "module_attributes": []
            },
            "actions": [
                {
                    "line": 869,
                    "action_name": "attacker.behavior",
                    "implementation": [
                        {
                            "line": 868,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            var dst := socket_endpoint(host,s);  # because net API doesn't tell us the dst\n"
                        },
                        {
                            "line": 869,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            var idx := pkts.begin;\n"
                        },
                        {
                            "line": 870,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            var past_data : stream_data := stream_data.empty;\n"
                        },
                        {
                            "line": 871,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            while idx < pkts.end {\n"
                        },
                        {
                            "line": 872,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var ppkt := pkts.value(idx);\n"
                        },
                        {
                            "line": 873,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var tls_id := src_tls_id(dst); # todo multiple\n"
                        },
                        {
                            "line": 874,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var header := ppkt.value(0);\n"
                        },
                        {
                            "line": 875,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var hdr_type : type_bits := bfe[0][6](ppkt.value(0));\n"
                        },
                        {
                            "line": 876,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var tt := bvand(hdr_type,0x30);\n"
                        },
                        {
                            "line": 877,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var is_long : bool := bvand(0x80,header) ~= 0;\n"
                        },
                        {
                            "line": 878,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                \n"
                        },
                        {
                            "line": 879,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var version := ppkt.segment(1,1+4);\n"
                        },
                        {
                            "line": 880,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var bversion := bytes_to_version(version);\n"
                        },
                        {
                            "line": 881,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                \n"
                        },
                        {
                            "line": 882,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var ptype : byte := bvand(0x30,header);\n"
                        },
                        {
                            "line": 883,
                            "file": "quic_endpoint.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 884,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                if (bversion = 0 & is_long) | version_not_found(src) { \n"
                        },
                        {
                            "line": 885,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    # for server test, for version_negociation\n"
                        },
                        {
                            "line": 886,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    # 1000 0000 == version_negociation\n"
                        },
                        {
                            "line": 887,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    past_data := past_data.extend(ppkt);\n"
                        },
                        {
                            "line": 888,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    call tls_client_version_response(src,dst,past_data);\n"
                        },
                        {
                            "line": 889,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                } \n"
                        },
                        {
                            "line": 890,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                else if tt = 0x30 & ~(bversion = 0)  {\n"
                        },
                        {
                            "line": 891,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    #for server test, Retry packet\n"
                        },
                        {
                            "line": 892,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    call tls_client_retry_response(src,dst,ppkt);\n"
                        },
                        {
                            "line": 893,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                } \n"
                        },
                        {
                            "line": 894,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                # else if is_pad { #is_pad | is_rand_pad\n"
                        },
                        {
                            "line": 895,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                #     call padding_packet_event(src,dst,ppkt); # For quic-go and quand  client\n"
                        },
                        {
                            "line": 896,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                # } \n"
                        },
                        {
                            "line": 897,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                else { \n"
                        },
                        {
                            "line": 898,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    var rnum := reference_pkt_num(ppkt,true);\n"
                        },
                        {
                            "line": 899,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    var res := prot.decrypt(tls_id,rnum,ppkt);\n"
                        },
                        {
                            "line": 900,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    if res.ok {\n"
                        },
                        {
                            "line": 901,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        var is_pad := is_padding_packet(res.payload); # For picoquic  client\n"
                        },
                        {
                            "line": 902,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        if is_pad { #is_pad | is_rand_pad\n"
                        },
                        {
                            "line": 903,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            call padding_packet_event(host,src,dst,ppkt);\n"
                        },
                        {
                            "line": 904,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        } else {\n"
                        },
                        {
                            "line": 905,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            var pkt := pkt_serdes.from_bytes(res.data);\n"
                        },
                        {
                            "line": 906,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            pkt.seq_num := prot.correct_pnum(rnum,pkt.seq_num,prot.get_pnum_len(res.data));\n"
                        },
                        {
                            "line": 907,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            call recv_packet(host,src,dst,pkt);\n"
                        },
                        {
                            "line": 908,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            call infer_tls_events(src,dst,pkt);   # infer any TLS events on server side\n"
                        },
                        {
                            "line": 909,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            call packet_event(src,dst,pkt);       # also an inferred event\n"
                        },
                        {
                            "line": 910,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        };\n"
                        },
                        {
                            "line": 911,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    } else {\n"
                        },
                        {
                            "line": 912,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        call undecryptable_packet_event(host,src,dst,ppkt);\n"
                        },
                        {
                            "line": 913,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    };\n"
                        },
                        {
                            "line": 914,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                };\n"
                        },
                        {
                            "line": 915,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                idx := idx.next;\n"
                        },
                        {
                            "line": 916,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 917,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            version_not_found(src) := false;\n"
                        },
                        {
                            "line": 918,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            call show_last_datagram_size(last_datagram_received_size);\n"
                        },
                        {
                            "line": 919,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            if ~first_datagram_received & host = endpoint_id.server { # for client tests\n"
                        },
                        {
                            "line": 920,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                require last_datagram_received_size + 8 > 1200; # 8 is for UDP datagram header\n"
                        },
                        {
                            "line": 921,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                first_datagram_received := true;\n"
                        },
                        {
                            "line": 922,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 923,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            last_datagram_received_size := 0;\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "host",
                            "type": "endpoint_id"
                        },
                        {
                            "name": "s",
                            "type": "net.socket"
                        },
                        {
                            "name": "src",
                            "type": "ip.endpoint"
                        },
                        {
                            "name": "pkts",
                            "type": "prot.arr"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "attacker.behavior",
                            "component": "quic_shim.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [
                            {
                                "caller_func": "attacker.behavior",
                                "component": "quic_endpoint.ivy"
                            }
                        ],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 853,
                    "action_name": "attacker.init[after458]",
                    "implementation": [
                        {
                            "line": 853,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            enc_level := quic_packet_type.initial;\n"
                        },
                        {
                            "line": 854,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            ep.protocol := ip.udp;\n"
                        },
                        {
                            "line": 855,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            ep.addr := address;\n"
                        },
                        {
                            "line": 856,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            ep.port := port;\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": null,
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "client_ep_name": "client_ep",
            "client_ep_object": null,
            "client_ep_module": {
                "module_parameters": [
                    {
                        "name": "address",
                        "type": "ip.addr"
                    },
                    {
                        "name": "port",
                        "type": "ip.port"
                    }
                ],
                "module_attributes": []
            },
            "actions": [
                {
                    "line": 56,
                    "action_name": "client.behavior",
                    "implementation": [
                        {
                            "line": 55,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            var dst := socket_endpoint(host,s);  # because net API doesn't tell us the dst\n"
                        },
                        {
                            "line": 56,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            var idx := pkts.begin;\n"
                        },
                        {
                            "line": 57,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            var past_data : stream_data := stream_data.empty;\n"
                        },
                        {
                            "line": 58,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            while idx < pkts.end {\n"
                        },
                        {
                            "line": 59,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var ppkt := pkts.value(idx);\n"
                        },
                        {
                            "line": 60,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var tls_id := src_tls_id(dst); # todo multiple\n"
                        },
                        {
                            "line": 61,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var header := ppkt.value(0);\n"
                        },
                        {
                            "line": 62,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var hdr_type : type_bits := bfe[0][6](ppkt.value(0));\n"
                        },
                        {
                            "line": 63,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var tt := bvand(hdr_type,0x30);\n"
                        },
                        {
                            "line": 64,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var is_long : bool := bvand(0x80,header) ~= 0;\n"
                        },
                        {
                            "line": 65,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                \n"
                        },
                        {
                            "line": 66,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var version := ppkt.segment(1,1+4);\n"
                        },
                        {
                            "line": 67,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var bversion := bytes_to_version(version);\n"
                        },
                        {
                            "line": 68,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                \n"
                        },
                        {
                            "line": 69,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var ptype : byte := bvand(0x30,header);\n"
                        },
                        {
                            "line": 70,
                            "file": "quic_endpoint.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 71,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                if (bversion = 0 & is_long) | version_not_found(src) { \n"
                        },
                        {
                            "line": 72,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    # for server test, for version_negociation\n"
                        },
                        {
                            "line": 73,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    # 1000 0000 == version_negociation\n"
                        },
                        {
                            "line": 74,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    past_data := past_data.extend(ppkt);\n"
                        },
                        {
                            "line": 75,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    call tls_client_version_response(src,dst,past_data);\n"
                        },
                        {
                            "line": 76,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                } \n"
                        },
                        {
                            "line": 77,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                else if (tt = 0x30 & is_long) & ~(bversion = 0)  {\n"
                        },
                        {
                            "line": 78,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    #for server test, Retry packet\n"
                        },
                        {
                            "line": 79,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    call tls_client_retry_response(src,dst,ppkt);\n"
                        },
                        {
                            "line": 80,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                } \n"
                        },
                        {
                            "line": 81,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                # else if is_pad { #is_pad | is_rand_pad\n"
                        },
                        {
                            "line": 82,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                #     call padding_packet_event(src,dst,ppkt); # For quic-go and quand  client\n"
                        },
                        {
                            "line": 83,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                # } \n"
                        },
                        {
                            "line": 84,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                else { \n"
                        },
                        {
                            "line": 85,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    var rnum := reference_pkt_num(ppkt,true);\n"
                        },
                        {
                            "line": 86,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    var res := prot.decrypt(tls_id,rnum,ppkt);\n"
                        },
                        {
                            "line": 87,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    if res.ok {\n"
                        },
                        {
                            "line": 88,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        var is_pad := is_padding_packet(res.payload); # For picoquic  client\n"
                        },
                        {
                            "line": 89,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        if is_pad { #is_pad | is_rand_pad\n"
                        },
                        {
                            "line": 90,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            call padding_packet_event(host,src,dst,ppkt);\n"
                        },
                        {
                            "line": 91,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        } else {\n"
                        },
                        {
                            "line": 92,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            var pkt := pkt_serdes.from_bytes(res.data);\n"
                        },
                        {
                            "line": 93,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            pkt.seq_num := prot.correct_pnum(rnum,pkt.seq_num,prot.get_pnum_len(res.data));\n"
                        },
                        {
                            "line": 94,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            call recv_packet(host,src,dst,pkt);\n"
                        },
                        {
                            "line": 95,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            call infer_tls_events(src,dst,pkt);   # infer any TLS events on server side\n"
                        },
                        {
                            "line": 96,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            call packet_event(src,dst,pkt);       # also an inferred event\n"
                        },
                        {
                            "line": 97,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        };\n"
                        },
                        {
                            "line": 98,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    } else {\n"
                        },
                        {
                            "line": 99,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        call undecryptable_packet_event(host,src,dst,ppkt);\n"
                        },
                        {
                            "line": 100,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    };\n"
                        },
                        {
                            "line": 101,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                };\n"
                        },
                        {
                            "line": 102,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                idx := idx.next;\n"
                        },
                        {
                            "line": 103,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 104,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            version_not_found(src) := false;\n"
                        },
                        {
                            "line": 105,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            call show_last_datagram_size(last_datagram_received_size);\n"
                        },
                        {
                            "line": 106,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            if ~first_datagram_received & host = endpoint_id.server { # for client tests\n"
                        },
                        {
                            "line": 107,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                require last_datagram_received_size + 8 > 1200; # 8 is for UDP datagram header\n"
                        },
                        {
                            "line": 108,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                first_datagram_received := true;\n"
                        },
                        {
                            "line": 109,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 110,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            last_datagram_received_size := 0;\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "host",
                            "type": "endpoint_id"
                        },
                        {
                            "name": "s",
                            "type": "net.socket"
                        },
                        {
                            "name": "src",
                            "type": "ip.endpoint"
                        },
                        {
                            "name": "pkts",
                            "type": "prot.arr"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "client.behavior",
                            "component": "quic_shim.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [
                            {
                                "caller_func": "client.behavior",
                                "component": "quic_endpoint.ivy"
                            }
                        ],
                        "assertions": [
                            {
                                "line": 333,
                                "file": "quic_packet.ivy",
                                "assertion": "require pkt.ptype ~= quic_packet_type.zero_rtt & pkt.ptype ~= quic_packet_type.version_negociation & pkt.ptype ~= quic_packet_type.retry;\n"
                            },
                            {
                                "line": 342,
                                "file": "quic_packet.ivy",
                                "assertion": "require pkt.token.end ~= 0 -> (retry_sent(client_initial_rcid) | retry_recv(scid) | pkt.token = tls_api.upper.get_old_new_token);\n"
                            },
                            {
                                "line": 374,
                                "file": "quic_packet.ivy",
                                "assertion": "require connected(dcid) |\n"
                            },
                            {
                                "line": 387,
                                "file": "quic_packet.ivy",
                                "assertion": "require connected(dcid) -> connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 393,
                                "file": "quic_packet.ivy",
                                "assertion": "require dcid = client_initial_rcid;\n"
                            },
                            {
                                "line": 399,
                                "file": "quic_packet.ivy",
                                "assertion": "require pkt.ptype = queued_level(scid);\n"
                            },
                            {
                                "line": 410,
                                "file": "quic_packet.ivy",
                                "assertion": "require pkt.seq_num = last_pkt_num(scid,pkt.ptype) + 0x1; # OK\n"
                            },
                            {
                                "line": 415,
                                "file": "quic_packet.ivy",
                                "assertion": "require ~sent_pkt(scid,pkt.ptype,pkt.seq_num);  # [4]\n"
                            },
                            {
                                "line": 420,
                                "file": "quic_packet.ivy",
                                "assertion": "require num_queued_frames(scid) > 0;  # [7]\n"
                            },
                            {
                                "line": 424,
                                "file": "quic_packet.ivy",
                                "assertion": "require pkt.payload = queued_frames(scid);\n"
                            },
                            {
                                "line": 428,
                                "file": "quic_packet.ivy",
                                "assertion": "require conn_seen(scid) & pkt.long & is_client(scid) -> conn_requested(src,dst,scid);\n"
                            },
                            {
                                "line": 433,
                                "file": "quic_packet.ivy",
                                "assertion": "require  conn_seen(dcid) -> hi_non_probing_endpoint(dcid,dst);  # [10]\n"
                            },
                            {
                                "line": 439,
                                "file": "quic_packet.ivy",
                                "assertion": "require ~_generating & ~queued_non_ack(scid) -> ack_credit(scid) > 0;  # [5]\n"
                            },
                            {
                                "line": 459,
                                "file": "quic_packet.ivy",
                                "assertion": "require ~draining_pkt_sent(scid) & queued_close(scid);\n"
                            },
                            {
                                "line": 189,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require src = client_vn;\n"
                            },
                            {
                                "line": 194,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require src = client.ep | src = client_alt;\n"
                            },
                            {
                                "line": 196,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require src = client_alt;\n"
                            },
                            {
                                "line": 199,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require src = client.ep;\n"
                            },
                            {
                                "line": 202,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require dst = server.ep;\n"
                            },
                            {
                                "line": 205,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require pkt.token = retry_token(pkt.src_cid); # TODO new_token\n"
                            },
                            {
                                "line": 207,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require pkt.token.end = 0; \n"
                            },
                            {
                                "line": 214,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require pkt.long -> pkt.pversion = initial_version  #version 30\n"
                            },
                            {
                                "line": 216,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require pkt.long -> pkt.pversion = final_version\n"
                            },
                            {
                                "line": 1522,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1523,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);  # [3]\n"
                            },
                            {
                                "line": 1524,
                                "file": "quic_frame.ivy",
                                "assertion": "require e ~= quic_packet_type.initial;\n"
                            },
                            {
                                "line": 1525,
                                "file": "quic_frame.ivy",
                                "assertion": "require e ~= quic_packet_type.handshake;\n"
                            },
                            {
                                "line": 1526,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1527,
                                "file": "quic_frame.ivy",
                                "assertion": "require tls_handshake_finished;\n"
                            }
                        ]
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 48,
                    "action_name": "client.set_ep",
                    "implementation": [
                        {
                            "line": 47,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            ep := e;\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "e",
                            "type": "ip.endpoint"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 52,
                    "action_name": "client.set_tls_id",
                    "implementation": [
                        {
                            "line": 51,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            tls_id := e;\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "e",
                            "type": "tls_api.id"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "client_server_ep_name": "client_server_ep",
            "client_server_ep_object": null,
            "client_server_ep_module": {
                "module_parameters": [
                    {
                        "name": "address",
                        "type": "ip.addr"
                    },
                    {
                        "name": "port",
                        "type": "ip.port"
                    },
                    {
                        "name": "oport",
                        "type": "ip.port"
                    }
                ],
                "module_attributes": []
            },
            "actions": [
                {
                    "line": 366,
                    "action_name": "client_server.init[after456]",
                    "implementation": [
                        {
                            "line": 366,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            enc_level := quic_packet_type.initial;\n"
                        },
                        {
                            "line": 367,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            ep_in.protocol := ip.udp;\n"
                        },
                        {
                            "line": 368,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            ep_in.addr := address;\n"
                        },
                        {
                            "line": 369,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            ep_in.port := port;\n"
                        },
                        {
                            "line": 370,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            \n"
                        },
                        {
                            "line": 371,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            ep_out.protocol := ip.udp;\n"
                        },
                        {
                            "line": 372,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            ep_out.addr := address;\n"
                        },
                        {
                            "line": 373,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            ep_out.port := oport;\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": null,
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "actions": {
                "line": 1010,
                "action_name": "double_cid",
                "implementation": [
                    {
                        "line": 1009,
                        "file": "quic_endpoint.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 1010,
                        "file": "quic_endpoint.ivy",
                        "instruction": "    res.val = c.val * 2;\n"
                    },
                    {
                        "line": 1011,
                        "file": "quic_endpoint.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "res",
                    "type": "cid"
                },
                "action_parameters": [
                    {
                        "name": "c",
                        "type": "cid"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 12,
                "action_name": "endpoint_id_addr",
                "implementation": [
                    {
                        "line": 12,
                        "file": "quic_endpoint.ivy",
                        "instruction": "    ep.protocol := ip.udp;\n"
                    },
                    {
                        "line": 13,
                        "file": "quic_endpoint.ivy",
                        "instruction": "    ep.addr := server_addr if ep_id = endpoint_id.server | ep_id = endpoint_id.server_alt  \n"
                    },
                    {
                        "line": 14,
                        "file": "quic_endpoint.ivy",
                        "instruction": "                    else (mim_addr if ep_id = endpoint_id.mim\n"
                    },
                    {
                        "line": 15,
                        "file": "quic_endpoint.ivy",
                        "instruction": "                    else client_addr);   # the loop-back addr\n"
                    },
                    {
                        "line": 16,
                        "file": "quic_endpoint.ivy",
                        "instruction": "    ep.port := client_port if ep_id = endpoint_id.client\n"
                    },
                    {
                        "line": 17,
                        "file": "quic_endpoint.ivy",
                        "instruction": "               else (mim_port_in if ep_id = endpoint_id.mim # TODO \n"
                    },
                    {
                        "line": 18,
                        "file": "quic_endpoint.ivy",
                        "instruction": "               else (victim_port if ep_id = endpoint_id.victim # TODO \n"
                    },
                    {
                        "line": 19,
                        "file": "quic_endpoint.ivy",
                        "instruction": "               else (client_port_alt if ep_id = endpoint_id.client_alt\n"
                    },
                    {
                        "line": 20,
                        "file": "quic_endpoint.ivy",
                        "instruction": "               else (client_port_vn if ep_id = endpoint_id.client_vn\n"
                    },
                    {
                        "line": 21,
                        "file": "quic_endpoint.ivy",
                        "instruction": "               else (server_port_alt if ep_id = endpoint_id.server_alt\n"
                    },
                    {
                        "line": 22,
                        "file": "quic_endpoint.ivy",
                        "instruction": "               else server_port)))));\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "ep",
                    "type": "ip.endpoint"
                },
                "action_parameters": [
                    {
                        "name": "ep_id",
                        "type": "endpoint_id"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "server_ep_name": "server_ep",
            "server_ep_object": null,
            "server_ep_module": {
                "module_parameters": [
                    {
                        "name": "address",
                        "type": "ip.addr"
                    },
                    {
                        "name": "port",
                        "type": "ip.port"
                    }
                ],
                "module_attributes": []
            },
            "actions": [
                {
                    "line": 211,
                    "action_name": "server.behavior",
                    "implementation": [
                        {
                            "line": 210,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            var dst := socket_endpoint(host,s);  # because net API doesn't tell us the dst\n"
                        },
                        {
                            "line": 211,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            var idx := pkts.begin;\n"
                        },
                        {
                            "line": 212,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            while idx < pkts.end {\n"
                        },
                        {
                            "line": 213,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var ppkt := pkts.value(idx);\n"
                        },
                        {
                            "line": 214,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var tls_id := src_tls_id(dst); # todo multiple\n"
                        },
                        {
                            "line": 215,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var header := ppkt.value(0);\n"
                        },
                        {
                            "line": 216,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var hdr_type : type_bits := bfe[0][6](ppkt.value(0));\n"
                        },
                        {
                            "line": 217,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var tt := bvand(hdr_type,0x30);\n"
                        },
                        {
                            "line": 218,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var is_long : bool := bvand(0x80,header) ~= 0;\n"
                        },
                        {
                            "line": 219,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var version := ppkt.segment(1,1+4);\n"
                        },
                        {
                            "line": 220,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var bversion := bytes_to_version(version);\n"
                        },
                        {
                            "line": 221,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var ptype : byte := bvand(0x30,header);\n"
                        },
                        {
                            "line": 222,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                if zrtt_pkt_set & ~zrtt_pkt_process {\n"
                        },
                        {
                            "line": 223,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    zrtt_pkt_process := true;\n"
                        },
                        {
                            "line": 224,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    var rnum := reference_pkt_num(last_zrtt_pkt,true);\n"
                        },
                        {
                            "line": 225,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    var res := prot.decrypt(tls_id,rnum,last_zrtt_pkt);\n"
                        },
                        {
                            "line": 226,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    if res.ok {\n"
                        },
                        {
                            "line": 227,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        if ~(bversion = 0) {\n"
                        },
                        {
                            "line": 228,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            #for client test, 0rtt packet\n"
                        },
                        {
                            "line": 229,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            call tls_client_0rtt_response(src,dst,res.data);\n"
                        },
                        {
                            "line": 230,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        };\n"
                        },
                        {
                            "line": 231,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    } else {\n"
                        },
                        {
                            "line": 232,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        call undecryptable_packet_event(host,src,dst,last_zrtt_pkt);\n"
                        },
                        {
                            "line": 233,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    };\n"
                        },
                        {
                            "line": 234,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                };\n"
                        },
                        {
                            "line": 235,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                if bvand(ppkt.value(0),0xf0) = 0xc0 {\n"
                        },
                        {
                            "line": 236,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    # for client test\n"
                        },
                        {
                            "line": 237,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    call tls_client_initial_response(src,dst,ppkt)\n"
                        },
                        {
                            "line": 238,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                };\n"
                        },
                        {
                            "line": 239,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var rnum := reference_pkt_num(ppkt,true);\n"
                        },
                        {
                            "line": 240,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var res := prot.decrypt(tls_id,rnum,ppkt);\n"
                        },
                        {
                            "line": 241,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                if res.ok {\n"
                        },
                        {
                            "line": 242,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    var is_pad := is_padding_packet(res.payload); # For picoquic  client\n"
                        },
                        {
                            "line": 243,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    if is_pad { #is_pad | is_rand_pad\n"
                        },
                        {
                            "line": 244,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        call padding_packet_event(host,src,dst,ppkt);\n"
                        },
                        {
                            "line": 245,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    } else if tt = 0x10  & ~(bversion = 0) {\n"
                        },
                        {
                            "line": 246,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        #for client test, 0rtt packet\n"
                        },
                        {
                            "line": 247,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        call tls_client_0rtt_response(src,dst,res.data);\n"
                        },
                        {
                            "line": 248,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    } else {\n"
                        },
                        {
                            "line": 249,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        var pkt := pkt_serdes.from_bytes(res.data);\n"
                        },
                        {
                            "line": 250,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        pkt.seq_num := prot.correct_pnum(rnum,pkt.seq_num,prot.get_pnum_len(res.data));\n"
                        },
                        {
                            "line": 251,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        call recv_packet(host,src,dst,pkt);\n"
                        },
                        {
                            "line": 252,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        call infer_tls_events(src,dst,pkt);   # infer any TLS events on server side\n"
                        },
                        {
                            "line": 253,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        call packet_event(src,dst,pkt);       # also an inferred event\n"
                        },
                        {
                            "line": 254,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        if nclients > 1 {\n"
                        },
                        {
                            "line": 255,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            var cdx := the_cids.begin;\n"
                        },
                        {
                            "line": 256,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            while cdx < the_cids.end {\n"
                        },
                        {
                            "line": 257,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                                var tcid := the_cids.value(cdx);\n"
                        },
                        {
                            "line": 258,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                                if bvand(ppkt.value(0),0xf0) = 0xc0 & ~connected(tcid) { \n"
                        },
                        {
                            "line": 259,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                                    # for client test\n"
                        },
                        {
                            "line": 260,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                                    call app_server_open_event(dst,src,tcid,pkt.src_cid);  # [1]\n"
                        },
                        {
                            "line": 261,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                                };\n"
                        },
                        {
                            "line": 262,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                                cdx := cdx.next;\n"
                        },
                        {
                            "line": 263,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            }\n"
                        },
                        {
                            "line": 264,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        } else {\n"
                        },
                        {
                            "line": 265,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            if bvand(ppkt.value(0),0xf0) = 0xc0 & ~connected(the_cid) { \n"
                        },
                        {
                            "line": 266,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                                # for client test\n"
                        },
                        {
                            "line": 267,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                                call app_server_open_event(dst,src,the_cid,pkt.src_cid);  # [1]\n"
                        },
                        {
                            "line": 268,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                            };\n"
                        },
                        {
                            "line": 269,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                        };\n"
                        },
                        {
                            "line": 270,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    };\n"
                        },
                        {
                            "line": 271,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                } else {\n"
                        },
                        {
                            "line": 272,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                    call undecryptable_packet_event(host,src,dst,ppkt);\n"
                        },
                        {
                            "line": 273,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                };\n"
                        },
                        {
                            "line": 274,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                idx := idx.next;\n"
                        },
                        {
                            "line": 275,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 276,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            version_not_found(src) := false;\n"
                        },
                        {
                            "line": 277,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            call show_last_datagram_size(last_datagram_received_size);\n"
                        },
                        {
                            "line": 278,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            if ~first_datagram_received { # for client tests\n"
                        },
                        {
                            "line": 279,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                #require last_datagram_received_size + 8 > 1200; # 8 is for UDP datagram header TODO\n"
                        },
                        {
                            "line": 280,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                first_datagram_received := true;\n"
                        },
                        {
                            "line": 281,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 282,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            last_datagram_received_size := 0;\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "host",
                            "type": "endpoint_id"
                        },
                        {
                            "name": "s",
                            "type": "net.socket"
                        },
                        {
                            "name": "src",
                            "type": "ip.endpoint"
                        },
                        {
                            "name": "pkts",
                            "type": "prot.arr"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [
                            {
                                "caller_func": "server.behavior",
                                "component": "quic_endpoint.ivy"
                            },
                            {
                                "caller_func": "server.behavior",
                                "component": "quic_endpoint.ivy"
                            },
                            {
                                "caller_func": "server.behavior",
                                "component": "quic_endpoint.ivy"
                            },
                            {
                                "caller_func": "infer_tls_events_retry",
                                "component": "quic_infer.ivy"
                            },
                            {
                                "caller_func": "infer_tls_events_vn",
                                "component": "quic_infer.ivy"
                            },
                            {
                                "caller_func": "infer_tls_events_0rtt",
                                "component": "quic_infer.ivy"
                            },
                            {
                                "caller_func": "server.behavior",
                                "component": "quic_endpoint.ivy"
                            },
                            {
                                "caller_func": "server.behavior",
                                "component": "quic_endpoint.ivy"
                            },
                            {
                                "caller_func": "server.behavior",
                                "component": "quic_endpoint.ivy"
                            }
                        ],
                        "assertions": [
                            {
                                "line": 516,
                                "file": "quic_shim.ivy",
                                "assertion": "require dcil >= 8;\n"
                            },
                            {
                                "line": 1053,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1054,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);  # [6]\n"
                            },
                            {
                                "line": 1055,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1056,
                                "file": "quic_frame.ivy",
                                "assertion": "require ~conn_closed(scid);  # [5]\n"
                            },
                            {
                                "line": 1057,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(scid) & connected_to(scid) = dcid;\n"
                            },
                            {
                                "line": 1059,
                                "file": "quic_frame.ivy",
                                "assertion": "require stream_seen(dcid,f.id);  # [8]\n"
                            },
                            {
                                "line": 1060,
                                "file": "quic_frame.ivy",
                                "assertion": "require stream_id_allowed(dcid,f.id,e);  # [4]\n"
                            },
                            {
                                "line": 304,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require scid = the_cid;\n"
                            },
                            {
                                "line": 305,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require f.id = 4;\n"
                            },
                            {
                                "line": 101,
                                "file": "quic_application.ivy",
                                "assertion": "require conn_requested(dst,src,dcid);  # [1] \n"
                            },
                            {
                                "line": 102,
                                "file": "quic_application.ivy",
                                "assertion": "require ~connected(dcid) & ~connected(scid);  # [2]\n"
                            },
                            {
                                "line": 1683,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1684,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1685,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1686,
                                "file": "quic_frame.ivy",
                                "assertion": "require f.data.end = 8;\n"
                            },
                            {
                                "line": 1687,
                                "file": "quic_frame.ivy",
                                "assertion": "require ~path_challenge_pending(dcid,f.data);\n"
                            },
                            {
                                "line": 1256,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1258,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1260,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1261,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(scid) & connected_to(scid) = dcid;\n"
                            },
                            {
                                "line": 1262,
                                "file": "quic_frame.ivy",
                                "assertion": "require f.reason_phrase_length = f.reason_phrase.end;\n"
                            },
                            {
                                "line": 351,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require scid = the_cid;\n"
                            },
                            {
                                "line": 353,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require is_no_error;\n"
                            },
                            {
                                "line": 1439,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1440,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1441,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 384,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require scid = the_cid;\n"
                            },
                            {
                                "line": 385,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require f.pos = 4000;\n"
                            },
                            {
                                "line": 388,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require ~(max_data_set(scid) & max_data_val(scid) > f.pos);\n"
                            },
                            {
                                "line": 921,
                                "file": "quic_endpoint.ivy",
                                "assertion": "require last_datagram_received_size + 8 > 1200; # 8 is for UDP datagram header\n"
                            },
                            {
                                "line": 1202,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1203,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt -> established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1204,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.handshake -> established_handshake_keys(scid);\n"
                            },
                            {
                                "line": 1205,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 1206,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(scid) & connected_to(scid) = dcid;\n"
                            },
                            {
                                "line": 1207,
                                "file": "quic_frame.ivy",
                                "assertion": "require f.reason_phrase_length = f.reason_phrase.end;\n"
                            },
                            {
                                "line": 1209,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt;\n"
                            },
                            {
                                "line": 1210,
                                "file": "quic_frame.ivy",
                                "assertion": "require ~conn_closed(scid);\n"
                            },
                            {
                                "line": 338,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require conn_total_data(the_cid) > 30; # tricks\n"
                            },
                            {
                                "line": 339,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require scid = the_cid;\n"
                            },
                            {
                                "line": 340,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require f.err_code = 0;\n"
                            },
                            {
                                "line": 342,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require is_no_error;\n"
                            },
                            {
                                "line": 1358,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 1359,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                            },
                            {
                                "line": 1360,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 782,
                                "file": "quic_shim.ivy",
                                "assertion": "require dcil >= 8;\n"
                            }
                        ]
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 207,
                    "action_name": "server.set_tls_id",
                    "implementation": [
                        {
                            "line": 206,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            tls_id := e;\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "e",
                            "type": "tls_api.id"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "victim_agent_ep_name": "victim_agent_ep",
            "victim_agent_ep_object": [],
            "victim_agent_ep_module": {
                "module_parameters": [],
                "module_attributes": []
            },
            "actions": [
                {
                    "line": 986,
                    "action_name": "victim_agent.behavior",
                    "implementation": [
                        {
                            "line": 985,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            var dst := socket_endpoint(host,s);  # because net API doesn't tell us the dst\n"
                        },
                        {
                            "line": 986,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            var idx := pkts.begin;\n"
                        },
                        {
                            "line": 987,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            while idx < pkts.end {\n"
                        },
                        {
                            "line": 988,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var ppkt := pkts.value(idx);\n"
                        },
                        {
                            "line": 989,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var tls_id := src_tls_id(dst); # todo multiple\n"
                        },
                        {
                            "line": 990,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var header := ppkt.value(0);\n"
                        },
                        {
                            "line": 991,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var hdr_type : type_bits := bfe[0][6](ppkt.value(0));\n"
                        },
                        {
                            "line": 992,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var tt := bvand(hdr_type,0x30);\n"
                        },
                        {
                            "line": 993,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var is_long : bool := bvand(0x80,header) ~= 0;\n"
                        },
                        {
                            "line": 994,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                \n"
                        },
                        {
                            "line": 995,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var version := ppkt.segment(1,1+4);\n"
                        },
                        {
                            "line": 996,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var bversion := bytes_to_version(version);\n"
                        },
                        {
                            "line": 997,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                \n"
                        },
                        {
                            "line": 998,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                var ptype : byte := bvand(0x30,header);\n"
                        },
                        {
                            "line": 999,
                            "file": "quic_endpoint.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 1000,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                call recv_packet_victim(host,src,dst,ppkt);\n"
                        },
                        {
                            "line": 1001,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                ppkt_recvd := ppkt_recvd.append(ppkt);\n"
                        },
                        {
                            "line": 1002,
                            "file": "quic_endpoint.ivy",
                            "instruction": "                idx := idx.next;\n"
                        },
                        {
                            "line": 1003,
                            "file": "quic_endpoint.ivy",
                            "instruction": "            };\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "host",
                            "type": "endpoint_id"
                        },
                        {
                            "name": "s",
                            "type": "net.socket"
                        },
                        {
                            "name": "src",
                            "type": "ip.endpoint"
                        },
                        {
                            "name": "pkts",
                            "type": "prot.arr"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "functions": [
                {
                    "name": "ppkt_to_be_forwarded_to_server(C:stream_pos) : forged_pkts\n",
                    "comment": "",
                    "line": 420,
                    "file": "quic_endpoint.ivy"
                },
                {
                    "name": "ppkt_to_be_forwarded_to_client(C:stream_pos) : forged_pkts\n",
                    "comment": "",
                    "line": 425,
                    "file": "quic_endpoint.ivy"
                },
                {
                    "name": "max_retransmit(E:quic_packet_type,S:ip.endpoint) : stream_pos\n",
                    "comment": "",
                    "line": 444,
                    "file": "quic_endpoint.ivy"
                }
            ],
            "relations": []
        }
    ],
    "quic_shim.ivy": [
        {
            "actions": {
                "line": 993,
                "action_name": "bytes_to_cid",
                "implementation": [
                    {
                        "line": 992,
                        "file": "quic_shim.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 993,
                        "file": "quic_shim.ivy",
                        "instruction": "    val.val = 0;\n"
                    },
                    {
                        "line": 994,
                        "file": "quic_shim.ivy",
                        "instruction": "    for (unsigned i = 0; i < bytes.size(); i++)\n"
                    },
                    {
                        "line": 995,
                        "file": "quic_shim.ivy",
                        "instruction": "        val.val = (val.val << 8) + bytes[i];\n"
                    },
                    {
                        "line": 996,
                        "file": "quic_shim.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "val",
                    "type": "cid"
                },
                "action_parameters": [
                    {
                        "name": "bytes",
                        "type": "stream_data"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 1009,
                "action_name": "bytes_to_itoken",
                "implementation": [
                    {
                        "line": 1008,
                        "file": "quic_shim.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 1009,
                        "file": "quic_shim.ivy",
                        "instruction": "    val.val = 0;\n"
                    },
                    {
                        "line": 1010,
                        "file": "quic_shim.ivy",
                        "instruction": "    for (unsigned i = 0; i < bytes.size(); i++)\n"
                    },
                    {
                        "line": 1011,
                        "file": "quic_shim.ivy",
                        "instruction": "        val.val = (val.val << 8) + bytes[i];\n"
                    },
                    {
                        "line": 1012,
                        "file": "quic_shim.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "val",
                    "type": "itoken"
                },
                "action_parameters": [
                    {
                        "name": "bytes",
                        "type": "stream_data"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 1001,
                "action_name": "bytes_to_version",
                "implementation": [
                    {
                        "line": 1000,
                        "file": "quic_shim.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 1001,
                        "file": "quic_shim.ivy",
                        "instruction": "    val = 0;\n"
                    },
                    {
                        "line": 1002,
                        "file": "quic_shim.ivy",
                        "instruction": "    for (unsigned i = 0; i < bytes.size(); i++)\n"
                    },
                    {
                        "line": 1003,
                        "file": "quic_shim.ivy",
                        "instruction": "        val = (val << 8) + bytes[i];\n"
                    },
                    {
                        "line": 1004,
                        "file": "quic_shim.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "val",
                    "type": "version"
                },
                "action_parameters": [
                    {
                        "name": "bytes",
                        "type": "stream_data"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 904,
                "action_name": "cid_to_bytes",
                "implementation": [
                    {
                        "line": 903,
                        "file": "quic_shim.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 904,
                        "file": "quic_shim.ivy",
                        "instruction": "    res.resize(len);\n"
                    },
                    {
                        "line": 905,
                        "file": "quic_shim.ivy",
                        "instruction": "    for (unsigned i = 0; i < len; i++) {\n"
                    },
                    {
                        "line": 906,
                        "file": "quic_shim.ivy",
                        "instruction": "        res[len-i-1] = 0xff & (c.val >> (i * 8));\n"
                    },
                    {
                        "line": 907,
                        "file": "quic_shim.ivy",
                        "instruction": "    }\n"
                    },
                    {
                        "line": 908,
                        "file": "quic_shim.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "res",
                    "type": "stream_data"
                },
                "action_parameters": [
                    {
                        "name": "c",
                        "type": "cid"
                    },
                    {
                        "name": "len",
                        "type": "cid_length"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 913,
                "action_name": "cid_to_us",
                "implementation": [
                    {
                        "line": 912,
                        "file": "quic_shim.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 913,
                        "file": "quic_shim.ivy",
                        "instruction": "    res = c.val;\n"
                    },
                    {
                        "line": 914,
                        "file": "quic_shim.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "res",
                    "type": "tls_api.id"
                },
                "action_parameters": [
                    {
                        "name": "c",
                        "type": "cid"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 929,
                "action_name": "dcid_size_cl",
                "implementation": [
                    {
                        "line": 928,
                        "file": "quic_shim.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 929,
                        "file": "quic_shim.ivy",
                        "instruction": "    res = 0;\n"
                    },
                    {
                        "line": 930,
                        "file": "quic_shim.ivy",
                        "instruction": "    if(const char* env_p2 = std::getenv(\"TEST_TYPE\")) { \n"
                    },
                    {
                        "line": 931,
                        "file": "quic_shim.ivy",
                        "instruction": "      if(strcmp(env_p2, \"client\") == 0 || cond) {\n"
                    },
                    {
                        "line": 932,
                        "file": "quic_shim.ivy",
                        "instruction": "         if(const char* env_p3 = std::getenv(\"TEST_DCIL\")) {\n"
                    },
                    {
                        "line": 933,
                        "file": "quic_shim.ivy",
                        "instruction": "            std::cerr << \"TEST_DCIL \" << env_p3 << \"\\n\";\n"
                    },
                    {
                        "line": 934,
                        "file": "quic_shim.ivy",
                        "instruction": "\t        res = atoi(env_p3);\n"
                    },
                    {
                        "line": 935,
                        "file": "quic_shim.ivy",
                        "instruction": "         } \n"
                    },
                    {
                        "line": 936,
                        "file": "quic_shim.ivy",
                        "instruction": "         else \n"
                    },
                    {
                        "line": 937,
                        "file": "quic_shim.ivy",
                        "instruction": "\t        res = 8;\n"
                    },
                    {
                        "line": 938,
                        "file": "quic_shim.ivy",
                        "instruction": "      } else \n"
                    },
                    {
                        "line": 939,
                        "file": "quic_shim.ivy",
                        "instruction": "\t  res = 8;\n"
                    },
                    {
                        "line": 940,
                        "file": "quic_shim.ivy",
                        "instruction": "    } else \n"
                    },
                    {
                        "line": 941,
                        "file": "quic_shim.ivy",
                        "instruction": "      res = 8;\n"
                    },
                    {
                        "line": 942,
                        "file": "quic_shim.ivy",
                        "instruction": "    std::cerr <<  \"dcid_size_cl size: \" <<  res << \"\\n\";\n"
                    },
                    {
                        "line": 943,
                        "file": "quic_shim.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "res",
                    "type": "cid_length"
                },
                "action_parameters": [
                    {
                        "name": "cond",
                        "type": "bool"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 966,
                "action_name": "dcid_size_pos",
                "implementation": [
                    {
                        "line": 965,
                        "file": "quic_shim.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 966,
                        "file": "quic_shim.ivy",
                        "instruction": "    res = 0;\n"
                    },
                    {
                        "line": 967,
                        "file": "quic_shim.ivy",
                        "instruction": "    if(const char* env_p2 = std::getenv(\"TEST_TYPE\")) { \n"
                    },
                    {
                        "line": 968,
                        "file": "quic_shim.ivy",
                        "instruction": "      if(strcmp(env_p2, \"server\") == 0 || cond) {\n"
                    },
                    {
                        "line": 969,
                        "file": "quic_shim.ivy",
                        "instruction": "         if(const char* env_p3 = std::getenv(\"TEST_DCIL\")) {\n"
                    },
                    {
                        "line": 970,
                        "file": "quic_shim.ivy",
                        "instruction": "            std::cerr << \"TEST_DCIL \" << env_p3 << \"\\n\";\n"
                    },
                    {
                        "line": 971,
                        "file": "quic_shim.ivy",
                        "instruction": "\t        res = atoi(env_p3);\n"
                    },
                    {
                        "line": 972,
                        "file": "quic_shim.ivy",
                        "instruction": "         } else \n"
                    },
                    {
                        "line": 973,
                        "file": "quic_shim.ivy",
                        "instruction": "\t   res = 8;\n"
                    },
                    {
                        "line": 974,
                        "file": "quic_shim.ivy",
                        "instruction": "      } else \n"
                    },
                    {
                        "line": 975,
                        "file": "quic_shim.ivy",
                        "instruction": "\t  res = 8;\n"
                    },
                    {
                        "line": 976,
                        "file": "quic_shim.ivy",
                        "instruction": "    } else \n"
                    },
                    {
                        "line": 977,
                        "file": "quic_shim.ivy",
                        "instruction": "      res = 8;\n"
                    },
                    {
                        "line": 978,
                        "file": "quic_shim.ivy",
                        "instruction": "    std::cerr <<  \"dcid_size_pos size: \" <<  res << \"\\n\";\n"
                    },
                    {
                        "line": 979,
                        "file": "quic_shim.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "res",
                    "type": "stream_pos"
                },
                "action_parameters": [
                    {
                        "name": "cond",
                        "type": "bool"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 1043,
                "action_name": "export_length_cid",
                "implementation": [
                    {
                        "line": 1042,
                        "file": "quic_shim.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 1043,
                        "file": "quic_shim.ivy",
                        "instruction": "    scid_h = scil;\n"
                    },
                    {
                        "line": 1044,
                        "file": "quic_shim.ivy",
                        "instruction": "    dcid_h = dcil;\n"
                    },
                    {
                        "line": 1045,
                        "file": "quic_shim.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "dcil",
                        "type": "stream_pos"
                    },
                    {
                        "name": "scil",
                        "type": "stream_pos"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 1022,
                "action_name": "export_length_cid_extension",
                "implementation": [
                    {
                        "line": 1021,
                        "file": "quic_shim.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 1022,
                        "file": "quic_shim.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 1023,
                        "file": "quic_shim.ivy",
                        "instruction": "    std::cerr <<  \"export_length_cid_extension\"  << \"\\n\";\n"
                    },
                    {
                        "line": 1024,
                        "file": "quic_shim.ivy",
                        "instruction": "\tchar str_d[20];\n"
                    },
                    {
                        "line": 1025,
                        "file": "quic_shim.ivy",
                        "instruction": "\tsprintf(str_d,\"%llu\",dcil);\n"
                    },
                    {
                        "line": 1026,
                        "file": "quic_shim.ivy",
                        "instruction": "\tif(setenv(\"TEST_DCIL\",str_d,true) != 0) \n"
                    },
                    {
                        "line": 1027,
                        "file": "quic_shim.ivy",
                        "instruction": "\t\tfprintf(stderr, \"setenv failed\\n\");\n"
                    },
                    {
                        "line": 1028,
                        "file": "quic_shim.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 1029,
                        "file": "quic_shim.ivy",
                        "instruction": "\tchar str[20];\n"
                    },
                    {
                        "line": 1030,
                        "file": "quic_shim.ivy",
                        "instruction": "\tsprintf(str,\"%llu\",scil);\n"
                    },
                    {
                        "line": 1031,
                        "file": "quic_shim.ivy",
                        "instruction": "\tif(setenv(\"TEST_SCIL\",str,true) != 0) \n"
                    },
                    {
                        "line": 1032,
                        "file": "quic_shim.ivy",
                        "instruction": "\t\tfprintf(stderr, \"setenv failed\\n\");\n"
                    },
                    {
                        "line": 1033,
                        "file": "quic_shim.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 1034,
                        "file": "quic_shim.ivy",
                        "instruction": "    char str_p[20];\n"
                    },
                    {
                        "line": 1035,
                        "file": "quic_shim.ivy",
                        "instruction": "\tsprintf(str_p,\"%llu\",scil);\n"
                    },
                    {
                        "line": 1036,
                        "file": "quic_shim.ivy",
                        "instruction": "\tif(setenv(\"TEST_PCIL\",str_p,true) != 0) \n"
                    },
                    {
                        "line": 1037,
                        "file": "quic_shim.ivy",
                        "instruction": "\t\tfprintf(stderr, \"setenv failed\\n\");\n"
                    },
                    {
                        "line": 1038,
                        "file": "quic_shim.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "dcil",
                        "type": "stream_pos"
                    },
                    {
                        "name": "scil",
                        "type": "stream_pos"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 1050,
                "action_name": "export_length_cid_mim",
                "implementation": [
                    {
                        "line": 1049,
                        "file": "quic_shim.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 1050,
                        "file": "quic_shim.ivy",
                        "instruction": "    scid_mim = scil;\n"
                    },
                    {
                        "line": 1051,
                        "file": "quic_shim.ivy",
                        "instruction": "    dcid_mim = dcil;\n"
                    },
                    {
                        "line": 1052,
                        "file": "quic_shim.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "dcil",
                        "type": "stream_pos"
                    },
                    {
                        "name": "scil",
                        "type": "stream_pos"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 865,
                "action_name": "is_padding_packet",
                "implementation": [
                    {
                        "line": 864,
                        "file": "quic_shim.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 865,
                        "file": "quic_shim.ivy",
                        "instruction": "    is_padding = true;\n"
                    },
                    {
                        "line": 866,
                        "file": "quic_shim.ivy",
                        "instruction": "    for (unsigned i = 0; i < spkt.size(); i++)\n"
                    },
                    {
                        "line": 867,
                        "file": "quic_shim.ivy",
                        "instruction": "\tis_padding = is_padding && (spkt[i] == 0);\n"
                    },
                    {
                        "line": 868,
                        "file": "quic_shim.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "is_padding",
                    "type": "bool"
                },
                "action_parameters": [
                    {
                        "name": "spkt",
                        "type": "stream_data"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "net_name": "net",
            "net_object": [],
            "net_module": {
                "module_parameters": [],
                "module_attributes": []
            },
            "actions": [
                {
                    "line": 228,
                    "action_name": "net.recv",
                    "implementation": [
                        {
                            "line": 228,
                            "file": "quic_shim.ivy",
                            "instruction": "    call show_socket(s);\n"
                        },
                        {
                            "line": 229,
                            "file": "quic_shim.ivy",
                            "instruction": "    if host = endpoint_id.server {        # for client test (tested implem = client <-> ivy implem = server)\n"
                        },
                        {
                            "line": 230,
                            "file": "quic_shim.ivy",
                            "instruction": "        call server.behavior(host,s,src,pkts);\n"
                        },
                        {
                            "line": 231,
                            "file": "quic_shim.ivy",
                            "instruction": "    } else if host = endpoint_id.client { # for server test (tested implem = server <-> ivy implem = client)\n"
                        },
                        {
                            "line": 232,
                            "file": "quic_shim.ivy",
                            "instruction": "        call client.behavior(host,s,src,pkts);\n"
                        },
                        {
                            "line": 233,
                            "file": "quic_shim.ivy",
                            "instruction": "    } else if host = endpoint_id.mim {\n"
                        },
                        {
                            "line": 234,
                            "file": "quic_shim.ivy",
                            "instruction": "        call mim_agent.behavior(host,s,src,pkts);\n"
                        },
                        {
                            "line": 235,
                            "file": "quic_shim.ivy",
                            "instruction": "    } else if host = endpoint_id.victim {\n"
                        },
                        {
                            "line": 236,
                            "file": "quic_shim.ivy",
                            "instruction": "        call victim_agent.behavior(host,s,src,pkts);\n"
                        },
                        {
                            "line": 237,
                            "file": "quic_shim.ivy",
                            "instruction": "    } else if host = endpoint_id.attacker {\n"
                        },
                        {
                            "line": 238,
                            "file": "quic_shim.ivy",
                            "instruction": "        call attacker.behavior(host,s,src,pkts);\n"
                        },
                        {
                            "line": 239,
                            "file": "quic_shim.ivy",
                            "instruction": "    } else {\n"
                        },
                        {
                            "line": 240,
                            "file": "quic_shim.ivy",
                            "instruction": "        # ERROR\n"
                        },
                        {
                            "line": 241,
                            "file": "quic_shim.ivy",
                            "instruction": "        call undefined_host_error(host,s,src);\n"
                        },
                        {
                            "line": 242,
                            "file": "quic_shim.ivy",
                            "instruction": "    };\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "host",
                            "type": "endpoint_id"
                        },
                        {
                            "name": "s",
                            "type": "net.socket"
                        },
                        {
                            "name": "src",
                            "type": "ip.endpoint"
                        },
                        {
                            "name": "pkts",
                            "type": "prot.arr"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "actions": {
                "line": 812,
                "action_name": "packet_encryption_level",
                "implementation": [
                    {
                        "line": 809,
                        "file": "quic_shim.ivy",
                        "instruction": "    # if zero_rtt_allowed {\n"
                    },
                    {
                        "line": 810,
                        "file": "quic_shim.ivy",
                        "instruction": "        #var scid := packet_scid(h);\n"
                    },
                    {
                        "line": 811,
                        "file": "quic_shim.ivy",
                        "instruction": "        e := quic_packet_type.zero_rtt if ~h.hdr_long # & ~established_1rtt_keys(scid)\n"
                    },
                    {
                        "line": 812,
                        "file": "quic_shim.ivy",
                        "instruction": "            else (quic_packet_type.initial if h.hdr_type = 0x7f \n"
                    },
                    {
                        "line": 813,
                        "file": "quic_shim.ivy",
                        "instruction": "                  else quic_packet_type.handshake);\n"
                    },
                    {
                        "line": 814,
                        "file": "quic_shim.ivy",
                        "instruction": "    # } else {\n"
                    },
                    {
                        "line": 815,
                        "file": "quic_shim.ivy",
                        "instruction": "        # e := quic_packet_type.one_rtt if ~h.hdr_long\n"
                    },
                    {
                        "line": 816,
                        "file": "quic_shim.ivy",
                        "instruction": "        #     else (quic_packet_type.initial if h.hdr_type = 0x7f \n"
                    },
                    {
                        "line": 817,
                        "file": "quic_shim.ivy",
                        "instruction": "        #           else quic_packet_type.handshake);\n"
                    },
                    {
                        "line": 818,
                        "file": "quic_shim.ivy",
                        "instruction": "    # }\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "e",
                    "type": "quic_packet_type"
                },
                "action_parameters": [
                    {
                        "name": "h",
                        "type": "prot.header_info"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 825,
                "action_name": "packet_encryption_level_up",
                "implementation": [
                    {
                        "line": 822,
                        "file": "quic_shim.ivy",
                        "instruction": "    # if zero_rtt_allowed {\n"
                    },
                    {
                        "line": 823,
                        "file": "quic_shim.ivy",
                        "instruction": "        #var scid := packet_scid(h);\n"
                    },
                    {
                        "line": 824,
                        "file": "quic_shim.ivy",
                        "instruction": "        e := quic_packet_type.zero_rtt if ~h.hdr_long #& ~established_1rtt_keys(scid)\n"
                    },
                    {
                        "line": 825,
                        "file": "quic_shim.ivy",
                        "instruction": "            else (quic_packet_type.initial if bvand(h.hdr_type,0x30) = 0x00\n"
                    },
                    {
                        "line": 826,
                        "file": "quic_shim.ivy",
                        "instruction": "                  else quic_packet_type.handshake);\n"
                    },
                    {
                        "line": 827,
                        "file": "quic_shim.ivy",
                        "instruction": "    # } else {\n"
                    },
                    {
                        "line": 828,
                        "file": "quic_shim.ivy",
                        "instruction": "        # e := quic_packet_type.one_rtt if ~h.hdr_long\n"
                    },
                    {
                        "line": 829,
                        "file": "quic_shim.ivy",
                        "instruction": "        #     else (quic_packet_type.initial if bvand(h.hdr_type,0x30) = 0x00\n"
                    },
                    {
                        "line": 830,
                        "file": "quic_shim.ivy",
                        "instruction": "        #           else quic_packet_type.handshake);\n"
                    },
                    {
                        "line": 831,
                        "file": "quic_shim.ivy",
                        "instruction": "    # }\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "e",
                    "type": "quic_packet_type"
                },
                "action_parameters": [
                    {
                        "name": "h",
                        "type": "prot.header_info"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 839,
                "action_name": "packet_scid",
                "implementation": [
                    {
                        "line": 838,
                        "file": "quic_shim.ivy",
                        "instruction": "    if h.hdr_long {\n"
                    },
                    {
                        "line": 839,
                        "file": "quic_shim.ivy",
                        "instruction": "        scid := h.scid;\n"
                    },
                    {
                        "line": 840,
                        "file": "quic_shim.ivy",
                        "instruction": "    } else {\n"
                    },
                    {
                        "line": 841,
                        "file": "quic_shim.ivy",
                        "instruction": "        if used_cid(h.dcid) {\n"
                    },
                    {
                        "line": 842,
                        "file": "quic_shim.ivy",
                        "instruction": "            scid := connected_to(h.dcid);\n"
                    },
                    {
                        "line": 843,
                        "file": "quic_shim.ivy",
                        "instruction": "        } else {\n"
                    },
                    {
                        "line": 844,
                        "file": "quic_shim.ivy",
                        "instruction": "            scid := 0;\n"
                    },
                    {
                        "line": 845,
                        "file": "quic_shim.ivy",
                        "instruction": "        }\n"
                    },
                    {
                        "line": 846,
                        "file": "quic_shim.ivy",
                        "instruction": "    }\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "scid",
                    "type": "cid"
                },
                "action_parameters": [
                    {
                        "name": "h",
                        "type": "prot.header_info"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 254,
                "action_name": "padding_packet_event",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "host",
                        "type": "endpoint_id"
                    },
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "pkt",
                        "type": "stream_data"
                    }
                ],
                "called_from": [
                    {
                        "caller_func": "padding_packet_event",
                        "component": "quic_endpoint.ivy"
                    }
                ],
                "events": true
            }
        },
        {
            "actions": {
                "line": 799,
                "action_name": "recv_0rtt_pkt",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "spkt",
                        "type": "quic_packet_0rtt"
                    }
                ],
                "called_from": [],
                "events": true
            }
        },
        {
            "actions": {
                "line": 249,
                "action_name": "recv_packet",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "host",
                        "type": "endpoint_id"
                    },
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "pkt",
                        "type": "quic_packet"
                    }
                ],
                "called_from": [
                    {
                        "caller_func": "recv_packet",
                        "component": "quic_endpoint.ivy"
                    }
                ],
                "events": true
            }
        },
        {
            "actions": {
                "line": 250,
                "action_name": "recv_packet_mim",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "host",
                        "type": "endpoint_id"
                    },
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "pkt",
                        "type": "stream_data"
                    }
                ],
                "called_from": [],
                "events": true
            }
        },
        {
            "actions": {
                "line": 253,
                "action_name": "recv_packet_victim",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "host",
                        "type": "endpoint_id"
                    },
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "pkt",
                        "type": "stream_data"
                    }
                ],
                "called_from": [
                    {
                        "caller_func": "recv_packet_victim",
                        "component": "quic_endpoint.ivy"
                    }
                ],
                "events": true
            }
        },
        {
            "actions": {
                "line": 798,
                "action_name": "recv_retry_pkt",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "spkt",
                        "type": "quic_packet_retry"
                    }
                ],
                "called_from": [],
                "events": true
            }
        },
        {
            "actions": {
                "line": 719,
                "action_name": "recv_vn_pkt",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "spkt",
                        "type": "quic_packet_vn"
                    }
                ],
                "called_from": [],
                "events": true
            }
        },
        {
            "actions": {
                "line": 856,
                "action_name": "reference_pkt_num",
                "implementation": [
                    {
                        "line": 855,
                        "file": "quic_shim.ivy",
                        "instruction": "    var h := prot.get_header_info(spkt,decrypt);\n"
                    },
                    {
                        "line": 856,
                        "file": "quic_shim.ivy",
                        "instruction": "    var e := packet_encryption_level(h);\n"
                    },
                    {
                        "line": 857,
                        "file": "quic_shim.ivy",
                        "instruction": "    var scid := packet_scid(h);\n"
                    },
                    {
                        "line": 858,
                        "file": "quic_shim.ivy",
                        "instruction": "    last_packet_type(scid)   := packet_encryption_level_up(h);\n"
                    },
                    {
                        "line": 859,
                        "file": "quic_shim.ivy",
                        "instruction": "    last_packet_length(scid) := h.payload_length;\n"
                    },
                    {
                        "line": 860,
                        "file": "quic_shim.ivy",
                        "instruction": "    pnum := last_pkt_num(scid,e);\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "pnum",
                    "type": "pkt_num"
                },
                "action_parameters": [
                    {
                        "name": "spkt",
                        "type": "stream_data"
                    },
                    {
                        "name": "decrypt",
                        "type": "bool"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 948,
                "action_name": "scid_size_pos",
                "implementation": [
                    {
                        "line": 947,
                        "file": "quic_shim.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 948,
                        "file": "quic_shim.ivy",
                        "instruction": "    res = 0;\n"
                    },
                    {
                        "line": 949,
                        "file": "quic_shim.ivy",
                        "instruction": "    if(const char* env_p2 = std::getenv(\"TEST_TYPE\")) { \n"
                    },
                    {
                        "line": 950,
                        "file": "quic_shim.ivy",
                        "instruction": "      if(strcmp(env_p2, \"server\") == 0 || cond) {\n"
                    },
                    {
                        "line": 951,
                        "file": "quic_shim.ivy",
                        "instruction": "         if(const char* env_p3 = std::getenv(\"TEST_SCIL\")) {\n"
                    },
                    {
                        "line": 952,
                        "file": "quic_shim.ivy",
                        "instruction": "            std::cerr << \"TEST_SCIL \" << env_p3 << \"\\n\";\n"
                    },
                    {
                        "line": 953,
                        "file": "quic_shim.ivy",
                        "instruction": "\t        res = atoi(env_p3);\n"
                    },
                    {
                        "line": 954,
                        "file": "quic_shim.ivy",
                        "instruction": "         } else \n"
                    },
                    {
                        "line": 955,
                        "file": "quic_shim.ivy",
                        "instruction": "\t   res = 8;\n"
                    },
                    {
                        "line": 956,
                        "file": "quic_shim.ivy",
                        "instruction": "      } else \n"
                    },
                    {
                        "line": 957,
                        "file": "quic_shim.ivy",
                        "instruction": "\t  res = 8;\n"
                    },
                    {
                        "line": 958,
                        "file": "quic_shim.ivy",
                        "instruction": "    } else \n"
                    },
                    {
                        "line": 959,
                        "file": "quic_shim.ivy",
                        "instruction": "      res = 8;\n"
                    },
                    {
                        "line": 960,
                        "file": "quic_shim.ivy",
                        "instruction": "    std::cerr <<  \"scid_size_pos size: \" <<  res << \"\\n\";\n"
                    },
                    {
                        "line": 961,
                        "file": "quic_shim.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "res",
                    "type": "stream_pos"
                },
                "action_parameters": [
                    {
                        "name": "cond",
                        "type": "bool"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 311,
                "action_name": "show_biatch",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    }
                ],
                "called_from": [
                    {
                        "caller_func": "show_biatch",
                        "component": "quic_shim.ivy"
                    }
                ],
                "events": true
            }
        },
        {
            "actions": {
                "line": 261,
                "action_name": "show_last_datagram_size",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "size",
                        "type": "stream_pos"
                    }
                ],
                "called_from": [],
                "events": true
            }
        },
        {
            "actions": {
                "line": 626,
                "action_name": "show_set_initial_keys",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "ik",
                        "type": "stream_data"
                    }
                ],
                "called_from": [],
                "events": true
            }
        },
        {
            "actions": {
                "line": 263,
                "action_name": "show_socket",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "n",
                        "type": "net.socket"
                    }
                ],
                "called_from": [],
                "events": true
            }
        },
        {
            "tls_api_name": "tls_api",
            "tls_api_object": [],
            "tls_api_module": {
                "module_parameters": [],
                "module_attributes": []
            },
            "actions": [
                {
                    "line": 289,
                    "action_name": "tls_api.lower.send",
                    "implementation": [
                        {
                            "line": 287,
                            "file": "quic_shim.ivy",
                            "instruction": "    #if dst_is_generated_tls(tls_id_to_src(tls_id)) { # For MiM agent, we dont wont for now TLS events\n"
                        },
                        {
                            "line": 288,
                            "file": "quic_shim.ivy",
                            "instruction": "        var early_data_end := stream_data.empty; # TODO global -> quic-go crash if not global\n"
                        },
                        {
                            "line": 289,
                            "file": "quic_shim.ivy",
                            "instruction": "        call show_biatch(tls_id_to_dst(tls_id));\n"
                        },
                        {
                            "line": 290,
                            "file": "quic_shim.ivy",
                            "instruction": "        early_data_end := early_data_end.append(0xff);\n"
                        },
                        {
                            "line": 291,
                            "file": "quic_shim.ivy",
                            "instruction": "        early_data_end := early_data_end.append(0xff);\n"
                        },
                        {
                            "line": 292,
                            "file": "quic_shim.ivy",
                            "instruction": "        early_data_end := early_data_end.append(0xff);\n"
                        },
                        {
                            "line": 293,
                            "file": "quic_shim.ivy",
                            "instruction": "        early_data_end := early_data_end.append(0xff);\n"
                        },
                        {
                            "line": 294,
                            "file": "quic_shim.ivy",
                            "instruction": "        # var e := quic_packet_type.initial if lev = 0\n"
                        },
                        {
                            "line": 295,
                            "file": "quic_shim.ivy",
                            "instruction": "        #          else (quic_packet_type.handshake if lev = 2 else quic_packet_type.one_rtt);\n"
                        },
                        {
                            "line": 296,
                            "file": "quic_shim.ivy",
                            "instruction": "        # if zero_rtt_allowed {\n"
                        },
                        {
                            "line": 297,
                            "file": "quic_shim.ivy",
                            "instruction": "        var e := quic_packet_type.initial if lev = 0\n"
                        },
                        {
                            "line": 298,
                            "file": "quic_shim.ivy",
                            "instruction": "                else (quic_packet_type.handshake if lev = 2 else quic_packet_type.zero_rtt);\n"
                        },
                        {
                            "line": 299,
                            "file": "quic_shim.ivy",
                            "instruction": "        if(bytes.value(0) = 0x4 & bytes.segment(bytes.end-4,bytes.end) = early_data_end) {\n"
                        },
                        {
                            "line": 300,
                            "file": "quic_shim.ivy",
                            "instruction": "            e := quic_packet_type.one_rtt; # TODO \n"
                        },
                        {
                            "line": 301,
                            "file": "quic_shim.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 302,
                            "file": "quic_shim.ivy",
                            "instruction": "        # };\n"
                        },
                        {
                            "line": 303,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 304,
                            "file": "quic_shim.ivy",
                            "instruction": "        var scid := tls_id_to_cid(tls_id);\n"
                        },
                        {
                            "line": 305,
                            "file": "quic_shim.ivy",
                            "instruction": "        call tls_send_event(tls_id_to_src(tls_id), tls_id_to_dst(tls_id), scid,\n"
                        },
                        {
                            "line": 306,
                            "file": "quic_shim.ivy",
                            "instruction": "                            0, bytes,crypto_data_end(scid,e),e, tls_id);\n"
                        },
                        {
                            "line": 307,
                            "file": "quic_shim.ivy",
                            "instruction": "    #}\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "tls_id",
                            "type": "tls_api.id"
                        },
                        {
                            "name": "bytes",
                            "type": "stream_data"
                        },
                        {
                            "name": "lev",
                            "type": "tls_api.lower.level"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [
                            {
                                "caller_func": "tls_api.lower.send",
                                "component": "quic_shim.ivy"
                            }
                        ],
                        "assertions": [
                            {
                                "line": 276,
                                "file": "quic_security.ivy",
                                "assertion": "require crypto_data_present(scid,e,cpos) -> crypto_data(scid,e).value(cpos) = byte;\n"
                            },
                            {
                                "line": 658,
                                "file": "quic_frame.ivy",
                                "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                            },
                            {
                                "line": 660,
                                "file": "quic_frame.ivy",
                                "assertion": "require ~(e = quic_packet_type.initial) & ~(e = quic_packet_type.handshake); #& ~(e = quic_packet_type.handshake)\n"
                            },
                            {
                                "line": 661,
                                "file": "quic_frame.ivy",
                                "assertion": "require ~conn_closed(scid);\n"
                            },
                            {
                                "line": 664,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.handshake -> established_handshake_keys(scid);  # [4]\n"
                            },
                            {
                                "line": 665,
                                "file": "quic_frame.ivy",
                                "assertion": "require e = quic_packet_type.one_rtt -> established_1rtt_keys(scid);  # [4]\n"
                            },
                            {
                                "line": 668,
                                "file": "quic_frame.ivy",
                                "assertion": "require ~(e = quic_packet_type.version_negociation) & ~(e = quic_packet_type.retry) & ~(e = quic_packet_type.zero_rtt);\n"
                            },
                            {
                                "line": 670,
                                "file": "quic_frame.ivy",
                                "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                            },
                            {
                                "line": 676,
                                "file": "quic_frame.ivy",
                                "assertion": "require f.ack_ranges.end > 0;\n"
                            },
                            {
                                "line": 680,
                                "file": "quic_frame.ivy",
                                "assertion": "require idx > 0 -> ack_range.gap < last - 1;\n"
                            },
                            {
                                "line": 682,
                                "file": "quic_frame.ivy",
                                "assertion": "require ack_range.ranges <= upper;\n"
                            },
                            {
                                "line": 686,
                                "file": "quic_frame.ivy",
                                "assertion": "require sent_pkt(dcid,e,jdx);  # [1]\n"
                            },
                            {
                                "line": 700,
                                "file": "quic_frame.ivy",
                                "assertion": "require some_new_ack;\n"
                            },
                            {
                                "line": 701,
                                "file": "quic_frame.ivy",
                                "assertion": "require f.largest_acked = max_acked(dcid,e);\n"
                            },
                            {
                                "line": 274,
                                "file": "ivy_quic_client_behavior.ivy",
                                "assertion": "require scid = the_cid;\n"
                            }
                        ]
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 329,
                    "action_name": "tls_api.upper.keys_established",
                    "implementation": [
                        {
                            "line": 326,
                            "file": "quic_shim.ivy",
                            "instruction": "    # var e := quic_packet_type.handshake if lev = 2 else quic_packet_type.one_rtt;\n"
                        },
                        {
                            "line": 327,
                            "file": "quic_shim.ivy",
                            "instruction": "    # if zero_rtt_allowed {\n"
                        },
                        {
                            "line": 328,
                            "file": "quic_shim.ivy",
                            "instruction": "    var e := quic_packet_type.handshake if lev = 2 else quic_packet_type.zero_rtt;\n"
                        },
                        {
                            "line": 329,
                            "file": "quic_shim.ivy",
                            "instruction": "    # };\n"
                        },
                        {
                            "line": 330,
                            "file": "quic_shim.ivy",
                            "instruction": "    call tls_keys_established_event(tls_id_to_cid(tls_id),e); #tls_id = server.tls_id  for client ?\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "tls_id",
                            "type": "tls_api.id"
                        },
                        {
                            "name": "lev",
                            "type": "tls_api.upper.level"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "actions": {
                "line": 257,
                "action_name": "undecryptable_packet_event",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "host",
                        "type": "endpoint_id"
                    },
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "pkt",
                        "type": "stream_data"
                    }
                ],
                "called_from": [],
                "events": true
            }
        },
        {
            "actions": {
                "line": 259,
                "action_name": "undefined_host_error",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "host",
                        "type": "endpoint_id"
                    },
                    {
                        "name": "s",
                        "type": "net.socket"
                    },
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    }
                ],
                "called_from": [],
                "events": true
            }
        },
        {
            "actions": {
                "line": 800,
                "action_name": "version_not_found_event",
                "action_return": null,
                "exported": false,
                "action_parameters": null,
                "called_from": [],
                "events": true
            }
        },
        {
            "functions": [
                {
                    "name": "client_initial_rcid : cid\n",
                    "comment": "",
                    "line": 76,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "client_initial_scid : cid\n",
                    "comment": "",
                    "line": 77,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "client_initial_scil : stream_pos\n",
                    "comment": "",
                    "line": 78,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "client_initial_dcid : cid\n",
                    "comment": "",
                    "line": 79,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "client_initial_dcil : stream_pos\n",
                    "comment": "",
                    "line": 80,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "client_initial_version : version\n",
                    "comment": "",
                    "line": 81,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "nclients : stream_pos\n",
                    "comment": "",
                    "line": 103,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "the_cids : cids\n",
                    "comment": "",
                    "line": 105,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "server_cids : cids\n",
                    "comment": "",
                    "line": 106,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "last_datagram_received_size : stream_pos\n",
                    "comment": "",
                    "line": 123,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "initial_version : version ",
                    "comment": " init in each entities/test",
                    "line": 127,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "last_packet_type(C:cid) : quic_packet_type\n",
                    "comment": "",
                    "line": 163,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "last_packet_length(C:cid) : stream_pos\n",
                    "comment": "",
                    "line": 164,
                    "file": "quic_shim.ivy"
                }
            ],
            "relations": [
                {
                    "name": "initial_keys_set(C:cid)\n",
                    "comment": "",
                    "line": 73,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "tp_client_set ",
                    "comment": " (C:cid) TODO strange segfault for level 2 not set with quant ",
                    "line": 74,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "client_non_zero_scil\n",
                    "comment": "",
                    "line": 83,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "zero_rtt_allowed\n",
                    "comment": "",
                    "line": 85,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "zero_rtt_sent\n",
                    "comment": "",
                    "line": 86,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "send_connection_close ",
                    "comment": " TODO, send co_close at end of test or not",
                    "line": 87,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "zero_rtt_client_test\n",
                    "comment": "",
                    "line": 99,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "zero_rtt_server_test ",
                    "comment": " TODO should be parameters",
                    "line": 100,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "allowed_migration \n",
                    "comment": "",
                    "line": 119,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "allowed_multiple_migration\n",
                    "comment": "",
                    "line": 120,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "first_datagram_received\n",
                    "comment": "",
                    "line": 122,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "version_negociated\n",
                    "comment": "",
                    "line": 126,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "negocation_of_version(E:ip.endpoint)\n",
                    "comment": "",
                    "line": 128,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "negocation_of_version_initiated(E:ip.endpoint)\n",
                    "comment": "",
                    "line": 129,
                    "file": "quic_shim.ivy"
                },
                {
                    "name": "version_not_found(E:ip.endpoint)\n",
                    "comment": "",
                    "line": 175,
                    "file": "quic_shim.ivy"
                }
            ]
        }
    ],
    "ivy_quic_client_behavior.ivy": [
        {
            "actions": {
                "line": 404,
                "action_name": "client_send_event",
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": [
                        {
                            "line": 412,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    require s = current_stream;\n"
                        },
                        {
                            "line": 413,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    var tp := trans_params(the_cid);\n"
                        },
                        {
                            "line": 414,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 415,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    if version_negociated {\n"
                        },
                        {
                            "line": 416,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        require src = client_vn;\n"
                        },
                        {
                            "line": 417,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    } else {\n"
                        },
                        {
                            "line": 418,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        if ~disable_active_migration.is_set(tp) {\n"
                        },
                        {
                            "line": 419,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "            if ~migration_done | allowed_multiple_migration  { #only one migration\n"
                        },
                        {
                            "line": 420,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "                require src = client.ep | src = client_alt;\n"
                        },
                        {
                            "line": 421,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "            } else {\n"
                        },
                        {
                            "line": 422,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "                require src = client_alt;\n"
                        },
                        {
                            "line": 423,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "            }\n"
                        },
                        {
                            "line": 424,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        } else {\n"
                        },
                        {
                            "line": 425,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "            require src = client.ep;\n"
                        },
                        {
                            "line": 426,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        }\n"
                        },
                        {
                            "line": 427,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 428,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 429,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    require dst = server.ep;\n"
                        },
                        {
                            "line": 430,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    if ~zero_rtt_server_test | zero_rtt_sent {\n"
                        },
                        {
                            "line": 431,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        require connected(the_cid) & dcid = connected_to(the_cid);\n"
                        },
                        {
                            "line": 432,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    } else {\n"
                        },
                        {
                            "line": 433,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        require  dcid ~= the_cid;\n"
                        },
                        {
                            "line": 434,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 435,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    require stream_length(dcid,s) = stream_app_data_end(dcid,s);\n"
                        },
                        {
                            "line": 436,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    require stream_length(dcid,s) < end & end <= http_request.end;\n"
                        },
                        {
                            "line": 437,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    require current_stream < 60;\n"
                        },
                        {
                            "line": 438,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    ...\n"
                        },
                        {
                            "line": 439,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    while end < http_request.end & http_request.value(end) ~= 10 {\n"
                        },
                        {
                            "line": 440,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        end := end.next\n"
                        },
                        {
                            "line": 441,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 442,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    if end < http_request.end {\n"
                        },
                        {
                            "line": 443,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        end := end.next\n"
                        },
                        {
                            "line": 444,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 445,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    var data := http_request.segment(stream_length(dcid,s),end);\n"
                        },
                        {
                            "line": 446,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "#    call app_send_event(src,dst,dcid,s,data,end = http_request.end);\n"
                        },
                        {
                            "line": 447,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    call app_send_event(src,dst,dcid,s,data,stream_length(dcid,s),true);\n"
                        },
                        {
                            "line": 448,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    current_stream := current_stream + 4;\n"
                        }
                    ]
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dcid",
                        "type": "cid"
                    },
                    {
                        "name": "s",
                        "type": "stream_id"
                    },
                    {
                        "name": "end",
                        "type": "stream_pos"
                    }
                ],
                "exported": true,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [
                        {
                            "caller_func": "Environment",
                            "component": "Environment"
                        }
                    ],
                    "assertions": [
                        {
                            "line": 413,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require s = current_stream;\n"
                        },
                        {
                            "line": 417,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require src = client_vn;\n"
                        },
                        {
                            "line": 421,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require src = client.ep | src = client_alt;\n"
                        },
                        {
                            "line": 423,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require src = client_alt;\n"
                        },
                        {
                            "line": 426,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require src = client.ep;\n"
                        },
                        {
                            "line": 430,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require dst = server.ep;\n"
                        },
                        {
                            "line": 432,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require connected(the_cid) & dcid = connected_to(the_cid);\n"
                        },
                        {
                            "line": 434,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require  dcid ~= the_cid;\n"
                        },
                        {
                            "line": 436,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require stream_length(dcid,s) = stream_app_data_end(dcid,s);\n"
                        },
                        {
                            "line": 437,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require stream_length(dcid,s) < end & end <= http_request.end;\n"
                        },
                        {
                            "line": 438,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require current_stream < 60;\n"
                        },
                        {
                            "line": 938,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 940,
                            "file": "quic_frame.ivy",
                            "assertion": "require ~conn_closed(scid);  # [1]\n"
                        },
                        {
                            "line": 942,
                            "file": "quic_frame.ivy",
                            "assertion": "require e ~= quic_packet_type.zero_rtt;  # [4]\n"
                        },
                        {
                            "line": 945,
                            "file": "quic_frame.ivy",
                            "assertion": "require ((f.offset) + (f.length)) <= crypto_data_end(scid,e);  # [2]\n"
                        },
                        {
                            "line": 946,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.data = crypto_data(scid,e).segment(f.offset,f.offset+f.length);  # [2]\n"
                        },
                        {
                            "line": 260,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require scid = the_cid;\n"
                        },
                        {
                            "line": 261,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require f.length > 0;\n"
                        },
                        {
                            "line": 262,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require f.offset = crypto_length(scid,e);\n"
                        },
                        {
                            "line": 263,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require f.length = (crypto_data_end(scid,e)) - f.offset;\n"
                        }
                    ]
                }
            }
        },
        {
            "actions": {
                "line": 96,
                "action_name": "dst_is_generated_tls",
                "implementation": [
                    {
                        "line": 95,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    res := dst = client.ep | dst = client_alt | dst = client_vn\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "res",
                    "type": "bool"
                },
                "action_parameters": [
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 37,
                "action_name": "endpoint_to_pid",
                "implementation": [
                    {
                        "line": 36,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    if src = client.ep {\n"
                    },
                    {
                        "line": 37,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "        pid := endpoint_id.client;\n"
                    },
                    {
                        "line": 38,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    } else if src = client_alt {\n"
                    },
                    {
                        "line": 39,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "        pid:= endpoint_id.client_alt;\n"
                    },
                    {
                        "line": 40,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    } else if src = client_vn {\n"
                    },
                    {
                        "line": 41,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "        pid:= endpoint_id.client_vn;\n"
                    },
                    {
                        "line": 42,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    } \n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "pid",
                    "type": "endpoint_id"
                },
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 63,
                "action_name": "endpoint_to_socket",
                "implementation": [
                    {
                        "line": 62,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    if src = client.ep {\n"
                    },
                    {
                        "line": 63,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "        socket := sock;\n"
                    },
                    {
                        "line": 64,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    } else if src = client_alt {\n"
                    },
                    {
                        "line": 65,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "        socket := sock_alt;\n"
                    },
                    {
                        "line": 66,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    } else if src = client_vn {\n"
                    },
                    {
                        "line": 67,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "        socket := sock_vn;\n"
                    },
                    {
                        "line": 68,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    } \n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "socket",
                    "type": "net.socket"
                },
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 478,
                "action_name": "show_tls_send_event",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "dcid",
                        "type": "cid"
                    },
                    {
                        "name": "data",
                        "type": "stream_data"
                    },
                    {
                        "name": "pos",
                        "type": "stream_pos"
                    },
                    {
                        "name": "e",
                        "type": "quic_packet_type"
                    },
                    {
                        "name": "tls_id",
                        "type": "tls_api.id"
                    }
                ],
                "called_from": [],
                "events": true
            }
        },
        {
            "actions": {
                "line": 49,
                "action_name": "socket_endpoint",
                "implementation": [
                    {
                        "line": 48,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    src := client.ep if host = endpoint_id.client else (client_vn if version_negociated else client_alt)\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "src",
                    "type": "ip.endpoint"
                },
                "action_parameters": [
                    {
                        "name": "host",
                        "type": "endpoint_id"
                    },
                    {
                        "name": "s",
                        "type": "net.socket"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 53,
                "action_name": "socket_endpoint_mim",
                "implementation": [
                    {
                        "line": 52,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    dst := client.ep if (is_mim_standalone | src = mim_server_target.ep) else server.ep;\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "dst",
                    "type": "ip.endpoint"
                },
                "action_parameters": [
                    {
                        "name": "host",
                        "type": "endpoint_id"
                    },
                    {
                        "name": "s",
                        "type": "net.socket"
                    },
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 107,
                "action_name": "src_tls_id",
                "implementation": [
                    {
                        "line": 106,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    tls_id := client.tls_id if src = client.ep \n"
                    },
                    {
                        "line": 107,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    else second_client.tls_id; #TODO can cause error server vn eg\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "tls_id",
                    "type": "tls_api.id"
                },
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "src_tls_id",
                        "component": "quic_infer.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 85,
                "action_name": "tls_id_to_cid",
                "implementation": [
                    {
                        "line": 84,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    scid := the_cid;\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "scid",
                    "type": "cid"
                },
                "action_parameters": [
                    {
                        "name": "tls_id",
                        "type": "tls_api.id"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 79,
                "action_name": "tls_id_to_dst",
                "implementation": [
                    {
                        "line": 78,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    dst := server.ep if tls_id = client.tls_id else client.ep;\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "dst",
                    "type": "ip.endpoint"
                },
                "action_parameters": [
                    {
                        "name": "tls_id",
                        "type": "tls_api.id"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 72,
                "action_name": "tls_id_to_src",
                "implementation": [
                    {
                        "line": 71,
                        "file": "ivy_quic_client_behavior.ivy",
                        "instruction": "    src := client.ep if tls_id = client.tls_id & ~version_negociated else (client_vn if tls_id = client.tls_id & version_negociated else server.ep);\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "src",
                    "type": "ip.endpoint"
                },
                "action_parameters": [
                    {
                        "name": "tls_id",
                        "type": "tls_api.id"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "functions": [],
            "relations": []
        }
    ],
    "quic_packet.ivy": [
        {
            "actions": {
                "line": 662,
                "action_name": "handle_client_transport_parameters",
                "implementation": [
                    {
                        "line": 660,
                        "file": "quic_packet.ivy",
                        "instruction": "#    call client_transport_parameters_event(src,dst,scid,tps);\n"
                    },
                    {
                        "line": 661,
                        "file": "quic_packet.ivy",
                        "instruction": "    var idx := tps.transport_parameters.begin;\n"
                    },
                    {
                        "line": 662,
                        "file": "quic_packet.ivy",
                        "instruction": "    while idx < tps.transport_parameters.end {\n"
                    },
                    {
                        "line": 663,
                        "file": "quic_packet.ivy",
                        "instruction": "        trans_params(scid) := tps.transport_parameters.value(idx).set(trans_params(scid));\n"
                    },
                    {
                        "line": 664,
                        "file": "quic_packet.ivy",
                        "instruction": "        idx := idx.next\n"
                    },
                    {
                        "line": 665,
                        "file": "quic_packet.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 666,
                        "file": "quic_packet.ivy",
                        "instruction": "    #require initial_max_stream_data_bidi_local.is_set(trans_params(scid));  # [1]\n"
                    },
                    {
                        "line": 667,
                        "file": "quic_packet.ivy",
                        "instruction": "    #require initial_max_data.is_set(trans_params(scid));  # [2]\n"
                    },
                    {
                        "line": 668,
                        "file": "quic_packet.ivy",
                        "instruction": "    #require max_idle_timeout.is_set(trans_params(scid));  # [3] TODO\n"
                    },
                    {
                        "line": 669,
                        "file": "quic_packet.ivy",
                        "instruction": "    #require initial_max_stream_data_bidi_remote.is_set(trans_params(scid));  # [1]\n"
                    },
                    {
                        "line": 670,
                        "file": "quic_packet.ivy",
                        "instruction": "    #require initial_max_stream_data_uni.is_set(trans_params(scid));  # [1]\n"
                    },
                    {
                        "line": 671,
                        "file": "quic_packet.ivy",
                        "instruction": "    if ~ _generating  { \n"
                    },
                    {
                        "line": 672,
                        "file": "quic_packet.ivy",
                        "instruction": "        # for tests where we check that the implementation behave well if not present \n"
                    },
                    {
                        "line": 673,
                        "file": "quic_packet.ivy",
                        "instruction": "        if client_non_zero_scil & ~(scid = 1) & (client_initial_version = 0x00000001 | client_initial_version = 0x00000001){ # TODO \n"
                    },
                    {
                        "line": 674,
                        "file": "quic_packet.ivy",
                        "instruction": "            require initial_source_connection_id.is_set(trans_params(scid));  # [5]\n"
                    },
                    {
                        "line": 675,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 676,
                        "file": "quic_packet.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 677,
                        "file": "quic_packet.ivy",
                        "instruction": "    if is_client_hello {\n"
                    },
                    {
                        "line": 678,
                        "file": "quic_packet.ivy",
                        "instruction": "        require ~stateless_reset_token.is_set(trans_params(scid));  # [4]\n"
                    },
                    {
                        "line": 679,
                        "file": "quic_packet.ivy",
                        "instruction": "    } else {\n"
                    },
                    {
                        "line": 680,
                        "file": "quic_packet.ivy",
                        "instruction": "        if ~ _generating & ~(scid = 1) {  # TODO\n"
                    },
                    {
                        "line": 681,
                        "file": "quic_packet.ivy",
                        "instruction": "            require original_destination_connection_id.is_set(trans_params(scid));  # [6]\n"
                    },
                    {
                        "line": 682,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 683,
                        "file": "quic_packet.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 684,
                        "file": "quic_packet.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 685,
                        "file": "quic_packet.ivy",
                        "instruction": "    if ~is_client_hello & (retry_recv(client_initial_rcid) | retry_sent(client_initial_rcid)) & ~zero_length_token {\n"
                    },
                    {
                        "line": 686,
                        "file": "quic_packet.ivy",
                        "instruction": "        require retry_source_connection_id.is_set(trans_params(scid));\n"
                    },
                    {
                        "line": 687,
                        "file": "quic_packet.ivy",
                        "instruction": "        require retry_source_connection_id.value(trans_params(scid)).rcid = client_initial_rcid; # todo generalize\n"
                    },
                    {
                        "line": 688,
                        "file": "quic_packet.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 689,
                        "file": "quic_packet.ivy",
                        "instruction": "    \n"
                    },
                    {
                        "line": 690,
                        "file": "quic_packet.ivy",
                        "instruction": "    # [7]\n"
                    },
                    {
                        "line": 691,
                        "file": "quic_packet.ivy",
                        "instruction": "    if min_ack_delay.is_set(trans_params(scid)) & max_ack_delay.is_set(trans_params(scid)) {\n"
                    },
                    {
                        "line": 692,
                        "file": "quic_packet.ivy",
                        "instruction": "        var min_ack_milli := min_ack_delay.value(trans_params(scid)).exponent_8 * 1000;\n"
                    },
                    {
                        "line": 693,
                        "file": "quic_packet.ivy",
                        "instruction": "        require  min_ack_milli < max_ack_delay.value(trans_params(scid)).exponent_8;  # [1]\n"
                    },
                    {
                        "line": 694,
                        "file": "quic_packet.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 695,
                        "file": "quic_packet.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 696,
                        "file": "quic_packet.ivy",
                        "instruction": "    # var initial_max_stream_data_uni_server_0rtt : stream_pos_32;\n"
                    },
                    {
                        "line": 697,
                        "file": "quic_packet.ivy",
                        "instruction": "    # var initial_max_stream_data_bidi_remote_server_0rtt : stream_pos_32;\n"
                    },
                    {
                        "line": 698,
                        "file": "quic_packet.ivy",
                        "instruction": "    # var initial_max_data_server_0rtt : stream_pos_32;\n"
                    },
                    {
                        "line": 699,
                        "file": "quic_packet.ivy",
                        "instruction": "    # var initial_max_stream_data_bidi_local_server_0rtt : stream_pos_32;\n"
                    },
                    {
                        "line": 700,
                        "file": "quic_packet.ivy",
                        "instruction": "    # var initial_max_stream_id_bidi_server_0rtt : stream_pos_32;\n"
                    },
                    {
                        "line": 701,
                        "file": "quic_packet.ivy",
                        "instruction": "    # var active_connection_id_limit_server_0rtt : stream_pos_32;\n"
                    },
                    {
                        "line": 702,
                        "file": "quic_packet.ivy",
                        "instruction": "    # [6-0rtt]\n"
                    },
                    {
                        "line": 703,
                        "file": "quic_packet.ivy",
                        "instruction": "    if zero_rtt_server_test & ~is_client_hello {\n"
                    },
                    {
                        "line": 704,
                        "file": "quic_packet.ivy",
                        "instruction": "        if initial_max_stream_data_uni.is_set(trans_params(scid)) {\n"
                    },
                    {
                        "line": 705,
                        "file": "quic_packet.ivy",
                        "instruction": "            require initial_max_stream_data_uni.value(trans_params(scid)).stream_pos_32 >= initial_max_stream_data_uni_server_0rtt; # todo generalize\n"
                    },
                    {
                        "line": 706,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 707,
                        "file": "quic_packet.ivy",
                        "instruction": "        if initial_max_stream_data_bidi_remote.is_set(trans_params(scid)) {\n"
                    },
                    {
                        "line": 708,
                        "file": "quic_packet.ivy",
                        "instruction": "            require initial_max_stream_data_bidi_remote.value(trans_params(scid)).stream_pos_32 >= initial_max_stream_data_bidi_remote_server_0rtt; # todo generalize\n"
                    },
                    {
                        "line": 709,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 710,
                        "file": "quic_packet.ivy",
                        "instruction": "        if initial_max_data.is_set(trans_params(scid)) {\n"
                    },
                    {
                        "line": 711,
                        "file": "quic_packet.ivy",
                        "instruction": "            require initial_max_data.value(trans_params(scid)).stream_pos_32 >= initial_max_data_server_0rtt; # todo generalize\n"
                    },
                    {
                        "line": 712,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 713,
                        "file": "quic_packet.ivy",
                        "instruction": "        if initial_max_stream_data_bidi_local.is_set(trans_params(scid)) {\n"
                    },
                    {
                        "line": 714,
                        "file": "quic_packet.ivy",
                        "instruction": "            require initial_max_stream_data_bidi_local.value(trans_params(scid)).stream_pos_32 >= initial_max_stream_data_bidi_local_server_0rtt; # todo generalize\n"
                    },
                    {
                        "line": 715,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 716,
                        "file": "quic_packet.ivy",
                        "instruction": "        if initial_max_stream_id_bidi.is_set(trans_params(scid)) {\n"
                    },
                    {
                        "line": 717,
                        "file": "quic_packet.ivy",
                        "instruction": "            require initial_max_stream_id_bidi.value(trans_params(scid)).stream_id_16 >= initial_max_stream_id_bidi_server_0rtt; # todo generalize\n"
                    },
                    {
                        "line": 718,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 719,
                        "file": "quic_packet.ivy",
                        "instruction": "        if active_connection_id_limit.is_set(trans_params(scid)) {\n"
                    },
                    {
                        "line": 720,
                        "file": "quic_packet.ivy",
                        "instruction": "            require active_connection_id_limit.value(trans_params(scid)).stream_pos_32 >= active_connection_id_limit_server_0rtt; # todo generalize\n"
                    },
                    {
                        "line": 721,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 722,
                        "file": "quic_packet.ivy",
                        "instruction": "    };\n"
                    },
                    {
                        "line": 723,
                        "file": "quic_packet.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 724,
                        "file": "quic_packet.ivy",
                        "instruction": "    # save server TPs\n"
                    },
                    {
                        "line": 725,
                        "file": "quic_packet.ivy",
                        "instruction": "    if ~is_client_hello {\n"
                    },
                    {
                        "line": 726,
                        "file": "quic_packet.ivy",
                        "instruction": "        if initial_max_stream_data_uni.is_set(trans_params(scid)) {\n"
                    },
                    {
                        "line": 727,
                        "file": "quic_packet.ivy",
                        "instruction": "            call tls_api.upper.save_initial_max_stream_data_uni(initial_max_stream_data_uni.value(trans_params(scid)).stream_pos_32);\n"
                    },
                    {
                        "line": 728,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 729,
                        "file": "quic_packet.ivy",
                        "instruction": "        if initial_max_stream_data_bidi_remote.is_set(trans_params(scid)) {\n"
                    },
                    {
                        "line": 730,
                        "file": "quic_packet.ivy",
                        "instruction": "            call tls_api.upper.save_initial_max_stream_data_bidi_remote(initial_max_stream_data_bidi_remote.value(trans_params(scid)).stream_pos_32);\n"
                    },
                    {
                        "line": 731,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 732,
                        "file": "quic_packet.ivy",
                        "instruction": "        if initial_max_data.is_set(trans_params(scid)) {\n"
                    },
                    {
                        "line": 733,
                        "file": "quic_packet.ivy",
                        "instruction": "            call tls_api.upper.save_initial_max_data(initial_max_data.value(trans_params(scid)).stream_pos_32);\n"
                    },
                    {
                        "line": 734,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 735,
                        "file": "quic_packet.ivy",
                        "instruction": "        if initial_max_stream_data_bidi_local.is_set(trans_params(scid)) {\n"
                    },
                    {
                        "line": 736,
                        "file": "quic_packet.ivy",
                        "instruction": "            call tls_api.upper.save_initial_max_stream_data_bidi_local(initial_max_stream_data_bidi_local.value(trans_params(scid)).stream_pos_32);\n"
                    },
                    {
                        "line": 737,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 738,
                        "file": "quic_packet.ivy",
                        "instruction": "        if initial_max_stream_id_bidi.is_set(trans_params(scid)) {\n"
                    },
                    {
                        "line": 739,
                        "file": "quic_packet.ivy",
                        "instruction": "            call tls_api.upper.save_initial_max_stream_id_bidi(initial_max_stream_id_bidi.value(trans_params(scid)).stream_id_16);\n"
                    },
                    {
                        "line": 740,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 741,
                        "file": "quic_packet.ivy",
                        "instruction": "        if active_connection_id_limit.is_set(trans_params(scid)) {\n"
                    },
                    {
                        "line": 742,
                        "file": "quic_packet.ivy",
                        "instruction": "            call tls_api.upper.save_active_connection_id_limit(active_connection_id_limit.value(trans_params(scid)).stream_pos_32);\n"
                    },
                    {
                        "line": 743,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 744,
                        "file": "quic_packet.ivy",
                        "instruction": "    }\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "tps",
                        "type": "quic_transport_parameters"
                    },
                    {
                        "name": "is_client_hello",
                        "type": "bool"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "handle_client_transport_parameters",
                        "component": "quic_packet.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [
                        {
                            "caller_func": "handle_tls_extensions",
                            "component": "quic_packet.ivy"
                        }
                    ],
                    "assertions": [
                        {
                            "line": 675,
                            "file": "quic_packet.ivy",
                            "assertion": "require initial_source_connection_id.is_set(trans_params(scid));  # [5]\n"
                        },
                        {
                            "line": 679,
                            "file": "quic_packet.ivy",
                            "assertion": "require ~stateless_reset_token.is_set(trans_params(scid));  # [4]\n"
                        },
                        {
                            "line": 682,
                            "file": "quic_packet.ivy",
                            "assertion": "require original_destination_connection_id.is_set(trans_params(scid));  # [6]\n"
                        },
                        {
                            "line": 687,
                            "file": "quic_packet.ivy",
                            "assertion": "require retry_source_connection_id.is_set(trans_params(scid));\n"
                        },
                        {
                            "line": 688,
                            "file": "quic_packet.ivy",
                            "assertion": "require retry_source_connection_id.value(trans_params(scid)).rcid = client_initial_rcid; # todo generalize\n"
                        },
                        {
                            "line": 694,
                            "file": "quic_packet.ivy",
                            "assertion": "require  min_ack_milli < max_ack_delay.value(trans_params(scid)).exponent_8;  # [1]\n"
                        },
                        {
                            "line": 706,
                            "file": "quic_packet.ivy",
                            "assertion": "require initial_max_stream_data_uni.value(trans_params(scid)).stream_pos_32 >= initial_max_stream_data_uni_server_0rtt; # todo generalize\n"
                        },
                        {
                            "line": 709,
                            "file": "quic_packet.ivy",
                            "assertion": "require initial_max_stream_data_bidi_remote.value(trans_params(scid)).stream_pos_32 >= initial_max_stream_data_bidi_remote_server_0rtt; # todo generalize\n"
                        },
                        {
                            "line": 712,
                            "file": "quic_packet.ivy",
                            "assertion": "require initial_max_data.value(trans_params(scid)).stream_pos_32 >= initial_max_data_server_0rtt; # todo generalize\n"
                        },
                        {
                            "line": 715,
                            "file": "quic_packet.ivy",
                            "assertion": "require initial_max_stream_data_bidi_local.value(trans_params(scid)).stream_pos_32 >= initial_max_stream_data_bidi_local_server_0rtt; # todo generalize\n"
                        },
                        {
                            "line": 718,
                            "file": "quic_packet.ivy",
                            "assertion": "require initial_max_stream_id_bidi.value(trans_params(scid)).stream_id_16 >= initial_max_stream_id_bidi_server_0rtt; # todo generalize\n"
                        },
                        {
                            "line": 721,
                            "file": "quic_packet.ivy",
                            "assertion": "require active_connection_id_limit.value(trans_params(scid)).stream_pos_32 >= active_connection_id_limit_server_0rtt; # todo generalize\n"
                        },
                        {
                            "line": 1295,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 1296,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                        },
                        {
                            "line": 1297,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 1298,
                            "file": "quic_frame.ivy",
                            "assertion": "require stream_seen(scid,f.id);\n"
                        },
                        {
                            "line": 363,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require scid = the_cid;\n"
                        },
                        {
                            "line": 364,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require 4 <= f.id & f.id <= 16;\n"
                        },
                        {
                            "line": 1705,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 1706,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                        },
                        {
                            "line": 1707,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 1708,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.data.end = 8;\n"
                        },
                        {
                            "line": 1709,
                            "file": "quic_frame.ivy",
                            "assertion": "require path_challenge_pending(scid,f.data);\n"
                        },
                        {
                            "line": 1391,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 1392,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                        },
                        {
                            "line": 1393,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 1789,
                            "file": "quic_frame.ivy",
                            "assertion": "require tls_handshake_finished;\n"
                        },
                        {
                            "line": 1791,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 1792,
                            "file": "quic_frame.ivy",
                            "assertion": "require (e = quic_packet_type.one_rtt) & established_1rtt_keys(scid); # | e = quic_packet_type.zero_rtt  | e = quic_packet_type.zero_rtt & established_0rtt_keys(scid) \n"
                        },
                        {
                            "line": 1793,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 1794,
                            "file": "quic_frame.ivy",
                            "assertion": "require ~conn_closed(scid);  # [8]\n"
                        },
                        {
                            "line": 1795,
                            "file": "quic_frame.ivy",
                            "assertion": "require conn_seen(scid);  # [9]\n"
                        }
                    ]
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 616,
                "action_name": "handle_tls_extensions",
                "implementation": [
                    {
                        "line": 612,
                        "file": "quic_packet.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 613,
                        "file": "quic_packet.ivy",
                        "instruction": "    # We process the extensions in a message in order.\n"
                    },
                    {
                        "line": 614,
                        "file": "quic_packet.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 615,
                        "file": "quic_packet.ivy",
                        "instruction": "    var idx := exts.begin;\n"
                    },
                    {
                        "line": 616,
                        "file": "quic_packet.ivy",
                        "instruction": "    while idx < exts.end {\n"
                    },
                    {
                        "line": 617,
                        "file": "quic_packet.ivy",
                        "instruction": "        var ext := exts.value(idx);\n"
                    },
                    {
                        "line": 618,
                        "file": "quic_packet.ivy",
                        "instruction": "            \n"
                    },
                    {
                        "line": 619,
                        "file": "quic_packet.ivy",
                        "instruction": "        # For every `quic_transport_parameters` extension...\n"
                    },
                    {
                        "line": 620,
                        "file": "quic_packet.ivy",
                        "instruction": "        if some (tps:quic_transport_parameters) ext *> tps {\n"
                    },
                    {
                        "line": 621,
                        "file": "quic_packet.ivy",
                        "instruction": "            call handle_client_transport_parameters(src,dst,scid,tps,is_client_hello);\n"
                    },
                    {
                        "line": 622,
                        "file": "quic_packet.ivy",
                        "instruction": "            trans_params_set(scid) := true;\n"
                    },
                    {
                        "line": 623,
                        "file": "quic_packet.ivy",
                        "instruction": "        };\n"
                    },
                    {
                        "line": 624,
                        "file": "quic_packet.ivy",
                        "instruction": "        idx := idx.next\n"
                    },
                    {
                        "line": 625,
                        "file": "quic_packet.ivy",
                        "instruction": "    };\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "exts",
                        "type": "vector[tls.extension]"
                    },
                    {
                        "name": "is_client_hello",
                        "type": "bool"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "handle_tls_extensions",
                        "component": "quic_packet.ivy"
                    },
                    {
                        "caller_func": "handle_tls_extensions",
                        "component": "quic_packet.ivy"
                    },
                    {
                        "caller_func": "handle_tls_extensions",
                        "component": "quic_packet.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 587,
                "action_name": "handle_tls_handshake",
                "implementation": [
                    {
                        "line": 587,
                        "file": "quic_packet.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 588,
                        "file": "quic_packet.ivy",
                        "instruction": "    if some(ch:tls.client_hello) hs *> ch {\n"
                    },
                    {
                        "line": 589,
                        "file": "quic_packet.ivy",
                        "instruction": "        is_client(scid) := true;\n"
                    },
                    {
                        "line": 590,
                        "file": "quic_packet.ivy",
                        "instruction": "        call handle_tls_extensions(src,dst,scid,ch.extensions,true);\n"
                    },
                    {
                        "line": 591,
                        "file": "quic_packet.ivy",
                        "instruction": "    }\n"
                    },
                    {
                        "line": 592,
                        "file": "quic_packet.ivy",
                        "instruction": "    else if some(sh:tls.server_hello) hs *> sh {\n"
                    },
                    {
                        "line": 593,
                        "file": "quic_packet.ivy",
                        "instruction": "#        call map_cids(src,scid,dcid);    # [1]\n"
                    },
                    {
                        "line": 594,
                        "file": "quic_packet.ivy",
                        "instruction": "#        call map_cids(dst,dcid,scid);\n"
                    },
                    {
                        "line": 595,
                        "file": "quic_packet.ivy",
                        "instruction": "        call handle_tls_extensions(src,dst,scid,sh.extensions,false);\n"
                    },
                    {
                        "line": 596,
                        "file": "quic_packet.ivy",
                        "instruction": "    }\n"
                    },
                    {
                        "line": 597,
                        "file": "quic_packet.ivy",
                        "instruction": "    else if some(ee:tls.encrypted_extensions) hs *> ee {\n"
                    },
                    {
                        "line": 598,
                        "file": "quic_packet.ivy",
                        "instruction": "        call handle_tls_extensions(src,dst,scid,ee.extensions,false);\n"
                    },
                    {
                        "line": 599,
                        "file": "quic_packet.ivy",
                        "instruction": "    }\n"
                    },
                    {
                        "line": 600,
                        "file": "quic_packet.ivy",
                        "instruction": "    if some(fh:tls.finished) hs *> fh {\n"
                    },
                    {
                        "line": 601,
                        "file": "quic_packet.ivy",
                        "instruction": "        tls_handshake_finished := true;\n"
                    },
                    {
                        "line": 602,
                        "file": "quic_packet.ivy",
                        "instruction": "    }\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "dcid",
                        "type": "cid"
                    },
                    {
                        "name": "hs",
                        "type": "tls.handshake"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 87,
                "action_name": "packet_event",
                "implementation": [
                    {
                        "line": 87,
                        "file": "quic_packet.ivy",
                        "instruction": "    \n"
                    }
                ],
                "monitor": {
                    "before": [
                        {
                            "line": 185,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    if _generating {\n"
                        },
                        {
                            "line": 186,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        var tp := trans_params(the_cid);\n"
                        },
                        {
                            "line": 187,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        if version_negociated {\n"
                        },
                        {
                            "line": 188,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "            require src = client_vn;\n"
                        },
                        {
                            "line": 189,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        } else {\n"
                        },
                        {
                            "line": 190,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "            if ~disable_active_migration.is_set(tp) {\n"
                        },
                        {
                            "line": 191,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "                if ~migration_done | allowed_multiple_migration { \n"
                        },
                        {
                            "line": 192,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "                    #only one migration\n"
                        },
                        {
                            "line": 193,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "                    require src = client.ep | src = client_alt;\n"
                        },
                        {
                            "line": 194,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "                } else {\n"
                        },
                        {
                            "line": 195,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "                    require src = client_alt;\n"
                        },
                        {
                            "line": 196,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "                }\n"
                        },
                        {
                            "line": 197,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "            } else {\n"
                        },
                        {
                            "line": 198,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "                require src = client.ep;\n"
                        },
                        {
                            "line": 199,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "            }\n"
                        },
                        {
                            "line": 200,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 201,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        require dst = server.ep;\n"
                        },
                        {
                            "line": 202,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        #require pkt.token.end = 0; \n"
                        },
                        {
                            "line": 203,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        if pkt.ptype = quic_packet_type.initial & retry_recv(pkt.src_cid) & ~zero_length_token {\n"
                        },
                        {
                            "line": 204,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "            require pkt.token = retry_token(pkt.src_cid); # TODO new_token\n"
                        },
                        {
                            "line": 205,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        } else {\n"
                        },
                        {
                            "line": 206,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "            require pkt.token.end = 0; \n"
                        },
                        {
                            "line": 207,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 208,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 209,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    if final_version = 0x00000000 {\n"
                        },
                        {
                            "line": 210,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        #require pkt.long -> pkt.pversion = 0xff00001d  #version 29\n"
                        },
                        {
                            "line": 211,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        #require pkt.long -> pkt.pversion = 0xff000020  #version 32\n"
                        },
                        {
                            "line": 212,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        #require pkt.long -> pkt.pversion = 0xff00001e  #version 30\n"
                        },
                        {
                            "line": 213,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        require pkt.long -> pkt.pversion = initial_version  #version 30\n"
                        },
                        {
                            "line": 214,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    } else {\n"
                        },
                        {
                            "line": 215,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "        require pkt.long -> pkt.pversion = final_version\n"
                        },
                        {
                            "line": 216,
                            "file": "ivy_quic_client_behavior.ivy",
                            "instruction": "    };\n"
                        }
                    ],
                    "after": [
                        {
                            "line": 37,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "    if _generating {  # & ~conn_closed(pkt.the_cid)\n"
                        },
                        {
                            "line": 38,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var spkt := pkt_serdes.to_bytes(pkt);\n"
                        },
                        {
                            "line": 39,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var rnum := reference_pkt_num(spkt,false);\n"
                        },
                        {
                            "line": 40,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var tls_id := src_tls_id(src);\n"
                        },
                        {
                            "line": 41,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var ppkt := prot.encrypt(tls_id,rnum,spkt);\n"
                        },
                        {
                            "line": 42,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var pkts := prot.arr.empty;\n"
                        },
                        {
                            "line": 43,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        pkts := pkts.append(ppkt);\n"
                        },
                        {
                            "line": 44,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        call net.send(endpoint_to_pid(src),endpoint_to_socket(src),dst,pkts);\n"
                        },
                        {
                            "line": 45,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "    }\n"
                        }
                    ],
                    "around": [
                        {
                            "line": 328,
                            "file": "quic_packet.ivy",
                            "instruction": "    #call show_connected(connected(the_cid), connected_to(the_cid));\n"
                        },
                        {
                            "line": 329,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 330,
                            "file": "quic_packet.ivy",
                            "instruction": "    # TEMPORARY: Do not allow zero_rtt packets\n"
                        },
                        {
                            "line": 331,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 332,
                            "file": "quic_packet.ivy",
                            "instruction": "    require pkt.ptype ~= quic_packet_type.zero_rtt & pkt.ptype ~= quic_packet_type.version_negociation & pkt.ptype ~= quic_packet_type.retry;\n"
                        },
                        {
                            "line": 333,
                            "file": "quic_packet.ivy",
                            "instruction": "    \n"
                        },
                        {
                            "line": 334,
                            "file": "quic_packet.ivy",
                            "instruction": "    # Extract the source and destination cid's and packet number from the packet.\n"
                        },
                        {
                            "line": 335,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 336,
                            "file": "quic_packet.ivy",
                            "instruction": "    var dcid := pkt.dst_cid;\n"
                        },
                        {
                            "line": 337,
                            "file": "quic_packet.ivy",
                            "instruction": "    var scid := pkt.src_cid;\n"
                        },
                        {
                            "line": 338,
                            "file": "quic_packet.ivy",
                            "instruction": "    if cid_mapped(dcid) {\n"
                        },
                        {
                            "line": 339,
                            "file": "quic_packet.ivy",
                            "instruction": "\t    dcid := cid_to_aid(dcid);\n"
                        },
                        {
                            "line": 340,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 341,
                            "file": "quic_packet.ivy",
                            "instruction": "    require pkt.token.end ~= 0 -> (retry_sent(client_initial_rcid) | retry_recv(scid) | pkt.token = tls_api.upper.get_old_new_token);\n"
                        },
                        {
                            "line": 342,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 343,
                            "file": "quic_packet.ivy",
                            "instruction": "    if (src = client_alt | dst = client_alt) & nclients = 1 {\n"
                        },
                        {
                            "line": 344,
                            "file": "quic_packet.ivy",
                            "instruction": "\t    migration_done := true;\n"
                        },
                        {
                            "line": 345,
                            "file": "quic_packet.ivy",
                            "instruction": "\t    #call net.close(endpoint_id.client,sock);\t# destroy connection ?\n"
                        },
                        {
                            "line": 346,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 347,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 348,
                            "file": "quic_packet.ivy",
                            "instruction": "    # Similarly, an endpoint MUST NOT reuse a connection ID when sending to\n"
                        },
                        {
                            "line": 349,
                            "file": "quic_packet.ivy",
                            "instruction": "    # more than one destination address.  \n"
                        },
                        {
                            "line": 350,
                            "file": "quic_packet.ivy",
                            "instruction": "    \n"
                        },
                        {
                            "line": 351,
                            "file": "quic_packet.ivy",
                            "instruction": "    #if ~_generating  {\n"
                        },
                        {
                            "line": 352,
                            "file": "quic_packet.ivy",
                            "instruction": "    #    if ~migration_done {\n"
                        },
                        {
                            "line": 353,
                            "file": "quic_packet.ivy",
                            "instruction": "    #        cid_ip_mapped(dst) := pkt.dst_cid;\n"
                        },
                        {
                            "line": 354,
                            "file": "quic_packet.ivy",
                            "instruction": "    #    } else {\n"
                        },
                        {
                            "line": 355,
                            "file": "quic_packet.ivy",
                            "instruction": "    #        cid_ip_mapped(dst) := pkt.dst_cid;\n"
                        },
                        {
                            "line": 356,
                            "file": "quic_packet.ivy",
                            "instruction": "    #    };\n"
                        },
                        {
                            "line": 357,
                            "file": "quic_packet.ivy",
                            "instruction": "    #};\n"
                        },
                        {
                            "line": 358,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 359,
                            "file": "quic_packet.ivy",
                            "instruction": "    # The destination cid must represent an existing connection,\n"
                        },
                        {
                            "line": 360,
                            "file": "quic_packet.ivy",
                            "instruction": "    # except in the case of a client initial packet, when the\n"
                        },
                        {
                            "line": 361,
                            "file": "quic_packet.ivy",
                            "instruction": "    # destination cid may be the nonce cid chosen by the client for\n"
                        },
                        {
                            "line": 362,
                            "file": "quic_packet.ivy",
                            "instruction": "    # the given source cid. TODO: The standard says that on receiving\n"
                        },
                        {
                            "line": 363,
                            "file": "quic_packet.ivy",
                            "instruction": "    # the the server's cid, the clint must switch to it. However, we\n"
                        },
                        {
                            "line": 364,
                            "file": "quic_packet.ivy",
                            "instruction": "    # can't know when that server's cid has actually been received by\n"
                        },
                        {
                            "line": 365,
                            "file": "quic_packet.ivy",
                            "instruction": "    # the client. As an example, after the server sends its first\n"
                        },
                        {
                            "line": 366,
                            "file": "quic_packet.ivy",
                            "instruction": "    # initial packet, the client might still retransmit its initial\n"
                        },
                        {
                            "line": 367,
                            "file": "quic_packet.ivy",
                            "instruction": "    # packet using the nonce cid. In some cases, we can infer that the\n"
                        },
                        {
                            "line": 368,
                            "file": "quic_packet.ivy",
                            "instruction": "    # client has in fact seen the server's cid (for example, if it\n"
                        },
                        {
                            "line": 369,
                            "file": "quic_packet.ivy",
                            "instruction": "    # packet contains an ACK frame, or a CRYPTO frame that is\n"
                        },
                        {
                            "line": 370,
                            "file": "quic_packet.ivy",
                            "instruction": "    # reponsive to a server FRAME. This is trick to check, however,\n"
                        },
                        {
                            "line": 371,
                            "file": "quic_packet.ivy",
                            "instruction": "    # and the actual servers do not seem to check it.\n"
                        },
                        {
                            "line": 372,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 373,
                            "file": "quic_packet.ivy",
                            "instruction": "    require connected(dcid) |\n"
                        },
                        {
                            "line": 374,
                            "file": "quic_packet.ivy",
                            "instruction": "        pkt.ptype = quic_packet_type.initial\n"
                        },
                        {
                            "line": 375,
                            "file": "quic_packet.ivy",
                            "instruction": "        & is_client(scid)\n"
                        },
                        {
                            "line": 376,
                            "file": "quic_packet.ivy",
                            "instruction": "        & dcid = nonce_cid(scid);\n"
                        },
                        {
                            "line": 377,
                            "file": "quic_packet.ivy",
                            "instruction": "    \n"
                        },
                        {
                            "line": 378,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 379,
                            "file": "quic_packet.ivy",
                            "instruction": "    # On long headers, both cids are given. If the destination cid is\n"
                        },
                        {
                            "line": 380,
                            "file": "quic_packet.ivy",
                            "instruction": "    # connected, it must be connected to the source cid (otherwise it\n"
                        },
                        {
                            "line": 381,
                            "file": "quic_packet.ivy",
                            "instruction": "    # must be a nonce generated by a client). \n"
                        },
                        {
                            "line": 382,
                            "file": "quic_packet.ivy",
                            "instruction": "    # On short headers (meaning one_rtt) the scid is not given, so we\n"
                        },
                        {
                            "line": 383,
                            "file": "quic_packet.ivy",
                            "instruction": "    # use the recorded value.\n"
                        },
                        {
                            "line": 384,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 385,
                            "file": "quic_packet.ivy",
                            "instruction": "    if pkt.long {\n"
                        },
                        {
                            "line": 386,
                            "file": "quic_packet.ivy",
                            "instruction": "        require connected(dcid) -> connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 387,
                            "file": "quic_packet.ivy",
                            "instruction": "    } else {\n"
                        },
                        {
                            "line": 388,
                            "file": "quic_packet.ivy",
                            "instruction": "        scid := connected_to(dcid);\n"
                        },
                        {
                            "line": 389,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 390,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 391,
                            "file": "quic_packet.ivy",
                            "instruction": "    if retry_sent(dcid) & ~_generating & ~zero_length_token & pkt.ptype = quic_packet_type.initial {\n"
                        },
                        {
                            "line": 392,
                            "file": "quic_packet.ivy",
                            "instruction": "        require dcid = client_initial_rcid;\n"
                        },
                        {
                            "line": 393,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 394,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 395,
                            "file": "quic_packet.ivy",
                            "instruction": "    # The packet type must match the encryption level of the queued\n"
                        },
                        {
                            "line": 396,
                            "file": "quic_packet.ivy",
                            "instruction": "    # frames at the source. \n"
                        },
                        {
                            "line": 397,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 398,
                            "file": "quic_packet.ivy",
                            "instruction": "    require pkt.ptype = queued_level(scid);\n"
                        },
                        {
                            "line": 399,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 400,
                            "file": "quic_packet.ivy",
                            "instruction": "    # TEMPORARY: prevent big packet number jumps (work around minquic bug)\n"
                        },
                        {
                            "line": 401,
                            "file": "quic_packet.ivy",
                            "instruction": "    # Removed for MVFST that start with big PKT_NUM -> OK now\n"
                        },
                        {
                            "line": 402,
                            "file": "quic_packet.ivy",
                            "instruction": "    if  _generating {\n"
                        },
                        {
                            "line": 403,
                            "file": "quic_packet.ivy",
                            "instruction": "        # if ~is_client(scid) {\n"
                        },
                        {
                            "line": 404,
                            "file": "quic_packet.ivy",
                            "instruction": "        #     #client\n"
                        },
                        {
                            "line": 405,
                            "file": "quic_packet.ivy",
                            "instruction": "        #     require pkt.seq_num > last_pkt_num(scid,pkt.ptype);\n"
                        },
                        {
                            "line": 406,
                            "file": "quic_packet.ivy",
                            "instruction": "        #     require pkt.seq_num <= last_pkt_num(scid,pkt.ptype) + 0x15;\n"
                        },
                        {
                            "line": 407,
                            "file": "quic_packet.ivy",
                            "instruction": "        # } else {\n"
                        },
                        {
                            "line": 408,
                            "file": "quic_packet.ivy",
                            "instruction": "        #server\n"
                        },
                        {
                            "line": 409,
                            "file": "quic_packet.ivy",
                            "instruction": "        require pkt.seq_num = last_pkt_num(scid,pkt.ptype) + 0x1; # OK\n"
                        },
                        {
                            "line": 410,
                            "file": "quic_packet.ivy",
                            "instruction": "        # };\n"
                        },
                        {
                            "line": 411,
                            "file": "quic_packet.ivy",
                            "instruction": "        #require pkt.seq_num < last_pkt_num(scid,pkt.ptype) + 0x1 & pkt.seq_num > last_pkt_num(scid,pkt.ptype);\n"
                        },
                        {
                            "line": 412,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 413,
                            "file": "quic_packet.ivy",
                            "instruction": "    last_pkt_num(scid,pkt.ptype) := pkt.seq_num;\n"
                        },
                        {
                            "line": 414,
                            "file": "quic_packet.ivy",
                            "instruction": "    require ~sent_pkt(scid,pkt.ptype,pkt.seq_num);  # [4]\n"
                        },
                        {
                            "line": 415,
                            "file": "quic_packet.ivy",
                            "instruction": "    sent_pkt(scid,pkt.ptype,pkt.seq_num) := true;  # [1]\n"
                        },
                        {
                            "line": 416,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 417,
                            "file": "quic_packet.ivy",
                            "instruction": "    # The payload may not be empty\n"
                        },
                        {
                            "line": 418,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 419,
                            "file": "quic_packet.ivy",
                            "instruction": "    require num_queued_frames(scid) > 0;  # [7]\n"
                        },
                        {
                            "line": 420,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 421,
                            "file": "quic_packet.ivy",
                            "instruction": "    # The payload must exactly match the queued frames.\n"
                        },
                        {
                            "line": 422,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 423,
                            "file": "quic_packet.ivy",
                            "instruction": "    require pkt.payload = queued_frames(scid);\n"
                        },
                        {
                            "line": 424,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 425,
                            "file": "quic_packet.ivy",
                            "instruction": "    # TEMPORARY: don't allow client migration during handshake\n"
                        },
                        {
                            "line": 426,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 427,
                            "file": "quic_packet.ivy",
                            "instruction": "    require conn_seen(scid) & pkt.long & is_client(scid) -> conn_requested(src,dst,scid);\n"
                        },
                        {
                            "line": 428,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 429,
                            "file": "quic_packet.ivy",
                            "instruction": "    # Packet must be sent to the endpoint from which the highest numbered\n"
                        },
                        {
                            "line": 430,
                            "file": "quic_packet.ivy",
                            "instruction": "    # packet has been received. ~queued_challenge(dcid) & \n"
                        },
                        {
                            "line": 431,
                            "file": "quic_packet.ivy",
                            "instruction": "    #call show_probing(dcid ,hi_non_probing(dcid));\n"
                        },
                        {
                            "line": 432,
                            "file": "quic_packet.ivy",
                            "instruction": "    require  conn_seen(dcid) -> hi_non_probing_endpoint(dcid,dst);  # [10]\n"
                        },
                        {
                            "line": 433,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 434,
                            "file": "quic_packet.ivy",
                            "instruction": "    # TEMPORARY: do not apply ack-only rule to generated packets\n"
                        },
                        {
                            "line": 435,
                            "file": "quic_packet.ivy",
                            "instruction": "    # This can be removed when we have a frame queue per encryption level\n"
                        },
                        {
                            "line": 436,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 437,
                            "file": "quic_packet.ivy",
                            "instruction": "    #call show_ack_credit(scid, ack_credit(scid), queued_ack_eliciting(scid), queued_non_ack(scid), pkt.seq_num);\n"
                        },
                        {
                            "line": 438,
                            "file": "quic_packet.ivy",
                            "instruction": "    require ~_generating & ~queued_non_ack(scid) -> ack_credit(scid) > 0;  # [5]\n"
                        },
                        {
                            "line": 439,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 440,
                            "file": "quic_packet.ivy",
                            "instruction": "    #Hamid - This is wrong, because if there is no ack credits, it prevents from sending a packet \n"
                        },
                        {
                            "line": 441,
                            "file": "quic_packet.ivy",
                            "instruction": "    #        containing only a CONNECTION_CLOSE frame but we want to stop packets that contain only ACKs \n"
                        },
                        {
                            "line": 442,
                            "file": "quic_packet.ivy",
                            "instruction": "    #    require ~_generating & ~queued_ack_eliciting(scid) -> ack_credit(scid) > 0;\n"
                        },
                        {
                            "line": 443,
                            "file": "quic_packet.ivy",
                            "instruction": "    #Hamid\n"
                        },
                        {
                            "line": 444,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 445,
                            "file": "quic_packet.ivy",
                            "instruction": "    # QUESTION: THis sentence is from draft-18 section 13.1: \"An\n"
                        },
                        {
                            "line": 446,
                            "file": "quic_packet.ivy",
                            "instruction": "    #   endpoint MUST NOT send a packet containing only an ACK frame\n"
                        },
                        {
                            "line": 447,
                            "file": "quic_packet.ivy",
                            "instruction": "    #   in response to a packet containing only ACK or PADDING frames,\n"
                        },
                        {
                            "line": 448,
                            "file": "quic_packet.ivy",
                            "instruction": "    #   even if there are packet gaps which precede the received\n"
                        },
                        {
                            "line": 449,
                            "file": "quic_packet.ivy",
                            "instruction": "    #   packet.\" Do we interpret this to mean that an ack-only packet\n"
                        },
                        {
                            "line": 450,
                            "file": "quic_packet.ivy",
                            "instruction": "    #   cannot ack *only* ack-only packets?  Or that an ack-only\n"
                        },
                        {
                            "line": 451,
                            "file": "quic_packet.ivy",
                            "instruction": "    #   packet cannot ack *any* ack-only packets?\n"
                        },
                        {
                            "line": 452,
                            "file": "quic_packet.ivy",
                            "instruction": "    \n"
                        },
                        {
                            "line": 453,
                            "file": "quic_packet.ivy",
                            "instruction": "    # If the sender is in the draining state, this is the draining packet.\n"
                        },
                        {
                            "line": 454,
                            "file": "quic_packet.ivy",
                            "instruction": "    # Make sure that a draining packet has not previously been sent and\n"
                        },
                        {
                            "line": 455,
                            "file": "quic_packet.ivy",
                            "instruction": "    # that the packet contains a connection_close frame;\n"
                        },
                        {
                            "line": 456,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 457,
                            "file": "quic_packet.ivy",
                            "instruction": "    if conn_draining(scid) {\n"
                        },
                        {
                            "line": 458,
                            "file": "quic_packet.ivy",
                            "instruction": "        require ~draining_pkt_sent(scid) & queued_close(scid);\n"
                        },
                        {
                            "line": 459,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 460,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 461,
                            "file": "quic_packet.ivy",
                            "instruction": "    ...\n"
                        },
                        {
                            "line": 462,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 463,
                            "file": "quic_packet.ivy",
                            "instruction": "    # Here, we have the updates to the packet protocol state.\n"
                        },
                        {
                            "line": 464,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 465,
                            "file": "quic_packet.ivy",
                            "instruction": "    # TEMPORARY: The following are repeated because currently locals defined in\n"
                        },
                        {
                            "line": 466,
                            "file": "quic_packet.ivy",
                            "instruction": "    # the \"before\" section cannot be accessed in the \"after\" section.\n"
                        },
                        {
                            "line": 467,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 468,
                            "file": "quic_packet.ivy",
                            "instruction": "    var dcid := pkt.dst_cid;\n"
                        },
                        {
                            "line": 469,
                            "file": "quic_packet.ivy",
                            "instruction": "    var scid := pkt.src_cid if pkt.long else connected_to(dcid);\n"
                        },
                        {
                            "line": 470,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 471,
                            "file": "quic_packet.ivy",
                            "instruction": "    if cid_mapped(dcid) {\n"
                        },
                        {
                            "line": 472,
                            "file": "quic_packet.ivy",
                            "instruction": "\t    dcid := cid_to_aid(dcid);\n"
                        },
                        {
                            "line": 473,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 474,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 475,
                            "file": "quic_packet.ivy",
                            "instruction": "    # TODO: the following should not be here\n"
                        },
                        {
                            "line": 476,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 477,
                            "file": "quic_packet.ivy",
                            "instruction": "    if pkt.ptype = quic_packet_type.initial {\n"
                        },
                        {
                            "line": 478,
                            "file": "quic_packet.ivy",
                            "instruction": "        initial_token := pkt.token;\n"
                        },
                        {
                            "line": 479,
                            "file": "quic_packet.ivy",
                            "instruction": "        # An initial packet with an unseen destination cid is a connection request.\n"
                        },
                        {
                            "line": 480,
                            "file": "quic_packet.ivy",
                            "instruction": "        if ~conn_seen(dcid)  {\n"
                        },
                        {
                            "line": 481,
                            "file": "quic_packet.ivy",
                            "instruction": "            if ~zero_rtt_sent {\n"
                        },
                        {
                            "line": 482,
                            "file": "quic_packet.ivy",
                            "instruction": "                call show_initial_request_initial;\n"
                        },
                        {
                            "line": 483,
                            "file": "quic_packet.ivy",
                            "instruction": "                call tls_client_initial_request(src,dst,dcid,pkt.pversion,src_tls_id(src));\n"
                        },
                        {
                            "line": 484,
                            "file": "quic_packet.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 485,
                            "file": "quic_packet.ivy",
                            "instruction": "            conn_requested(src,dst,scid) := true;\n"
                        },
                        {
                            "line": 486,
                            "file": "quic_packet.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 487,
                            "file": "quic_packet.ivy",
                            "instruction": "        cid_to_token(dcid) := pkt.token;\n"
                        },
                        {
                            "line": 488,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 489,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 490,
                            "file": "quic_packet.ivy",
                            "instruction": "    conn_seen(scid) := true;  # [1]\n"
                        },
                        {
                            "line": 491,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 492,
                            "file": "quic_packet.ivy",
                            "instruction": "    # Update the ack credits. A non-ack packet sent to a destination\n"
                        },
                        {
                            "line": 493,
                            "file": "quic_packet.ivy",
                            "instruction": "    # increases the destination's ack credit. An ack packet decreases\n"
                        },
                        {
                            "line": 494,
                            "file": "quic_packet.ivy",
                            "instruction": "    # the sender's ack credit.\n"
                        },
                        {
                            "line": 495,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 496,
                            "file": "quic_packet.ivy",
                            "instruction": "#Hamid\n"
                        },
                        {
                            "line": 497,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 498,
                            "file": "quic_packet.ivy",
                            "instruction": "#    if queued_non_ack(scid) {\n"
                        },
                        {
                            "line": 499,
                            "file": "quic_packet.ivy",
                            "instruction": "#\tack_credit(dcid) := ack_credit(dcid) + 1;\n"
                        },
                        {
                            "line": 500,
                            "file": "quic_packet.ivy",
                            "instruction": "#    } else {\n"
                        },
                        {
                            "line": 501,
                            "file": "quic_packet.ivy",
                            "instruction": "#\tack_credit(scid) := ack_credit(scid) - 1;\n"
                        },
                        {
                            "line": 502,
                            "file": "quic_packet.ivy",
                            "instruction": "#    };\n"
                        },
                        {
                            "line": 503,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 504,
                            "file": "quic_packet.ivy",
                            "instruction": "    if queued_ack_eliciting(scid) {\n"
                        },
                        {
                            "line": 505,
                            "file": "quic_packet.ivy",
                            "instruction": "       ack_credit(dcid) := ack_credit(dcid) + 1;\n"
                        },
                        {
                            "line": 506,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 507,
                            "file": "quic_packet.ivy",
                            "instruction": "    if ~queued_non_ack(scid) {\n"
                        },
                        {
                            "line": 508,
                            "file": "quic_packet.ivy",
                            "instruction": "       ack_credit(scid) := ack_credit(scid) - 1;\n"
                        },
                        {
                            "line": 509,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 510,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 511,
                            "file": "quic_packet.ivy",
                            "instruction": "#Hamid\n"
                        },
                        {
                            "line": 512,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 513,
                            "file": "quic_packet.ivy",
                            "instruction": "    # If this is a non-probing packet, update the highest non-probing\n"
                        },
                        {
                            "line": 514,
                            "file": "quic_packet.ivy",
                            "instruction": "    # packet number seen on from this aid.\n"
                        },
                        {
                            "line": 515,
                            "file": "quic_packet.ivy",
                            "instruction": "    # QUESTION: what if two different paths send the same packet number?\n"
                        },
                        {
                            "line": 516,
                            "file": "quic_packet.ivy",
                            "instruction": "    # QUESTION: how do you compare packet numbers with different encryption levels?\n"
                        },
                        {
                            "line": 517,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 518,
                            "file": "quic_packet.ivy",
                            "instruction": "    if queued_non_probing(scid) {\n"
                        },
                        {
                            "line": 519,
                            "file": "quic_packet.ivy",
                            "instruction": "        if pkt.ptype = quic_packet_type.one_rtt {\n"
                        },
                        {
                            "line": 520,
                            "file": "quic_packet.ivy",
                            "instruction": "            if pkt.seq_num >= hi_non_probing(scid) {\n"
                        },
                        {
                            "line": 521,
                            "file": "quic_packet.ivy",
                            "instruction": "                hi_non_probing(scid) := pkt.seq_num;\n"
                        },
                        {
                            "line": 522,
                            "file": "quic_packet.ivy",
                            "instruction": "                hi_non_probing_endpoint(scid,src) := true;\n"
                        },
                        {
                            "line": 523,
                            "file": "quic_packet.ivy",
                            "instruction": "            }\n"
                        },
                        {
                            "line": 524,
                            "file": "quic_packet.ivy",
                            "instruction": "        } else {\n"
                        },
                        {
                            "line": 525,
                            "file": "quic_packet.ivy",
                            "instruction": "            hi_non_probing_endpoint(scid,src) := true;\n"
                        },
                        {
                            "line": 526,
                            "file": "quic_packet.ivy",
                            "instruction": "        }\n"
                        },
                        {
                            "line": 527,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 528,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 529,
                            "file": "quic_packet.ivy",
                            "instruction": "    # If the packet contains a close frame, then set `pkt_has_close`\n"
                        },
                        {
                            "line": 530,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 531,
                            "file": "quic_packet.ivy",
                            "instruction": "    if queued_close(scid) {\n"
                        },
                        {
                            "line": 532,
                            "file": "quic_packet.ivy",
                            "instruction": "        pkt_has_close(scid,pkt.ptype,pkt.seq_num) := true;\n"
                        },
                        {
                            "line": 533,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 534,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 535,
                            "file": "quic_packet.ivy",
                            "instruction": "    # If the sender is in the draining state, this is the draining packet.\n"
                        },
                        {
                            "line": 536,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 537,
                            "file": "quic_packet.ivy",
                            "instruction": "    if conn_draining(scid) {\n"
                        },
                        {
                            "line": 538,
                            "file": "quic_packet.ivy",
                            "instruction": "        draining_pkt_sent(scid) := true\n"
                        },
                        {
                            "line": 539,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 540,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 541,
                            "file": "quic_packet.ivy",
                            "instruction": "    if pkt.ptype = quic_packet_type.initial & ~first_initial_send & zero_rtt_allowed {\n"
                        },
                        {
                            "line": 542,
                            "file": "quic_packet.ivy",
                            "instruction": "        first_initial_send := true;\n"
                        },
                        {
                            "line": 543,
                            "file": "quic_packet.ivy",
                            "instruction": "        initial_scid := scid;\n"
                        },
                        {
                            "line": 544,
                            "file": "quic_packet.ivy",
                            "instruction": "        initial_dcid := dcid;\n"
                        },
                        {
                            "line": 545,
                            "file": "quic_packet.ivy",
                            "instruction": "        queued_level(the_cid) := quic_packet_type.zero_rtt; # todo multiple client\n"
                        },
                        {
                            "line": 546,
                            "file": "quic_packet.ivy",
                            "instruction": "    } else {\n"
                        },
                        {
                            "line": 547,
                            "file": "quic_packet.ivy",
                            "instruction": "        first_initial_send := false;\n"
                        },
                        {
                            "line": 548,
                            "file": "quic_packet.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 549,
                            "file": "quic_packet.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 550,
                            "file": "quic_packet.ivy",
                            "instruction": "    # The queued frames are deleted\n"
                        },
                        {
                            "line": 551,
                            "file": "quic_packet.ivy",
                            "instruction": "    \n"
                        },
                        {
                            "line": 552,
                            "file": "quic_packet.ivy",
                            "instruction": "    queued_frames(scid) := frame.arr.empty;\n"
                        },
                        {
                            "line": 553,
                            "file": "quic_packet.ivy",
                            "instruction": "    queued_non_probing(scid) := false;\n"
                        },
                        {
                            "line": 554,
                            "file": "quic_packet.ivy",
                            "instruction": "    queued_non_ack(scid) := false;\n"
                        },
                        {
                            "line": 555,
                            "file": "quic_packet.ivy",
                            "instruction": "    queued_close(scid) := false;\n"
                        },
                        {
                            "line": 556,
                            "file": "quic_packet.ivy",
                            "instruction": "    num_queued_frames(scid) := 0;\n"
                        },
                        {
                            "line": 557,
                            "file": "quic_packet.ivy",
                            "instruction": "#Hamid\n"
                        },
                        {
                            "line": 558,
                            "file": "quic_packet.ivy",
                            "instruction": "    queued_ack_eliciting(scid) := false;\n"
                        },
                        {
                            "line": 559,
                            "file": "quic_packet.ivy",
                            "instruction": "#Hamid\n"
                        }
                    ]
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "pkt",
                        "type": "quic_packet"
                    }
                ],
                "exported": true,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "packet_event",
                        "component": "quic_endpoint.ivy"
                    },
                    {
                        "caller_func": "net.send",
                        "component": "ivy_quic_shim_client.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [
                        {
                            "caller_func": "Environment",
                            "component": "Environment"
                        }
                    ],
                    "assertions": [
                        {
                            "line": 333,
                            "file": "quic_packet.ivy",
                            "assertion": "require pkt.ptype ~= quic_packet_type.zero_rtt & pkt.ptype ~= quic_packet_type.version_negociation & pkt.ptype ~= quic_packet_type.retry;\n"
                        },
                        {
                            "line": 342,
                            "file": "quic_packet.ivy",
                            "assertion": "require pkt.token.end ~= 0 -> (retry_sent(client_initial_rcid) | retry_recv(scid) | pkt.token = tls_api.upper.get_old_new_token);\n"
                        },
                        {
                            "line": 374,
                            "file": "quic_packet.ivy",
                            "assertion": "require connected(dcid) |\n"
                        },
                        {
                            "line": 387,
                            "file": "quic_packet.ivy",
                            "assertion": "require connected(dcid) -> connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 393,
                            "file": "quic_packet.ivy",
                            "assertion": "require dcid = client_initial_rcid;\n"
                        },
                        {
                            "line": 399,
                            "file": "quic_packet.ivy",
                            "assertion": "require pkt.ptype = queued_level(scid);\n"
                        },
                        {
                            "line": 410,
                            "file": "quic_packet.ivy",
                            "assertion": "require pkt.seq_num = last_pkt_num(scid,pkt.ptype) + 0x1; # OK\n"
                        },
                        {
                            "line": 415,
                            "file": "quic_packet.ivy",
                            "assertion": "require ~sent_pkt(scid,pkt.ptype,pkt.seq_num);  # [4]\n"
                        },
                        {
                            "line": 420,
                            "file": "quic_packet.ivy",
                            "assertion": "require num_queued_frames(scid) > 0;  # [7]\n"
                        },
                        {
                            "line": 424,
                            "file": "quic_packet.ivy",
                            "assertion": "require pkt.payload = queued_frames(scid);\n"
                        },
                        {
                            "line": 428,
                            "file": "quic_packet.ivy",
                            "assertion": "require conn_seen(scid) & pkt.long & is_client(scid) -> conn_requested(src,dst,scid);\n"
                        },
                        {
                            "line": 433,
                            "file": "quic_packet.ivy",
                            "assertion": "require  conn_seen(dcid) -> hi_non_probing_endpoint(dcid,dst);  # [10]\n"
                        },
                        {
                            "line": 439,
                            "file": "quic_packet.ivy",
                            "assertion": "require ~_generating & ~queued_non_ack(scid) -> ack_credit(scid) > 0;  # [5]\n"
                        },
                        {
                            "line": 459,
                            "file": "quic_packet.ivy",
                            "assertion": "require ~draining_pkt_sent(scid) & queued_close(scid);\n"
                        },
                        {
                            "line": 189,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require src = client_vn;\n"
                        },
                        {
                            "line": 194,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require src = client.ep | src = client_alt;\n"
                        },
                        {
                            "line": 196,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require src = client_alt;\n"
                        },
                        {
                            "line": 199,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require src = client.ep;\n"
                        },
                        {
                            "line": 202,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require dst = server.ep;\n"
                        },
                        {
                            "line": 205,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require pkt.token = retry_token(pkt.src_cid); # TODO new_token\n"
                        },
                        {
                            "line": 207,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require pkt.token.end = 0; \n"
                        },
                        {
                            "line": 214,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require pkt.long -> pkt.pversion = initial_version  #version 30\n"
                        },
                        {
                            "line": 216,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require pkt.long -> pkt.pversion = final_version\n"
                        },
                        {
                            "line": 1202,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 1203,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.one_rtt -> established_1rtt_keys(scid);\n"
                        },
                        {
                            "line": 1204,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.handshake -> established_handshake_keys(scid);\n"
                        },
                        {
                            "line": 1205,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 1206,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(scid) & connected_to(scid) = dcid;\n"
                        },
                        {
                            "line": 1207,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.reason_phrase_length = f.reason_phrase.end;\n"
                        },
                        {
                            "line": 1209,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.one_rtt;\n"
                        },
                        {
                            "line": 1210,
                            "file": "quic_frame.ivy",
                            "assertion": "require ~conn_closed(scid);\n"
                        },
                        {
                            "line": 338,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require conn_total_data(the_cid) > 30; # tricks\n"
                        },
                        {
                            "line": 339,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require scid = the_cid;\n"
                        },
                        {
                            "line": 340,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require f.err_code = 0;\n"
                        },
                        {
                            "line": 342,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require is_no_error;\n"
                        }
                    ]
                }
            }
        },
        {
            "quic_packet_name": "quic_packet",
            "quic_packet_object": [
                {
                    "name": "ptype",
                    "type": "quic_packet_type,"
                },
                {
                    "name": "pversion",
                    "type": "version,"
                },
                {
                    "name": "dst_cid",
                    "type": "cid,"
                },
                {
                    "name": "src_cid",
                    "type": "cid,"
                },
                {
                    "name": "token",
                    "type": "stream_data,"
                },
                {
                    "name": "seq_num",
                    "type": "pkt_num,"
                },
                {
                    "name": "payload",
                    "type": "frame.arr"
                }
            ],
            "quic_packet_module": null,
            "actions": [
                {
                    "line": 66,
                    "action_name": "quic_packet.long",
                    "implementation": [
                        {
                            "line": 65,
                            "file": "quic_packet.ivy",
                            "instruction": "        res := pkt.ptype ~= quic_packet_type.one_rtt;\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "res",
                        "type": "bool"
                    },
                    "action_parameters": [
                        {
                            "name": "pkt",
                            "type": "this"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "quic_packet.long",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "actions": {
                "line": 564,
                "action_name": "show_initial_request_initial",
                "action_return": null,
                "exported": false,
                "action_parameters": null,
                "called_from": [],
                "events": true
            }
        },
        {
            "functions": [
                {
                    "name": "last_pkt_num(C:cid,L:quic_packet_type) : pkt_num\n",
                    "comment": "",
                    "line": 178,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "max_acked(C:cid,L:quic_packet_type) : pkt_num\n",
                    "comment": "",
                    "line": 181,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "ack_credit(C:cid) : pkt_num\n",
                    "comment": "",
                    "line": 182,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "trans_params(C:cid) : trans_params_struct\n",
                    "comment": "",
                    "line": 184,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "cid_to_aid(C:cid) : cid \n",
                    "comment": "",
                    "line": 186,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "cid_to_token(C:cid) : stream_data \n",
                    "comment": "",
                    "line": 190,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "initial_token : stream_data \n",
                    "comment": "",
                    "line": 191,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "seqnum_to_cid (D : cid,S : cid_seq) : cid\n",
                    "comment": "",
                    "line": 195,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "max_seq_num(C:cid) : cid_seq\n",
                    "comment": "",
                    "line": 197,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "connected_to(C:cid) : cid\n",
                    "comment": "",
                    "line": 199,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "nonce_cid(C:cid) : cid\n",
                    "comment": "",
                    "line": 200,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "hi_non_probing(C:cid) : pkt_num\n",
                    "comment": "",
                    "line": 204,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "num_conn(C:cid) : stream_pos\n",
                    "comment": "",
                    "line": 209,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "initial_scid : cid \n",
                    "comment": "",
                    "line": 214,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "initial_dcid : cid \n",
                    "comment": "",
                    "line": 215,
                    "file": "quic_packet.ivy"
                }
            ],
            "relations": [
                {
                    "name": "conn_seen(C:cid)\n",
                    "comment": "",
                    "line": 174,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "conn_closed(C:cid)\n",
                    "comment": "",
                    "line": 175,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "conn_draining(C:cid)\n",
                    "comment": "",
                    "line": 176,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "draining_pkt_sent(C:cid)\n",
                    "comment": "",
                    "line": 177,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "sent_pkt(C:cid,L:quic_packet_type,N:pkt_num)\n",
                    "comment": "",
                    "line": 179,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "acked_pkt(C:cid,L:quic_packet_type,N:pkt_num)\n",
                    "comment": "",
                    "line": 180,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "trans_params_set(C:cid)\n",
                    "comment": "",
                    "line": 183,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "connected(C:cid)\n",
                    "comment": "",
                    "line": 185,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "cid_mapped(C:cid)\n",
                    "comment": "",
                    "line": 187,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "cid_mapped_token(C:cid)\n",
                    "comment": "",
                    "line": 192,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "is_client(C:cid)\n",
                    "comment": "",
                    "line": 201,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "conn_requested(S:ip.endpoint,D:ip.endpoint,C:cid)\n",
                    "comment": "",
                    "line": 202,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "issued_zero_length_cid ",
                    "comment": "(S:ip.endpoint,D:ip.endpoint) TODO pass that to handle function of frames",
                    "line": 203,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "hi_non_probing_endpoint(C:cid,E:ip.endpoint)\n",
                    "comment": "",
                    "line": 205,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "pkt_has_close(C:cid,L:quic_packet_type,N:pkt_num)\n",
                    "comment": "",
                    "line": 206,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "tls_handshake_finished\n",
                    "comment": "",
                    "line": 210,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "migration_done\n",
                    "comment": "",
                    "line": 211,
                    "file": "quic_packet.ivy"
                },
                {
                    "name": "first_initial_send\n",
                    "comment": "",
                    "line": 213,
                    "file": "quic_packet.ivy"
                }
            ]
        }
    ],
    "quic_transport_error_code.ivy": [
        {
            "actions": {
                "line": 87,
                "action_name": "handle_transport_error",
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "ec",
                        "type": "error_code"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "handle_transport_error",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "handle_transport_error",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "handle_transport_error",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "handle_transport_error",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "handle_transport_error",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "handle_transport_error",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "handle_transport_error",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "handle_transport_error",
                        "component": "quic_frame.ivy"
                    },
                    {
                        "caller_func": "enqueue_frame",
                        "component": "quic_frame.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "functions": [],
            "relations": [
                {
                    "name": "is_no_error  \n",
                    "comment": "",
                    "line": 7,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_internal_error \n",
                    "comment": "",
                    "line": 10,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_server_busy \n",
                    "comment": "",
                    "line": 13,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_flow_control_error\n",
                    "comment": "",
                    "line": 16,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_stream_limit_error \n",
                    "comment": "",
                    "line": 19,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_stream_state_error \n",
                    "comment": "",
                    "line": 22,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_final_size_error  \n",
                    "comment": "",
                    "line": 25,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_frame_encoding_error \n",
                    "comment": "",
                    "line": 28,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_transport_parameter_error \n",
                    "comment": "",
                    "line": 31,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_connection_id_limit_error  \n",
                    "comment": "",
                    "line": 34,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_protocol_violation  \n",
                    "comment": "",
                    "line": 37,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_invalid_token \n",
                    "comment": "",
                    "line": 40,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_application_error \n",
                    "comment": "",
                    "line": 43,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_crypto_buffer_exceeded \n",
                    "comment": "",
                    "line": 46,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_key_update_error \n",
                    "comment": "",
                    "line": 49,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_aead_limit_reached\n",
                    "comment": "",
                    "line": 52,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_no_viable_path\n",
                    "comment": "",
                    "line": 55,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_crypto_error  \n",
                    "comment": "",
                    "line": 58,
                    "file": "quic_transport_error_code.ivy"
                },
                {
                    "name": "is_version_negociation_error\n",
                    "comment": "",
                    "line": 61,
                    "file": "quic_transport_error_code.ivy"
                }
            ]
        }
    ],
    "quic_packet_vn.ivy": [
        {
            "actions": {
                "line": 181,
                "action_name": "inc_cid",
                "implementation": [
                    {
                        "line": 180,
                        "file": "quic_packet_vn.ivy",
                        "instruction": "    <<<\n"
                    },
                    {
                        "line": 181,
                        "file": "quic_packet_vn.ivy",
                        "instruction": "    res.val = c.val + inc;\n"
                    },
                    {
                        "line": 182,
                        "file": "quic_packet_vn.ivy",
                        "instruction": "    >>>\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "res",
                    "type": "cid"
                },
                "action_parameters": [
                    {
                        "name": "c",
                        "type": "cid"
                    },
                    {
                        "name": "inc",
                        "type": "stream_pos"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 82,
                "action_name": "packet_event_vn",
                "implementation": [
                    {
                        "line": 82,
                        "file": "quic_packet_vn.ivy",
                        "instruction": "    \n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [
                        {
                            "line": 49,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "    if _generating {  # & ~conn_closed(pkt.the_cid)\n"
                        },
                        {
                            "line": 50,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var spkt := pkt_serdes_vn.to_bytes(pkt);\n"
                        },
                        {
                            "line": 51,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        # var rnum := reference_pkt_num(spkt,false);\n"
                        },
                        {
                            "line": 52,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        # var tls_id := dst_tls_id(dst);\n"
                        },
                        {
                            "line": 53,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        # var ppkt := prot.encrypt(tls_id,rnum,spkt); # no encryption ?\n"
                        },
                        {
                            "line": 54,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var pkts := prot.arr.empty;\n"
                        },
                        {
                            "line": 55,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        pkts := pkts.append(spkt);\n"
                        },
                        {
                            "line": 56,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        call net.send(endpoint_to_pid(src),endpoint_to_socket(src),dst,pkts);\n"
                        },
                        {
                            "line": 57,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "    }\n"
                        }
                    ],
                    "around": [
                        {
                            "line": 126,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        # Extract the source and destination cid's and packet number from the packet.\n"
                        },
                        {
                            "line": 127,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 128,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    var dcid := pkt.dst_cid;\n"
                        },
                        {
                            "line": 129,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    var scid := pkt.src_cid;\n"
                        },
                        {
                            "line": 130,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    if cid_mapped(dcid) {\n"
                        },
                        {
                            "line": 131,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\t    dcid := cid_to_aid(dcid);\n"
                        },
                        {
                            "line": 132,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 133,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 134,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    if src = client_alt | dst = client_alt {\n"
                        },
                        {
                            "line": 135,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\t    migration_done := true;\n"
                        },
                        {
                            "line": 136,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\t    #call net.close(endpoint_id.client,sock);\t# destroy connection ?\n"
                        },
                        {
                            "line": 137,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 138,
                            "file": "quic_packet_vn.ivy",
                            "instruction": " \n"
                        },
                        {
                            "line": 139,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 140,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    require pkt.ptype = quic_packet_type.version_negociation;\n"
                        },
                        {
                            "line": 141,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 142,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    require ~negocation_of_version_initiated(src);  #[1c]\n"
                        },
                        {
                            "line": 143,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 144,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    ...\n"
                        },
                        {
                            "line": 145,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 146,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    var dcid := pkt.dst_cid;\n"
                        },
                        {
                            "line": 147,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    var scid := pkt.src_cid;\n"
                        },
                        {
                            "line": 148,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 149,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    if cid_mapped(dcid) {\n"
                        },
                        {
                            "line": 150,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\t    dcid := cid_to_aid(dcid);\n"
                        },
                        {
                            "line": 151,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 152,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 153,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    if  ~_generating  {\n"
                        },
                        {
                            "line": 154,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        conn_requested(src,dst,scid) := false;\n"
                        },
                        {
                            "line": 155,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        conn_requested(src,dst,dcid) := false;\n"
                        },
                        {
                            "line": 156,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        connected(dcid) :=  false;\n"
                        },
                        {
                            "line": 157,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        connected(scid) :=  false;\n"
                        },
                        {
                            "line": 158,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        conn_seen(dcid) := false;\n"
                        },
                        {
                            "line": 159,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        conn_seen(scid) := false;\n"
                        },
                        {
                            "line": 160,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 161,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        var old_cid := the_cid;\n"
                        },
                        {
                            "line": 162,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        the_cid := inc_cid(old_cid,2); # 0x0;\n"
                        },
                        {
                            "line": 163,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        server_cid := 0x0;\n"
                        },
                        {
                            "line": 164,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        connected(the_cid)    := false;\n"
                        },
                        {
                            "line": 165,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        connected(server_cid) := false;\n"
                        },
                        {
                            "line": 166,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        conn_seen(the_cid)    := false;\n"
                        },
                        {
                            "line": 167,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        conn_seen(server_cid) := false;\n"
                        },
                        {
                            "line": 168,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 169,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        var extns := tls_extensions.empty;\n"
                        },
                        {
                            "line": 170,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        extns := extns.append(make_transport_parameters);\n"
                        },
                        {
                            "line": 171,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        call tls_api.upper.create(0,false,extns);  # false means this instance of tls is not a server put that in shim\n"
                        },
                        {
                            "line": 172,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "        conn_requested(dst,src,the_cid) := true;\n"
                        },
                        {
                            "line": 173,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 174,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 175,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    # Record the packet number as latest see\n"
                        },
                        {
                            "line": 176,
                            "file": "quic_packet_vn.ivy",
                            "instruction": "    negocation_of_version_initiated(src) := true;\n"
                        }
                    ]
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "pkt",
                        "type": "quic_packet_vn"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "net.send",
                        "component": "ivy_quic_shim_client.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [
                        {
                            "caller_func": "tls_client_version_response",
                            "component": "quic_security.ivy"
                        }
                    ],
                    "assertions": [
                        {
                            "line": 141,
                            "file": "quic_packet_vn.ivy",
                            "assertion": "require pkt.ptype = quic_packet_type.version_negociation;\n"
                        },
                        {
                            "line": 143,
                            "file": "quic_packet_vn.ivy",
                            "assertion": "require ~negocation_of_version_initiated(src);  #[1c]\n"
                        },
                        {
                            "line": 1728,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 1729,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                        },
                        {
                            "line": 1730,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 1732,
                            "file": "quic_frame.ivy",
                            "assertion": "require ~is_client(scid);\n"
                        },
                        {
                            "line": 292,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require scid = the_cid;\n"
                        }
                    ]
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "functions": [],
            "relations": []
        }
    ],
    "forged_quic_packet.ivy": [
        {
            "actions": {
                "action_name": "init",
                "action_return": null,
                "implementation": [
                    {
                        "line": 160,
                        "file": "forged_quic_packet.ivy",
                        "instruction": "    packed_forwarded(P) := false;\n"
                    },
                    {
                        "line": 161,
                        "file": "forged_quic_packet.ivy",
                        "instruction": "    packed_forwarded_arr(P) := false;\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "exported": false,
                "events": false,
                "called_from": [],
                "init": true,
                "action_parameters": null
            }
        },
        {
            "functions": [],
            "relations": [
                {
                    "name": "packed_forwarded(P:stream_data)\n",
                    "comment": "",
                    "line": 149,
                    "file": "forged_quic_packet.ivy"
                },
                {
                    "name": "packed_forwarded_arr(P:forged_pkts)\n",
                    "comment": "",
                    "line": 151,
                    "file": "forged_quic_packet.ivy"
                }
            ]
        }
    ],
    "forged_quic_packet_retry.ivy": [
        {
            "actions": {
                "action_name": "init",
                "action_return": null,
                "implementation": [
                    {
                        "line": 159,
                        "file": "forged_quic_packet_retry.ivy",
                        "instruction": "\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "exported": false,
                "events": false,
                "called_from": [],
                "init": true,
                "action_parameters": null
            }
        },
        {
            "functions": [],
            "relations": []
        }
    ],
    "replayed_quic_packet_0rtt.ivy": [
        {
            "actions": {
                "action_name": "init",
                "action_return": null,
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "exported": false,
                "events": false,
                "called_from": [],
                "init": true,
                "action_parameters": null
            }
        },
        {
            "functions": [],
            "relations": []
        }
    ],
    "ivy_quic_mim.ivy": [
        {
            "actions": {
                "action_name": "init",
                "action_return": null,
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "exported": false,
                "events": false,
                "called_from": [],
                "init": true,
                "action_parameters": null
            }
        },
        {
            "functions": [],
            "relations": []
        }
    ],
    "ivy_quic_client_standard_tp.ivy": [
        {
            "actions": {
                "line": 4,
                "action_name": "make_transport_parameters",
                "implementation": [
                    {
                        "line": 3,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    var imsdbl : initial_max_stream_data_bidi_local;\n"
                    },
                    {
                        "line": 4,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    imsdbl.stream_pos_32 := max_stream_data;\n"
                    },
                    {
                        "line": 5,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    var imd : initial_max_data;\n"
                    },
                    {
                        "line": 6,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    imd.stream_pos_32 := random_stream_pos(1,0xFFFFFFF);\n"
                    },
                    {
                        "line": 7,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    var it : max_idle_timeout;\n"
                    },
                    {
                        "line": 8,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    it.seconds_16 := random_microsecs(0,0xFFFFFFF);\n"
                    },
                    {
                        "line": 9,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    var imsdbr : initial_max_stream_data_bidi_remote;\n"
                    },
                    {
                        "line": 10,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    imsdbr.stream_pos_32 := max_stream_data;\n"
                    },
                    {
                        "line": 11,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    var imsdu : initial_max_stream_data_uni;\n"
                    },
                    {
                        "line": 12,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    imsdu.stream_pos_32 := random_stream_pos(1,0xFFFFFFF);\n"
                    },
                    {
                        "line": 13,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    tp.transport_parameters := tp.transport_parameters.append(imsdbl);\n"
                    },
                    {
                        "line": 14,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    tp.transport_parameters := tp.transport_parameters.append(imd);\n"
                    },
                    {
                        "line": 15,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    tp.transport_parameters := tp.transport_parameters.append(it);\n"
                    },
                    {
                        "line": 16,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    tp.transport_parameters := tp.transport_parameters.append(imsdbr);\n"
                    },
                    {
                        "line": 17,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    tp.transport_parameters := tp.transport_parameters.append(imsdu);\n"
                    },
                    {
                        "line": 18,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 19,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    var icid : initial_source_connection_id; #TODO update v29\n"
                    },
                    {
                        "line": 20,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    icid.scid := the_cid;\n"
                    },
                    {
                        "line": 21,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    tp.transport_parameters := tp.transport_parameters.append(icid);\n"
                    },
                    {
                        "line": 22,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 23,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    var no_migration : disable_active_migration; #TODO update v29\n"
                    },
                    {
                        "line": 24,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    tp.transport_parameters := tp.transport_parameters.append(no_migration);\n"
                    },
                    {
                        "line": 25,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 26,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    var max_streams_bidi : initial_max_stream_id_bidi; #TODO update v29\n"
                    },
                    {
                        "line": 27,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    max_streams_bidi.stream_id_16 := random_stream_id(4,0xFFFFFFF);\n"
                    },
                    {
                        "line": 28,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    tp.transport_parameters := tp.transport_parameters.append(max_streams_bidi);\n"
                    },
                    {
                        "line": 29,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 30,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    var max_streams_uni : initial_max_stream_id_uni; #TODO update rfc9000\n"
                    },
                    {
                        "line": 31,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    max_streams_uni.stream_id_16 := random_stream_id(4,0xFFFFFFF);\n"
                    },
                    {
                        "line": 32,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    tp.transport_parameters := tp.transport_parameters.append(max_streams_uni);\n"
                    },
                    {
                        "line": 33,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 34,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    # var max_ack_dela : max_ack_delay; #TODO update rfc9000 -> ERROR\n"
                    },
                    {
                        "line": 35,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    # max_ack_dela.exponent_8 := random_microsecs(4,0xFFFFFFF);\n"
                    },
                    {
                        "line": 36,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    # tp.transport_parameters := tp.transport_parameters.append(max_ack_dela);\n"
                    },
                    {
                        "line": 37,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "\n"
                    },
                    {
                        "line": 38,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    # var max_packet_z : max_packet_size; #TODO update rfc9000\n"
                    },
                    {
                        "line": 39,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    # max_packet_z.stream_pos_16 := 1500;\n"
                    },
                    {
                        "line": 40,
                        "file": "ivy_quic_client_standard_tp.ivy",
                        "instruction": "    # tp.transport_parameters := tp.transport_parameters.append(max_packet_z);\n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": []
                },
                "action_return": {
                    "name": "tp",
                    "type": "quic_transport_parameters"
                },
                "action_parameters": null,
                "exported": false,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "functions": [],
            "relations": []
        }
    ],
    "quic_packet_0rtt.ivy": [
        {
            "actions": {
                "line": 89,
                "action_name": "packet_event_0rtt",
                "implementation": [
                    {
                        "line": 89,
                        "file": "quic_packet_0rtt.ivy",
                        "instruction": "    \n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [
                        {
                            "line": 84,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "    if _generating {  # & ~conn_closed(pkt.the_cid)\n"
                        },
                        {
                            "line": 85,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var spkt := pkt_serdes_0rtt.to_bytes(pkt);\n"
                        },
                        {
                            "line": 86,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var pkts := prot.arr.empty;\n"
                        },
                        {
                            "line": 87,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var tls_id := src_tls_id(src);\n"
                        },
                        {
                            "line": 88,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var rnum := reference_pkt_num(spkt,false);\n"
                        },
                        {
                            "line": 89,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var ppkt := prot.encrypt_rtt(tls_id,rnum,spkt);\n"
                        },
                        {
                            "line": 90,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        pkts := pkts.append(ppkt);\n"
                        },
                        {
                            "line": 91,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        call net.send(endpoint_to_pid(src),endpoint_to_socket(src),dst,pkts);\n"
                        },
                        {
                            "line": 92,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        zero_rtt_sent := true;\n"
                        },
                        {
                            "line": 93,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "    }\n"
                        }
                    ],
                    "around": [
                        {
                            "line": 286,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # Extract the source and destination cid's and packet number from the packet.\n"
                        },
                        {
                            "line": 287,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    \n"
                        },
                        {
                            "line": 288,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    var dcid := pkt.dst_cid;\n"
                        },
                        {
                            "line": 289,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    var scid := pkt.src_cid;\n"
                        },
                        {
                            "line": 290,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    if cid_mapped(dcid) {\n"
                        },
                        {
                            "line": 291,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\t    dcid := cid_to_aid(dcid);\n"
                        },
                        {
                            "line": 292,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 293,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 294,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    if src = client_alt | dst = client_alt {\n"
                        },
                        {
                            "line": 295,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\t    migration_done := true;\n"
                        },
                        {
                            "line": 296,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\t    #call net.close(endpoint_id.client,sock);\t# destroy connection ?\n"
                        },
                        {
                            "line": 297,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 298,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 299,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # =================================================\n"
                        },
                        {
                            "line": 300,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 301,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #require pkt.ptype = queued_level(scid);\n"
                        },
                        {
                            "line": 302,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #require queued_level(scid) = quic_packet_type.zero_rtt;\n"
                        },
                        {
                            "line": 303,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    require pkt.ptype = quic_packet_type.zero_rtt;\n"
                        },
                        {
                            "line": 304,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #established_1rtt_keys(scid) := true;\n"
                        },
                        {
                            "line": 305,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 306,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # 0-RTT and 1-RTT belongs to application PN space\n"
                        },
                        {
                            "line": 307,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # TODO make more elegant\n"
                        },
                        {
                            "line": 308,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    var pn_app_space := quic_packet_type.one_rtt; \n"
                        },
                        {
                            "line": 309,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    require ~sent_pkt(scid,pn_app_space,pkt.seq_num);  # [4]\n"
                        },
                        {
                            "line": 310,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    sent_pkt(scid,pn_app_space,pkt.seq_num) := true;   # [1]\n"
                        },
                        {
                            "line": 311,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 312,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 313,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    require scid = initial_scid & dcid = initial_dcid; # [2]\n"
                        },
                        {
                            "line": 314,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 315,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #require pkt.ptype = quic_packet_type.one_rtt;\n"
                        },
                        {
                            "line": 316,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #queued_level_rtt(scid) := quic_packet_type.zero_rtt;\n"
                        },
                        {
                            "line": 317,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 318,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    require num_queued_frames_rtt(scid) > 0;  # [7]\n"
                        },
                        {
                            "line": 319,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 320,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # The payload must exactly match the queued frames.\n"
                        },
                        {
                            "line": 321,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 322,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    require pkt.payload = queued_frames_rtt(scid);\n"
                        },
                        {
                            "line": 323,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 324,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "  \n"
                        },
                        {
                            "line": 325,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # Similarly, an endpoint MUST NOT reuse a connection ID when sending to\n"
                        },
                        {
                            "line": 326,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # more than one destination address.  \n"
                        },
                        {
                            "line": 327,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    \n"
                        },
                        {
                            "line": 328,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 329,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # require retry_source_connection_id.is_set(trans_params(dcid));\n"
                        },
                        {
                            "line": 330,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    \n"
                        },
                        {
                            "line": 331,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # The destination cid must represent an existing connection,\n"
                        },
                        {
                            "line": 332,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # except in the case of a client initial packet, when the\n"
                        },
                        {
                            "line": 333,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # destination cid may be the nonce cid chosen by the client for\n"
                        },
                        {
                            "line": 334,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # the given source cid.\n"
                        },
                        {
                            "line": 335,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 336,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #require pkt.ptype = quic_packet_type.retry & is_client(scid) & dcid = nonce_cid(scid);\n"
                        },
                        {
                            "line": 337,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 338,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #call show_pstats(scid,pkt.ptype,pkt.seq_num);\n"
                        },
                        {
                            "line": 339,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #call show_pstats(scid,queued_level(scid),pkt.seq_num);\n"
                        },
                        {
                            "line": 340,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 341,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # The packet type must match the encryption level of the queued\n"
                        },
                        {
                            "line": 342,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # frames at the source. \n"
                        },
                        {
                            "line": 343,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 344,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 345,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #require pkt.ptype = quic_packet_type.zero_rtt | pkt.ptype = quic_packet_type.one_rtt; # tODO\n"
                        },
                        {
                            "line": 346,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    require connected(dcid) -> connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 347,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    require conn_seen(scid) & pkt.long & is_client(scid) -> conn_requested(src,dst,scid);\n"
                        },
                        {
                            "line": 348,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 349,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # Packet must be sent to the endpoint from which the highest numbered\n"
                        },
                        {
                            "line": 350,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # packet has been received. ~queued_challenge(dcid) & \n"
                        },
                        {
                            "line": 351,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # call show_probing(dcid ,hi_non_probing(dcid));\n"
                        },
                        {
                            "line": 352,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # require  conn_seen(dcid) -> hi_non_probing_endpoint(dcid,dst);  # [10]\n"
                        },
                        {
                            "line": 353,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 354,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 355,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # QUESTION: THis sentence is from draft-18 section 13.1: \"An\n"
                        },
                        {
                            "line": 356,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #   endpoint MUST NOT send a packet containing only an ACK frame\n"
                        },
                        {
                            "line": 357,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #   in response to a packet containing only ACK or PADDING frames,\n"
                        },
                        {
                            "line": 358,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #   even if there are packet gaps which precede the received\n"
                        },
                        {
                            "line": 359,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #   packet.\" Do we interpret this to mean that an ack-only packet\n"
                        },
                        {
                            "line": 360,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #   cannot ack *only* ack-only packets?  Or that an ack-only\n"
                        },
                        {
                            "line": 361,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    #   packet cannot ack *any* ack-only packets?\n"
                        },
                        {
                            "line": 362,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 363,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    ...\n"
                        },
                        {
                            "line": 364,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 365,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # Here, we have the updates to the packet protocol state.\n"
                        },
                        {
                            "line": 366,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 367,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # TEMPORARY: The following are repeated because currently locals defined in\n"
                        },
                        {
                            "line": 368,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # the \"before\" section cannot be accessed in the \"after\" section.\n"
                        },
                        {
                            "line": 369,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 370,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    var dcid := pkt.dst_cid;\n"
                        },
                        {
                            "line": 371,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    var scid := pkt.src_cid if pkt.long else connected_to(dcid);\n"
                        },
                        {
                            "line": 372,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 373,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    if cid_mapped(dcid) {\n"
                        },
                        {
                            "line": 374,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\t    dcid := cid_to_aid(dcid);\n"
                        },
                        {
                            "line": 375,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 376,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 377,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    if queued_ack_eliciting(scid) {\n"
                        },
                        {
                            "line": 378,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "       ack_credit(dcid) := ack_credit(dcid) + 1;\n"
                        },
                        {
                            "line": 379,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 380,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    if ~queued_non_ack(scid) {\n"
                        },
                        {
                            "line": 381,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "       ack_credit(scid) := ack_credit(scid) - 1;\n"
                        },
                        {
                            "line": 382,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 383,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 384,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 385,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # Record the packet number as latest seen\n"
                        },
                        {
                            "line": 386,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 387,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    last_pkt_num(scid,pkt.ptype) := pkt.seq_num;\n"
                        },
                        {
                            "line": 388,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    # TODO: the following should not be here\n"
                        },
                        {
                            "line": 389,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 390,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    if pkt.ptype = quic_packet_type.zero_rtt & ~_generating {\n"
                        },
                        {
                            "line": 391,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "        connected(the_cid) := true;\n"
                        },
                        {
                            "line": 392,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "        connected(scid) := true;\n"
                        },
                        {
                            "line": 393,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "        connected_to(the_cid) := scid;\n"
                        },
                        {
                            "line": 394,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "        connected_to(scid) := the_cid;\n"
                        },
                        {
                            "line": 395,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 396,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 397,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    zero_rtt_sent := true;\n"
                        },
                        {
                            "line": 398,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 399,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    queued_frames_rtt(scid) := frame.arr.empty;\n"
                        },
                        {
                            "line": 400,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    queued_non_probing(scid) := false;\n"
                        },
                        {
                            "line": 401,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    queued_non_ack(scid) := false;\n"
                        },
                        {
                            "line": 402,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    queued_close(scid) := false;\n"
                        },
                        {
                            "line": 403,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    num_queued_frames_rtt(scid) := 0;\n"
                        },
                        {
                            "line": 404,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "#Hamid\n"
                        },
                        {
                            "line": 405,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "    queued_ack_eliciting(scid) := false;\n"
                        },
                        {
                            "line": 406,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "#Hamid\n"
                        }
                    ]
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "pkt",
                        "type": "quic_packet_0rtt"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "net.send",
                        "component": "ivy_quic_shim_client.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [
                        {
                            "caller_func": "tls_client_0rtt_response",
                            "component": "quic_security.ivy"
                        }
                    ],
                    "assertions": [
                        {
                            "line": 304,
                            "file": "quic_packet_0rtt.ivy",
                            "assertion": "require pkt.ptype = quic_packet_type.zero_rtt;\n"
                        },
                        {
                            "line": 310,
                            "file": "quic_packet_0rtt.ivy",
                            "assertion": "require ~sent_pkt(scid,pn_app_space,pkt.seq_num);  # [4]\n"
                        },
                        {
                            "line": 314,
                            "file": "quic_packet_0rtt.ivy",
                            "assertion": "require scid = initial_scid & dcid = initial_dcid; # [2]\n"
                        },
                        {
                            "line": 319,
                            "file": "quic_packet_0rtt.ivy",
                            "assertion": "require num_queued_frames_rtt(scid) > 0;  # [7]\n"
                        },
                        {
                            "line": 323,
                            "file": "quic_packet_0rtt.ivy",
                            "assertion": "require pkt.payload = queued_frames_rtt(scid);\n"
                        },
                        {
                            "line": 347,
                            "file": "quic_packet_0rtt.ivy",
                            "assertion": "require connected(dcid) -> connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 348,
                            "file": "quic_packet_0rtt.ivy",
                            "assertion": "require conn_seen(scid) & pkt.long & is_client(scid) -> conn_requested(src,dst,scid);\n"
                        },
                        {
                            "line": 1407,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 1408,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                        },
                        {
                            "line": 1409,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 1110,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 1111,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);  # [3]\n"
                        },
                        {
                            "line": 1112,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 1113,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(scid) & connected_to(scid) = dcid;\n"
                        },
                        {
                            "line": 1114,
                            "file": "quic_frame.ivy",
                            "assertion": "require ~conn_closed(scid);  # [2]\n"
                        },
                        {
                            "line": 313,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require scid = the_cid;\n"
                        },
                        {
                            "line": 717,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 719,
                            "file": "quic_frame.ivy",
                            "assertion": "require ~(e = quic_packet_type.initial) & ~(e = quic_packet_type.handshake); #& ~(e = quic_packet_type.handshake)\n"
                        },
                        {
                            "line": 722,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.handshake -> established_handshake_keys(scid);  # [4]\n"
                        },
                        {
                            "line": 723,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.one_rtt -> established_1rtt_keys(scid);  # [4]\n"
                        },
                        {
                            "line": 728,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 734,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.ack_ranges.end > 0;\n"
                        },
                        {
                            "line": 738,
                            "file": "quic_frame.ivy",
                            "assertion": "require idx > 0 -> ack_range.gap < last - 1;\n"
                        },
                        {
                            "line": 740,
                            "file": "quic_frame.ivy",
                            "assertion": "require ack_range.ranges <= upper;\n"
                        },
                        {
                            "line": 744,
                            "file": "quic_frame.ivy",
                            "assertion": "require sent_pkt(dcid,e,jdx);  # [1]\n"
                        },
                        {
                            "line": 758,
                            "file": "quic_frame.ivy",
                            "assertion": "require some_new_ack;\n"
                        },
                        {
                            "line": 831,
                            "file": "quic_frame.ivy",
                            "assertion": "require (connected(dcid) & connected_to(dcid) = scid); # | (e = quic_packet_type.zero_rtt & established_0rtt_keys(scid)); #e = quic_packet_type.zero_rtt & \n"
                        },
                        {
                            "line": 832,
                            "file": "quic_frame.ivy",
                            "assertion": "require (e = quic_packet_type.one_rtt & established_1rtt_keys(scid)); # | (e = quic_packet_type.zero_rtt & established_0rtt_keys(scid)); # | e = quic_packet_type.zero_rtt  | e = quic_packet_type.zero_rtt & established_0rtt_keys(scid)  \n"
                        },
                        {
                            "line": 835,
                            "file": "quic_frame.ivy",
                            "assertion": "require (e = quic_packet_type.one_rtt & established_1rtt_keys(scid)) | (e = quic_packet_type.zero_rtt & ~established_1rtt_keys(scid));\n"
                        },
                        {
                            "line": 845,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 853,
                            "file": "quic_frame.ivy",
                            "assertion": "require ~conn_closed(scid);  # [8]\n"
                        },
                        {
                            "line": 857,
                            "file": "quic_frame.ivy",
                            "assertion": "require ((offset) + (f.length)) <= stream_app_data_end(dcid,f.id);\n"
                        },
                        {
                            "line": 860,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.data = stream_app_data(dcid,f.id).segment(offset,offset+f.length); # TODO\n"
                        },
                        {
                            "line": 861,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.fin <-> (stream_app_data_finished(dcid,f.id) & offset+f.length = stream_app_data_end(dcid,f.id));\n"
                        },
                        {
                            "line": 870,
                            "file": "quic_frame.ivy",
                            "assertion": "require conn_seen(scid);  # [9]\n"
                        },
                        {
                            "line": 878,
                            "file": "quic_frame.ivy",
                            "assertion": "require stream_reset(dcid,f.id) ->\n"
                        },
                        {
                            "line": 883,
                            "file": "quic_frame.ivy",
                            "assertion": "require stream_id_allowed(dcid,f.id,e);  # [6]\n"
                        },
                        {
                            "line": 886,
                            "file": "quic_frame.ivy",
                            "assertion": "require  f.id = 4; #  f.id = 8 |f.id = 4 |\n"
                        },
                        {
                            "line": 244,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require scid = the_cid;\n"
                        },
                        {
                            "line": 246,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require connected(the_cid) & dcid = connected_to(the_cid);\n"
                        },
                        {
                            "line": 248,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require f.len & f.off; \n"
                        },
                        {
                            "line": 249,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require f.length > 0;\n"
                        },
                        {
                            "line": 250,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require f.offset = stream_length(dcid,f.id);\n"
                        },
                        {
                            "line": 251,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require f.length = (stream_app_data_end(dcid,f.id)) - f.offset;\n"
                        },
                        {
                            "line": 1754,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 1755,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);\n"
                        },
                        {
                            "line": 1756,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 1765,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.packet_tolerence > 0;\n"
                        },
                        {
                            "line": 1766,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.update_max_ack_delay > min; \n"
                        },
                        {
                            "line": 1767,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.ignore_order = 1 | f.ignore_order = 0;\n"
                        },
                        {
                            "line": 1770,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.seq_num = 0;\n"
                        },
                        {
                            "line": 1773,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.seq_num > last_ack_freq_seq(scid);\n"
                        },
                        {
                            "line": 1482,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 1483,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 1485,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.one_rtt & established_1rtt_keys(scid);            \n"
                        },
                        {
                            "line": 1488,
                            "file": "quic_frame.ivy",
                            "assertion": "require ~conn_closed(scid); \n"
                        }
                    ]
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "quic_packet_0rtt_name": "quic_packet_0rtt",
            "quic_packet_0rtt_object": [
                {
                    "name": "ptype",
                    "type": "quic_packet_type,"
                },
                {
                    "name": "pversion",
                    "type": "version,"
                },
                {
                    "name": "dst_cid",
                    "type": "cid,"
                },
                {
                    "name": "src_cid",
                    "type": "cid,"
                },
                {
                    "name": "seq_num",
                    "type": "pkt_num,"
                },
                {
                    "name": "payload",
                    "type": "frame.arr"
                }
            ],
            "quic_packet_0rtt_module": null,
            "actions": [
                {
                    "line": 68,
                    "action_name": "quic_packet_0rtt.long",
                    "implementation": [
                        {
                            "line": 67,
                            "file": "quic_packet_0rtt.ivy",
                            "instruction": "        res := pkt.ptype ~= quic_packet_type.one_rtt;\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "res",
                        "type": "bool"
                    },
                    "action_parameters": [
                        {
                            "name": "pkt",
                            "type": "this"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "quic_packet_0rtt.long",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "functions": [
                {
                    "name": "last_zrtt_pkt : stream_data\n",
                    "comment": "",
                    "line": 276,
                    "file": "quic_packet_0rtt.ivy"
                }
            ],
            "relations": [
                {
                    "name": "zrtt_pkt_set\n",
                    "comment": "",
                    "line": 277,
                    "file": "quic_packet_0rtt.ivy"
                },
                {
                    "name": "zrtt_pkt_process\n",
                    "comment": "",
                    "line": 278,
                    "file": "quic_packet_0rtt.ivy"
                }
            ]
        }
    ],
    "quic_packet_retry.ivy": [
        {
            "actions": {
                "line": 90,
                "action_name": "packet_event_retry",
                "implementation": [
                    {
                        "line": 90,
                        "file": "quic_packet_retry.ivy",
                        "instruction": "    \n"
                    }
                ],
                "monitor": {
                    "before": [],
                    "after": [
                        {
                            "line": 61,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "    if _generating {  # & ~conn_closed(pkt.the_cid)\n"
                        },
                        {
                            "line": 62,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var spkt := pkt_serdes_retry.to_bytes(pkt);\n"
                        },
                        {
                            "line": 63,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        var pkts := prot.arr.empty;\n"
                        },
                        {
                            "line": 64,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        pkts := pkts.append(spkt);\n"
                        },
                        {
                            "line": 65,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "        call net.send(endpoint_to_pid(src),endpoint_to_socket(src),dst,pkts);\n"
                        },
                        {
                            "line": 66,
                            "file": "ivy_quic_shim_client.ivy",
                            "instruction": "    }\n"
                        }
                    ],
                    "around": [
                        {
                            "line": 180,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    # Extract the source and destination cid's and packet number from the packet.\n"
                        },
                        {
                            "line": 181,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    var dcid := pkt.dst_cid;\n"
                        },
                        {
                            "line": 182,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    var scid := pkt.src_cid;\n"
                        },
                        {
                            "line": 183,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    if cid_mapped(dcid) {\n"
                        },
                        {
                            "line": 184,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\t    dcid := cid_to_aid(dcid);\n"
                        },
                        {
                            "line": 185,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 186,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 187,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    if src = client_alt | dst = client_alt {\n"
                        },
                        {
                            "line": 188,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\t    migration_done := true;\n"
                        },
                        {
                            "line": 189,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\t    #call net.close(endpoint_id.client,sock);\t# destroy connection ?\n"
                        },
                        {
                            "line": 190,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 191,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 192,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    if ~ _generating  { # TODO refactor with client test \n"
                        },
                        {
                            "line": 193,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        var expected_itoken := prot.retry_integrity_tag(8,server_cid,\n"
                        },
                        {
                            "line": 194,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "                                           pkt.pversion,\n"
                        },
                        {
                            "line": 195,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "                                           scid_size_pos(true),dcid,\n"
                        },
                        {
                            "line": 196,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "                                           dcid_size_pos(true),scid,\n"
                        },
                        {
                            "line": 197,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "                                           pkt.token, \n"
                        },
                        {
                            "line": 198,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "                                           last_pkt_num(scid,quic_packet_type.initial),\n"
                        },
                        {
                            "line": 199,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "                                           header_retry,\n"
                        },
                        {
                            "line": 200,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "                                           token_saved);\n"
                        },
                        {
                            "line": 201,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 202,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        require bytes_to_itoken(expected_itoken) = pkt.integrity_token;\n"
                        },
                        {
                            "line": 203,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 204,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    # Similarly, an endpoint MUST NOT reuse a connection ID when sending to\n"
                        },
                        {
                            "line": 205,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    # more than one destination address.  \n"
                        },
                        {
                            "line": 206,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        \n"
                        },
                        {
                            "line": 207,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    # The destination cid must represent an existing connection,\n"
                        },
                        {
                            "line": 208,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    # except in the case of a client initial packet, when the\n"
                        },
                        {
                            "line": 209,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    # destination cid may be the nonce cid chosen by the client for\n"
                        },
                        {
                            "line": 210,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    # the given source cid.\n"
                        },
                        {
                            "line": 211,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 212,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    require pkt.ptype = quic_packet_type.retry; # & is_client(scid) & dcid = nonce_cid(scid);\n"
                        },
                        {
                            "line": 213,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    ...\n"
                        },
                        {
                            "line": 214,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 215,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    # Here, we have the updates to the packet protocol state.\n"
                        },
                        {
                            "line": 216,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 217,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    # TEMPORARY: The following are repeated because currently locals defined in\n"
                        },
                        {
                            "line": 218,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    # the \"before\" section cannot be accessed in the \"after\" section.\n"
                        },
                        {
                            "line": 219,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 220,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    var dcid := pkt.dst_cid;\n"
                        },
                        {
                            "line": 221,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    var scid := pkt.src_cid;\n"
                        },
                        {
                            "line": 222,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 223,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    if cid_mapped(dcid) {\n"
                        },
                        {
                            "line": 224,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\t    dcid := cid_to_aid(dcid);\n"
                        },
                        {
                            "line": 225,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 226,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 227,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    # TODO: the following should not be here\n"
                        },
                        {
                            "line": 228,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 229,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    retry_token(scid) := pkt.token;\n"
                        },
                        {
                            "line": 230,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 231,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    if ~_generating {\n"
                        },
                        {
                            "line": 232,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        conn_requested(src,dst,scid) := false;\n"
                        },
                        {
                            "line": 233,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        conn_requested(src,dst,dcid) := false;\n"
                        },
                        {
                            "line": 234,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        connected(dcid) := false;\n"
                        },
                        {
                            "line": 235,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        connected(scid) := false;\n"
                        },
                        {
                            "line": 236,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        conn_seen(dcid) := false;\n"
                        },
                        {
                            "line": 237,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        conn_seen(scid) := false;\n"
                        },
                        {
                            "line": 238,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        \n"
                        },
                        {
                            "line": 239,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        require ~retry_recv(dcid);\n"
                        },
                        {
                            "line": 240,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        retry_recv(dcid) := true;   \n"
                        },
                        {
                            "line": 241,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        server_cid := scid; # 0x1;\n"
                        },
                        {
                            "line": 242,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 243,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        connected(the_cid)    := false;\n"
                        },
                        {
                            "line": 244,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        connected(server_cid) := false;\n"
                        },
                        {
                            "line": 245,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        conn_seen(server_cid) := false;\n"
                        },
                        {
                            "line": 246,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        conn_seen(the_cid)    := false;\n"
                        },
                        {
                            "line": 247,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        client_initial_rcid   := scid;\n"
                        },
                        {
                            "line": 248,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 249,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        var extns := tls_extensions.empty;\n"
                        },
                        {
                            "line": 250,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        extns := extns.append(make_transport_parameters);\n"
                        },
                        {
                            "line": 251,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        call tls_api.upper.destroy(0);\n"
                        },
                        {
                            "line": 252,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        call tls_api.upper.create(0,false,extns);  # false means this instance of tls is not a server\n"
                        },
                        {
                            "line": 253,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        conn_requested(dst,src,the_cid) := true;\n"
                        },
                        {
                            "line": 254,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 255,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    } else {\n"
                        },
                        {
                            "line": 256,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        retry_sent(scid) := true;\n"
                        },
                        {
                            "line": 257,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        retry_response(scid) := true;\n"
                        },
                        {
                            "line": 258,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        initial_keys_set(scid) := false;\n"
                        },
                        {
                            "line": 259,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        tp_client_set := false;\n"
                        },
                        {
                            "line": 260,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        conn_requested(src,dst,dcid) := false;\n"
                        },
                        {
                            "line": 261,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        conn_requested(src,dst,the_cid) := false;\n"
                        },
                        {
                            "line": 262,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        conn_seen(dcid) := false;\n"
                        },
                        {
                            "line": 263,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        conn_seen(the_cid) := false;\n"
                        },
                        {
                            "line": 264,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "        call tls_api.upper.destroy(src_tls_id(src)); # not totally freeing all parameter\n"
                        },
                        {
                            "line": 265,
                            "file": "quic_packet_retry.ivy",
                            "instruction": "    };\n"
                        }
                    ]
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "pkt",
                        "type": "quic_packet_retry"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "net.send",
                        "component": "ivy_quic_shim_client.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [
                        {
                            "caller_func": "tls_client_retry_response",
                            "component": "quic_security.ivy"
                        }
                    ],
                    "assertions": [
                        {
                            "line": 203,
                            "file": "quic_packet_retry.ivy",
                            "assertion": "require bytes_to_itoken(expected_itoken) = pkt.integrity_token;\n"
                        },
                        {
                            "line": 213,
                            "file": "quic_packet_retry.ivy",
                            "assertion": "require pkt.ptype = quic_packet_type.retry; # & is_client(scid) & dcid = nonce_cid(scid);\n"
                        },
                        {
                            "line": 240,
                            "file": "quic_packet_retry.ivy",
                            "assertion": "require ~retry_recv(dcid);\n"
                        },
                        {
                            "line": 108,
                            "file": "quic_endpoint.ivy",
                            "assertion": "require last_datagram_received_size + 8 > 1200; # 8 is for UDP datagram header\n"
                        },
                        {
                            "line": 1464,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        }
                    ]
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "functions": [
                {
                    "name": "retry_token(C:cid) : stream_data\n",
                    "comment": "",
                    "line": 166,
                    "file": "quic_packet_retry.ivy"
                }
            ],
            "relations": [
                {
                    "name": "retry_sent(C:cid)\n",
                    "comment": "",
                    "line": 160,
                    "file": "quic_packet_retry.ivy"
                },
                {
                    "name": "retry_recv(C:cid)\n",
                    "comment": "",
                    "line": 161,
                    "file": "quic_packet_retry.ivy"
                },
                {
                    "name": "token_saved\n",
                    "comment": "",
                    "line": 162,
                    "file": "quic_packet_retry.ivy"
                },
                {
                    "name": "zero_length_token\n",
                    "comment": "",
                    "line": 163,
                    "file": "quic_packet_retry.ivy"
                },
                {
                    "name": "retry_response(C:cid)\n",
                    "comment": "",
                    "line": 164,
                    "file": "quic_packet_retry.ivy"
                },
                {
                    "name": "retry_client_test\n",
                    "comment": "",
                    "line": 165,
                    "file": "quic_packet_retry.ivy"
                }
            ]
        }
    ],
    "quic_protection.ivy": [
        {
            "prot_name": "prot",
            "prot_object": [],
            "prot_module": {
                "module_parameters": [],
                "module_attributes": []
            },
            "actions": [
                {
                    "line": 550,
                    "action_name": "prot.byte_xor",
                    "implementation": [
                        {
                            "line": 549,
                            "file": "quic_protection.ivy",
                            "instruction": "        <<<\n"
                        },
                        {
                            "line": 550,
                            "file": "quic_protection.ivy",
                            "instruction": "        z = x ^ y;\n"
                        },
                        {
                            "line": 551,
                            "file": "quic_protection.ivy",
                            "instruction": "        >>>\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "z",
                        "type": "byte"
                    },
                    "action_parameters": [
                        {
                            "name": "x",
                            "type": "byte"
                        },
                        {
                            "name": "y",
                            "type": "byte"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 542,
                    "action_name": "prot.bytes_to_cid",
                    "implementation": [
                        {
                            "line": 541,
                            "file": "quic_protection.ivy",
                            "instruction": "        <<<\n"
                        },
                        {
                            "line": 542,
                            "file": "quic_protection.ivy",
                            "instruction": "        val.val = 0;\n"
                        },
                        {
                            "line": 543,
                            "file": "quic_protection.ivy",
                            "instruction": "        for (unsigned i = 0; i < bytes.size(); i++)\n"
                        },
                        {
                            "line": 544,
                            "file": "quic_protection.ivy",
                            "instruction": "            val.val = (val.val << 8) + bytes[i];\n"
                        },
                        {
                            "line": 545,
                            "file": "quic_protection.ivy",
                            "instruction": "        >>>\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "val",
                        "type": "cid"
                    },
                    "action_parameters": [
                        {
                            "name": "bytes",
                            "type": "stream_data"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 459,
                    "action_name": "prot.correct_pnum",
                    "implementation": [
                        {
                            "line": 457,
                            "file": "quic_protection.ivy",
                            "instruction": "        # TODO: for now we assume always 30-bit packet number format\n"
                        },
                        {
                            "line": 458,
                            "file": "quic_protection.ivy",
                            "instruction": "\t\tvar diff : pkt_num := bfe[0][29](pnum - last);\n"
                        },
                        {
                            "line": 459,
                            "file": "quic_protection.ivy",
                            "instruction": "\t\tpnum := last + diff;\n"
                        },
                        {
                            "line": 460,
                            "file": "quic_protection.ivy",
                            "instruction": "\t\tif diff >= 0x20000000 {\n"
                        },
                        {
                            "line": 461,
                            "file": "quic_protection.ivy",
                            "instruction": "\t\t    pnum := pnum - 0x40000000\n"
                        },
                        {
                            "line": 462,
                            "file": "quic_protection.ivy",
                            "instruction": "\t\t}\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "pnum",
                        "type": "pkt_num"
                    },
                    "action_parameters": [
                        {
                            "name": "last",
                            "type": "pkt_num"
                        },
                        {
                            "name": "pnum",
                            "type": "pkt_num"
                        },
                        {
                            "name": "pnum_len",
                            "type": "stream_pos"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 282,
                    "action_name": "prot.decrypt",
                    "implementation": [
                        {
                            "line": 281,
                            "file": "quic_protection.ivy",
                            "instruction": "        var h := get_header_info(pkt,true);\n"
                        },
                        {
                            "line": 282,
                            "file": "quic_protection.ivy",
                            "instruction": "        call show_header(h);\n"
                        },
                        {
                            "line": 283,
                            "file": "quic_protection.ivy",
                            "instruction": "        var level := get_level(pkt);\n"
                        },
                        {
                            "line": 284,
                            "file": "quic_protection.ivy",
                            "instruction": "        if level = 1 & ~zrtt_pkt_set {\n"
                        },
                        {
                            "line": 285,
                            "file": "quic_protection.ivy",
                            "instruction": "            zrtt_pkt_set := true;\n"
                        },
                        {
                            "line": 286,
                            "file": "quic_protection.ivy",
                            "instruction": "            last_zrtt_pkt := pkt;\n"
                        },
                        {
                            "line": 287,
                            "file": "quic_protection.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 288,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 289,
                            "file": "quic_protection.ivy",
                            "instruction": "        var sample_size := tls.iv_size(c,level);\n"
                        },
                        {
                            "line": 290,
                            "file": "quic_protection.ivy",
                            "instruction": "        if ~zrtt_pkt_process & level = 1 {\n"
                        },
                        {
                            "line": 291,
                            "file": "quic_protection.ivy",
                            "instruction": "            res.ok := false;\n"
                        },
                        {
                            "line": 292,
                            "file": "quic_protection.ivy",
                            "instruction": "        } else if sample_size = 0 {\n"
                        },
                        {
                            "line": 293,
                            "file": "quic_protection.ivy",
                            "instruction": "            res.ok := false;\n"
                        },
                        {
                            "line": 294,
                            "file": "quic_protection.ivy",
                            "instruction": "        } \n"
                        },
                        {
                            "line": 295,
                            "file": "quic_protection.ivy",
                            "instruction": "        else {\n"
                        },
                        {
                            "line": 296,
                            "file": "quic_protection.ivy",
                            "instruction": "            var pnum_pos := h.pkt_num_pos; #+ h.token_length;\n"
                        },
                        {
                            "line": 297,
                            "file": "quic_protection.ivy",
                            "instruction": "            var sample_pos := pnum_pos + 4; # + h.token_length;\n"
                        },
                        {
                            "line": 298,
                            "file": "quic_protection.ivy",
                            "instruction": "            if sample_pos + sample_size > pkt.end {\n"
                        },
                        {
                            "line": 299,
                            "file": "quic_protection.ivy",
                            "instruction": "                sample_pos := pkt.end - sample_size\n"
                        },
                        {
                            "line": 300,
                            "file": "quic_protection.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 301,
                            "file": "quic_protection.ivy",
                            "instruction": "            \n"
                        },
                        {
                            "line": 302,
                            "file": "quic_protection.ivy",
                            "instruction": "            var sample := pkt.segment(sample_pos,sample_pos+sample_size);\n"
                        },
                        {
                            "line": 303,
                            "file": "quic_protection.ivy",
                            "instruction": "            var pnum := pkt.segment(pnum_pos,pnum_pos+4);\n"
                        },
                        {
                            "line": 304,
                            "file": "quic_protection.ivy",
                            "instruction": "            var mask := stream_data.empty;\n"
                        },
                        {
                            "line": 305,
                            "file": "quic_protection.ivy",
                            "instruction": "            \n"
                        },
                        {
                            "line": 306,
                            "file": "quic_protection.ivy",
                            "instruction": "            # tricky: this encrypts with the receiving cipher\n"
                        },
                        {
                            "line": 307,
                            "file": "quic_protection.ivy",
                            "instruction": "            # mask = header_protection(hp_key, sample)\n"
                        },
                        {
                            "line": 308,
                            "file": "quic_protection.ivy",
                            "instruction": "            mask := tls.encrypt_cipher(c,level,mask.resize(5,0),sample,true);\n"
                        },
                        {
                            "line": 309,
                            "file": "quic_protection.ivy",
                            "instruction": "            \n"
                        },
                        {
                            "line": 310,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 311,
                            "file": "quic_protection.ivy",
                            "instruction": "            # if (packet[0] & 0x80) == 0x80:\n"
                        },
                        {
                            "line": 312,
                            "file": "quic_protection.ivy",
                            "instruction": "                # Long header: 4 bits masked\n"
                        },
                        {
                            "line": 313,
                            "file": "quic_protection.ivy",
                            "instruction": "            #     packet[0] ^= mask[0] & 0x0f\n"
                        },
                        {
                            "line": 314,
                            "file": "quic_protection.ivy",
                            "instruction": "            # else:\n"
                        },
                        {
                            "line": 315,
                            "file": "quic_protection.ivy",
                            "instruction": "                # Short header: 5 bits masked\n"
                        },
                        {
                            "line": 316,
                            "file": "quic_protection.ivy",
                            "instruction": "            #     packet[0] ^= mask[0] & 0x1f\n"
                        },
                        {
                            "line": 317,
                            "file": "quic_protection.ivy",
                            "instruction": "            var byte0_mask := bvand(mask.value(0), 0x0f if h.hdr_long else 0x1f);\n"
                        },
                        {
                            "line": 318,
                            "file": "quic_protection.ivy",
                            "instruction": "            \n"
                        },
                        {
                            "line": 319,
                            "file": "quic_protection.ivy",
                            "instruction": "            var hdr := pkt.segment(0,pnum_pos);\n"
                        },
                        {
                            "line": 320,
                            "file": "quic_protection.ivy",
                            "instruction": "            hdr := hdr.set(0,byte_xor(hdr.value(0),byte0_mask));\n"
                        },
                        {
                            "line": 321,
                            "file": "quic_protection.ivy",
                            "instruction": "            \n"
                        },
                        {
                            "line": 322,
                            "file": "quic_protection.ivy",
                            "instruction": "            var pnum_len := get_pnum_len_b(hdr);\n"
                        },
                        {
                            "line": 323,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 324,
                            "file": "quic_protection.ivy",
                            "instruction": "            last_datagram_received_size := last_datagram_received_size +  h.payload_length + h.pkt_num_pos + pnum_len;\n"
                        },
                        {
                            "line": 325,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 326,
                            "file": "quic_protection.ivy",
                            "instruction": "            call show_token_len(pnum_len);\n"
                        },
                        {
                            "line": 327,
                            "file": "quic_protection.ivy",
                            "instruction": "            pnum := stream_data_xor(pkt.segment(pnum_pos,pnum_pos+pnum_len),mask.segment(1,1+pnum_len));\n"
                        },
                        {
                            "line": 328,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 329,
                            "file": "quic_protection.ivy",
                            "instruction": "            hdr := hdr.extend(pnum);\n"
                        },
                        {
                            "line": 330,
                            "file": "quic_protection.ivy",
                            "instruction": "            var new_seq := get_pnum(pnum,0,pnum_len);\n"
                        },
                        {
                            "line": 331,
                            "file": "quic_protection.ivy",
                            "instruction": "            new_seq := correct_pnum(seq,new_seq,pnum_len);\n"
                        },
                        {
                            "line": 332,
                            "file": "quic_protection.ivy",
                            "instruction": "            var pyld := pkt.segment(pnum_pos+pnum_len,pkt.end);\n"
                        },
                        {
                            "line": 333,
                            "file": "quic_protection.ivy",
                            "instruction": "            res := tls.decrypt_aead(c,level,pyld,new_seq,hdr); #\n"
                        },
                        {
                            "line": 334,
                            "file": "quic_protection.ivy",
                            "instruction": "            if res.ok {\n"
                        },
                        {
                            "line": 335,
                            "file": "quic_protection.ivy",
                            "instruction": "                # fix up the length field to account for removal of checksum\n"
                        },
                        {
                            "line": 336,
                            "file": "quic_protection.ivy",
                            "instruction": "                if h.hdr_long {\n"
                        },
                        {
                            "line": 337,
                            "file": "quic_protection.ivy",
                            "instruction": "                    var new_len := to_var_int_16(h.payload_length-16);\n"
                        },
                        {
                            "line": 338,
                            "file": "quic_protection.ivy",
                            "instruction": "                    hdr := hdr.resize(h.payload_length_pos,0);\n"
                        },
                        {
                            "line": 339,
                            "file": "quic_protection.ivy",
                            "instruction": "                    hdr := hdr.extend(new_len);\n"
                        },
                        {
                            "line": 340,
                            "file": "quic_protection.ivy",
                            "instruction": "                    hdr := hdr.extend(pnum);\n"
                        },
                        {
                            "line": 341,
                            "file": "quic_protection.ivy",
                            "instruction": "                };\n"
                        },
                        {
                            "line": 342,
                            "file": "quic_protection.ivy",
                            "instruction": "                res.payload := res.data;\n"
                        },
                        {
                            "line": 343,
                            "file": "quic_protection.ivy",
                            "instruction": "                res.data := hdr.extend(res.data);\n"
                        },
                        {
                            "line": 344,
                            "file": "quic_protection.ivy",
                            "instruction": "            }\n"
                        },
                        {
                            "line": 345,
                            "file": "quic_protection.ivy",
                            "instruction": "        }\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "c",
                            "type": "tls_id"
                        },
                        {
                            "name": "seq",
                            "type": "pkt_num"
                        },
                        {
                            "name": "pkt",
                            "type": "stream_data"
                        },
                        {
                            "name": "pkt",
                            "type": "stream_data"
                        },
                        {
                            "name": "decrypt",
                            "type": "bool"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 53,
                    "action_name": "prot.encrypt",
                    "implementation": [
                        {
                            "line": 52,
                            "file": "quic_protection.ivy",
                            "instruction": "        var h := get_header_info(pkt,false);\n"
                        },
                        {
                            "line": 53,
                            "file": "quic_protection.ivy",
                            "instruction": "        var level := get_level(pkt);\n"
                        },
                        {
                            "line": 54,
                            "file": "quic_protection.ivy",
                            "instruction": "        var sample_size : stream_pos := tls.iv_size(c,level);\n"
                        },
                        {
                            "line": 55,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pnum_pos := h.pkt_num_pos;\n"
                        },
                        {
                            "line": 56,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pnum_len := get_pnum_len(pkt);\n"
                        },
                        {
                            "line": 57,
                            "file": "quic_protection.ivy",
                            "instruction": "        var hdr_len := pnum_pos + pnum_len;\n"
                        },
                        {
                            "line": 58,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 59,
                            "file": "quic_protection.ivy",
                            "instruction": "        # Tricky: before encrypting the payload, we need to adjust the length field\n"
                        },
                        {
                            "line": 60,
                            "file": "quic_protection.ivy",
                            "instruction": "        # so that it includes the AEAD checksum. Of course, we don't know what\n"
                        },
                        {
                            "line": 61,
                            "file": "quic_protection.ivy",
                            "instruction": "        # that actually is. Here we assume it is 16 bytes. Even worse, the length of\n"
                        },
                        {
                            "line": 62,
                            "file": "quic_protection.ivy",
                            "instruction": "        # the length field could grow. Here, we assume the length field format is\n"
                        },
                        {
                            "line": 63,
                            "file": "quic_protection.ivy",
                            "instruction": "        # always two bytes. \n"
                        },
                        {
                            "line": 64,
                            "file": "quic_protection.ivy",
                            "instruction": "        if h.hdr_long {\n"
                        },
                        {
                            "line": 65,
                            "file": "quic_protection.ivy",
                            "instruction": "            var new_len := to_var_int_16(h.payload_length+16);\n"
                        },
                        {
                            "line": 66,
                            "file": "quic_protection.ivy",
                            "instruction": "            pkt := pkt.set(pnum_pos-2,new_len.value(0));\n"
                        },
                        {
                            "line": 67,
                            "file": "quic_protection.ivy",
                            "instruction": "            pkt := pkt.set(pnum_pos-1,new_len.value(1));\n"
                        },
                        {
                            "line": 68,
                            "file": "quic_protection.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 69,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 70,
                            "file": "quic_protection.ivy",
                            "instruction": "        var hdr  := pkt.segment(0,pnum_pos);\n"
                        },
                        {
                            "line": 71,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pnum := pkt.segment(pnum_pos,hdr_len);\n"
                        },
                        {
                            "line": 72,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pyld := pkt.segment(hdr_len,pkt.end);\n"
                        },
                        {
                            "line": 73,
                            "file": "quic_protection.ivy",
                            "instruction": "        var auth := pkt.segment(0,hdr_len);\n"
                        },
                        {
                            "line": 74,
                            "file": "quic_protection.ivy",
                            "instruction": "        var new_seq := get_pnum(pnum,0,pnum_len);\n"
                        },
                        {
                            "line": 75,
                            "file": "quic_protection.ivy",
                            "instruction": "        new_seq := correct_pnum(seq,new_seq,pnum_len);\n"
                        },
                        {
                            "line": 76,
                            "file": "quic_protection.ivy",
                            "instruction": "        pyld := tls.encrypt_aead(c,level,pyld,new_seq,auth);\n"
                        },
                        {
                            "line": 77,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 78,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 79,
                            "file": "quic_protection.ivy",
                            "instruction": "        # call show_aead(level,pyld,new_seq,auth);\n"
                        },
                        {
                            "line": 80,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 81,
                            "file": "quic_protection.ivy",
                            "instruction": "        # start l 3Computing the sample position is a bit tricky. First we\n"
                        },
                        {
                            "line": 82,
                            "file": "quic_protection.ivy",
                            "instruction": "        # assume the length of the pnum is 4, which means the offset\n"
                        },
                        {
                            "line": 83,
                            "file": "quic_protection.ivy",
                            "instruction": "        # of the sample withing the payload is `4 -\n"
                        },
                        {
                            "line": 84,
                            "file": "quic_protection.ivy",
                            "instruction": "        # pnum_len`. However, if there are not enough bytes in the\n"
                        },
                        {
                            "line": 85,
                            "file": "quic_protection.ivy",
                            "instruction": "        # payload, we change it to `payld.end - sample`. Note,\n"
                        },
                        {
                            "line": 86,
                            "file": "quic_protection.ivy",
                            "instruction": "        # however, that we are using natural numbers, so if the\n"
                        },
                        {
                            "line": 87,
                            "file": "quic_protection.ivy",
                            "instruction": "        # position would be negative, it saturates to zero. This is\n"
                        },
                        {
                            "line": 88,
                            "file": "quic_protection.ivy",
                            "instruction": "        # consistent with the statement that you should never sample\n"
                        },
                        {
                            "line": 89,
                            "file": "quic_protection.ivy",
                            "instruction": "        # any bytes from the packet number itself. This leaves the\n"
                        },
                        {
                            "line": 90,
                            "file": "quic_protection.ivy",
                            "instruction": "        # possibility that there are not enough bytes to sample, that\n"
                        },
                        {
                            "line": 91,
                            "file": "quic_protection.ivy",
                            "instruction": "        # is, in the sample, there will be some trailing\n"
                        },
                        {
                            "line": 92,
                            "file": "quic_protection.ivy",
                            "instruction": "        # zeros. Nonetheless, the spec says that the sample size will\n"
                        },
                        {
                            "line": 93,
                            "file": "quic_protection.ivy",
                            "instruction": "        # never be larger than the smallest encrypted payload, so we\n"
                        },
                        {
                            "line": 94,
                            "file": "quic_protection.ivy",
                            "instruction": "        # should be OK.\n"
                        },
                        {
                            "line": 95,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 96,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pn_offset : stream_pos := 0;\n"
                        },
                        {
                            "line": 97,
                            "file": "quic_protection.ivy",
                            "instruction": "        if h.hdr_long {\n"
                        },
                        {
                            "line": 98,
                            "file": "quic_protection.ivy",
                            "instruction": "            pn_offset := hdr_len - pnum_pos;\n"
                        },
                        {
                            "line": 99,
                            "file": "quic_protection.ivy",
                            "instruction": "        } else {\n"
                        },
                        {
                            "line": 100,
                            "file": "quic_protection.ivy",
                            "instruction": "            pn_offset := 1 + 4;\n"
                        },
                        {
                            "line": 101,
                            "file": "quic_protection.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 102,
                            "file": "quic_protection.ivy",
                            "instruction": "\t\n"
                        },
                        {
                            "line": 103,
                            "file": "quic_protection.ivy",
                            "instruction": "        var sample_pos : stream_pos :=  4 - pnum_len;  #- pnum_len;\n"
                        },
                        {
                            "line": 104,
                            "file": "quic_protection.ivy",
                            "instruction": "        var new_pyld := pyld;\n"
                        },
                        {
                            "line": 105,
                            "file": "quic_protection.ivy",
                            "instruction": "        if sample_pos + sample_size > pkt.end { #MC\n"
                        },
                        {
                            "line": 106,
                            "file": "quic_protection.ivy",
                            "instruction": "            var diff := (sample_pos + sample_size) - pyld.end;\n"
                        },
                        {
                            "line": 107,
                            "file": "quic_protection.ivy",
                            "instruction": "            var i : stream_pos := 0;\n"
                        },
                        {
                            "line": 108,
                            "file": "quic_protection.ivy",
                            "instruction": "            while i < diff {\n"
                        },
                        {
                            "line": 109,
                            "file": "quic_protection.ivy",
                            "instruction": "                new_pyld := new_pyld.append(0x00);\n"
                        },
                        {
                            "line": 110,
                            "file": "quic_protection.ivy",
                            "instruction": "                i := i + 1\n"
                        },
                        {
                            "line": 111,
                            "file": "quic_protection.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 112,
                            "file": "quic_protection.ivy",
                            "instruction": "            #sample_pos := pyld.end - sample_size #MC shift vs padding ? #[*1*]\n"
                        },
                        {
                            "line": 113,
                            "file": "quic_protection.ivy",
                            "instruction": "            #check with mcmillan vs maxime piraux\n"
                        },
                        {
                            "line": 114,
                            "file": "quic_protection.ivy",
                            "instruction": "            pyld := new_pyld;  #[*2*]\n"
                        },
                        {
                            "line": 115,
                            "file": "quic_protection.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 116,
                            "file": "quic_protection.ivy",
                            "instruction": "\t \n"
                        },
                        {
                            "line": 117,
                            "file": "quic_protection.ivy",
                            "instruction": "        var sample := pyld.segment(sample_pos,sample_pos+sample_size); \n"
                        },
                        {
                            "line": 118,
                            "file": "quic_protection.ivy",
                            "instruction": "        var mask := stream_data.empty;\n"
                        },
                        {
                            "line": 119,
                            "file": "quic_protection.ivy",
                            "instruction": "        mask := tls.encrypt_cipher(c,level,mask.resize(5,0),sample,false);\n"
                        },
                        {
                            "line": 120,
                            "file": "quic_protection.ivy",
                            "instruction": "        var byte0_mask := bvand(mask.value(0), 0x0f if h.hdr_long else 0x1f);\n"
                        },
                        {
                            "line": 121,
                            "file": "quic_protection.ivy",
                            "instruction": "        hdr := hdr.set(0,byte_xor(pkt.value(0),byte0_mask));\n"
                        },
                        {
                            "line": 122,
                            "file": "quic_protection.ivy",
                            "instruction": "        pnum := stream_data_xor(pkt.segment(pnum_pos,pnum_pos+pnum_len),mask.segment(1,1+pnum_len));        \n"
                        },
                        {
                            "line": 123,
                            "file": "quic_protection.ivy",
                            "instruction": "        pkt := hdr.extend(pnum).extend(pyld);\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "c",
                            "type": "tls_id"
                        },
                        {
                            "name": "seq",
                            "type": "pkt_num"
                        },
                        {
                            "name": "pkt",
                            "type": "stream_data"
                        },
                        {
                            "name": "c",
                            "type": "tls_id"
                        },
                        {
                            "name": "seq",
                            "type": "pkt_num"
                        },
                        {
                            "name": "pkt",
                            "type": "stream_data"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "prot.encrypt",
                            "component": "quic_packet.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 128,
                    "action_name": "prot.encrypt_rtt",
                    "implementation": [
                        {
                            "line": 127,
                            "file": "quic_protection.ivy",
                            "instruction": "        var h := get_header_info(pkt,false);\n"
                        },
                        {
                            "line": 128,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pkt_rtt := pkt.segment(h.payload_length,pkt.end);\n"
                        },
                        {
                            "line": 129,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pkt_init := pkt.segment(0,h.payload_length);\n"
                        },
                        {
                            "line": 130,
                            "file": "quic_protection.ivy",
                            "instruction": "        var h_rtt := get_header_info(pkt_rtt,false);\n"
                        },
                        {
                            "line": 131,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 132,
                            "file": "quic_protection.ivy",
                            "instruction": "        # ----------------------------------------------------------------------\n"
                        },
                        {
                            "line": 133,
                            "file": "quic_protection.ivy",
                            "instruction": "       \n"
                        },
                        {
                            "line": 134,
                            "file": "quic_protection.ivy",
                            "instruction": "        var level := get_level(pkt_init);\n"
                        },
                        {
                            "line": 135,
                            "file": "quic_protection.ivy",
                            "instruction": "        var sample_size : stream_pos := tls.iv_size(c,level);        \n"
                        },
                        {
                            "line": 136,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pnum_pos := h.pkt_num_pos;\n"
                        },
                        {
                            "line": 137,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pnum_len := get_pnum_len(pkt_init);\n"
                        },
                        {
                            "line": 138,
                            "file": "quic_protection.ivy",
                            "instruction": "        var hdr_len := pnum_pos + pnum_len;\n"
                        },
                        {
                            "line": 139,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 140,
                            "file": "quic_protection.ivy",
                            "instruction": "        # Tricky: before encrypting the payload, we need to adjust the length field\n"
                        },
                        {
                            "line": 141,
                            "file": "quic_protection.ivy",
                            "instruction": "        # so that it includes the AEAD checksum. Of course, we don't know what\n"
                        },
                        {
                            "line": 142,
                            "file": "quic_protection.ivy",
                            "instruction": "        # that actually is. Here we assume it is 16 bytes. Even worse, the length of\n"
                        },
                        {
                            "line": 143,
                            "file": "quic_protection.ivy",
                            "instruction": "        # the length field could grow. Here, we assume the length field format is\n"
                        },
                        {
                            "line": 144,
                            "file": "quic_protection.ivy",
                            "instruction": "        # always two bytes. \n"
                        },
                        {
                            "line": 145,
                            "file": "quic_protection.ivy",
                            "instruction": "        if h.hdr_long {\n"
                        },
                        {
                            "line": 146,
                            "file": "quic_protection.ivy",
                            "instruction": "            var new_len := to_var_int_16(h.payload_length-10); # 16 vs 10 -10 +16\n"
                        },
                        {
                            "line": 147,
                            "file": "quic_protection.ivy",
                            "instruction": "            pkt_init := pkt_init.set(pnum_pos-2,new_len.value(0));\n"
                        },
                        {
                            "line": 148,
                            "file": "quic_protection.ivy",
                            "instruction": "            pkt_init := pkt_init.set(pnum_pos-1,new_len.value(1));\n"
                        },
                        {
                            "line": 149,
                            "file": "quic_protection.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 150,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 151,
                            "file": "quic_protection.ivy",
                            "instruction": "        var hdr  := pkt_init.segment(0,pnum_pos);\n"
                        },
                        {
                            "line": 152,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pnum := pkt_init.segment(pnum_pos,hdr_len);\n"
                        },
                        {
                            "line": 153,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pyld_i := pkt_init.segment(hdr_len,pkt.end); \n"
                        },
                        {
                            "line": 154,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 155,
                            "file": "quic_protection.ivy",
                            "instruction": "        var auth := pkt_init.segment(0,hdr_len);\n"
                        },
                        {
                            "line": 156,
                            "file": "quic_protection.ivy",
                            "instruction": "        var new_seq := get_pnum(pnum,0,pnum_len);\n"
                        },
                        {
                            "line": 157,
                            "file": "quic_protection.ivy",
                            "instruction": "        new_seq := correct_pnum(seq,new_seq,pnum_len);\n"
                        },
                        {
                            "line": 158,
                            "file": "quic_protection.ivy",
                            "instruction": "        pyld_i := tls.encrypt_aead(c,level,pyld_i,new_seq,auth);\n"
                        },
                        {
                            "line": 159,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 160,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 161,
                            "file": "quic_protection.ivy",
                            "instruction": "        # start l 3Computing the sample position is a bit tricky. First we\n"
                        },
                        {
                            "line": 162,
                            "file": "quic_protection.ivy",
                            "instruction": "        # assume the length of the pnum is 4, which means the offset\n"
                        },
                        {
                            "line": 163,
                            "file": "quic_protection.ivy",
                            "instruction": "        # of the sample withing the payload is `4 -\n"
                        },
                        {
                            "line": 164,
                            "file": "quic_protection.ivy",
                            "instruction": "        # pnum_len`. However, if there are not enough bytes in the\n"
                        },
                        {
                            "line": 165,
                            "file": "quic_protection.ivy",
                            "instruction": "        # payload, we change it to `payld.end - sample`. Note,\n"
                        },
                        {
                            "line": 166,
                            "file": "quic_protection.ivy",
                            "instruction": "        # however, that we are using natural numbers, so if the\n"
                        },
                        {
                            "line": 167,
                            "file": "quic_protection.ivy",
                            "instruction": "        # position would be negative, it saturates to zero. This is\n"
                        },
                        {
                            "line": 168,
                            "file": "quic_protection.ivy",
                            "instruction": "        # consistent with the statement that you should never sample\n"
                        },
                        {
                            "line": 169,
                            "file": "quic_protection.ivy",
                            "instruction": "        # any bytes from the packet number itself. This leaves the\n"
                        },
                        {
                            "line": 170,
                            "file": "quic_protection.ivy",
                            "instruction": "        # possibility that there are not enough bytes to sample, that\n"
                        },
                        {
                            "line": 171,
                            "file": "quic_protection.ivy",
                            "instruction": "        # is, in the sample, there will be some trailing\n"
                        },
                        {
                            "line": 172,
                            "file": "quic_protection.ivy",
                            "instruction": "        # zeros. Nonetheless, the spec says that the sample size will\n"
                        },
                        {
                            "line": 173,
                            "file": "quic_protection.ivy",
                            "instruction": "        # never be larger than the smallest encrypted payload, so we\n"
                        },
                        {
                            "line": 174,
                            "file": "quic_protection.ivy",
                            "instruction": "        # should be OK.\n"
                        },
                        {
                            "line": 175,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 176,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pn_offset : stream_pos := 0;\n"
                        },
                        {
                            "line": 177,
                            "file": "quic_protection.ivy",
                            "instruction": "        if h.hdr_long {\n"
                        },
                        {
                            "line": 178,
                            "file": "quic_protection.ivy",
                            "instruction": "            pn_offset := hdr_len - pnum_pos;\n"
                        },
                        {
                            "line": 179,
                            "file": "quic_protection.ivy",
                            "instruction": "        } else {\n"
                        },
                        {
                            "line": 180,
                            "file": "quic_protection.ivy",
                            "instruction": "            pn_offset := 1 + 4;\n"
                        },
                        {
                            "line": 181,
                            "file": "quic_protection.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 182,
                            "file": "quic_protection.ivy",
                            "instruction": "\t\n"
                        },
                        {
                            "line": 183,
                            "file": "quic_protection.ivy",
                            "instruction": "        var sample_pos : stream_pos :=  4 - pnum_len;  #- pnum_len;\n"
                        },
                        {
                            "line": 184,
                            "file": "quic_protection.ivy",
                            "instruction": "        var new_pyld := pyld_i;\n"
                        },
                        {
                            "line": 185,
                            "file": "quic_protection.ivy",
                            "instruction": "        if sample_pos + sample_size > pkt_init.end { #MC\n"
                        },
                        {
                            "line": 186,
                            "file": "quic_protection.ivy",
                            "instruction": "            var diff := (sample_pos + sample_size) - pyld_i.end;\n"
                        },
                        {
                            "line": 187,
                            "file": "quic_protection.ivy",
                            "instruction": "            var i : stream_pos := 0;\n"
                        },
                        {
                            "line": 188,
                            "file": "quic_protection.ivy",
                            "instruction": "            while i < diff {\n"
                        },
                        {
                            "line": 189,
                            "file": "quic_protection.ivy",
                            "instruction": "                new_pyld := new_pyld.append(0x00);\n"
                        },
                        {
                            "line": 190,
                            "file": "quic_protection.ivy",
                            "instruction": "                i := i + 1\n"
                        },
                        {
                            "line": 191,
                            "file": "quic_protection.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 192,
                            "file": "quic_protection.ivy",
                            "instruction": "            #sample_pos := pyld.end - sample_size #MC shift vs padding ? #[*1*]\n"
                        },
                        {
                            "line": 193,
                            "file": "quic_protection.ivy",
                            "instruction": "            #check with mcmillan vs maxime piraux\n"
                        },
                        {
                            "line": 194,
                            "file": "quic_protection.ivy",
                            "instruction": "            pyld_i := new_pyld;  #[*2*]\n"
                        },
                        {
                            "line": 195,
                            "file": "quic_protection.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 196,
                            "file": "quic_protection.ivy",
                            "instruction": "\t\n"
                        },
                        {
                            "line": 197,
                            "file": "quic_protection.ivy",
                            "instruction": "        var sample := pyld_i.segment(sample_pos,sample_pos+sample_size); \n"
                        },
                        {
                            "line": 198,
                            "file": "quic_protection.ivy",
                            "instruction": "        var mask := stream_data.empty;\n"
                        },
                        {
                            "line": 199,
                            "file": "quic_protection.ivy",
                            "instruction": "        mask := tls.encrypt_cipher(c,level,mask.resize(5,0),sample,false);\n"
                        },
                        {
                            "line": 200,
                            "file": "quic_protection.ivy",
                            "instruction": "        var byte0_mask := bvand(mask.value(0), 0x0f if h.hdr_long else 0x1f);\n"
                        },
                        {
                            "line": 201,
                            "file": "quic_protection.ivy",
                            "instruction": "        hdr := hdr.set(0,byte_xor(pkt_init.value(0),byte0_mask));\n"
                        },
                        {
                            "line": 202,
                            "file": "quic_protection.ivy",
                            "instruction": "        pnum := stream_data_xor(pkt_init.segment(pnum_pos,pnum_pos+pnum_len),mask.segment(1,1+pnum_len));        \n"
                        },
                        {
                            "line": 203,
                            "file": "quic_protection.ivy",
                            "instruction": "        pkt_init := hdr.extend(pnum).extend(pyld_i);\n"
                        },
                        {
                            "line": 204,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 205,
                            "file": "quic_protection.ivy",
                            "instruction": "        # ----------------------------------------------------------\n"
                        },
                        {
                            "line": 206,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 207,
                            "file": "quic_protection.ivy",
                            "instruction": "        var sample_size_rtt : stream_pos := tls.iv_size(c,1);\n"
                        },
                        {
                            "line": 208,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pnum_pos_rtt := h_rtt.pkt_num_pos;\n"
                        },
                        {
                            "line": 209,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pnum_len_rtt := get_pnum_len_b(pkt_rtt); \n"
                        },
                        {
                            "line": 210,
                            "file": "quic_protection.ivy",
                            "instruction": "        var hdr_len_rtt := pnum_pos_rtt + pnum_len_rtt;\n"
                        },
                        {
                            "line": 211,
                            "file": "quic_protection.ivy",
                            "instruction": "        \n"
                        },
                        {
                            "line": 212,
                            "file": "quic_protection.ivy",
                            "instruction": "        # Tricky: before encrypting the payload, we need to adjust the length field\n"
                        },
                        {
                            "line": 213,
                            "file": "quic_protection.ivy",
                            "instruction": "        # so that it includes the AEAD checksum. Of course, we don't know what\n"
                        },
                        {
                            "line": 214,
                            "file": "quic_protection.ivy",
                            "instruction": "        # that actually is. Here we assume it is 16 bytes. Even worse, the length of\n"
                        },
                        {
                            "line": 215,
                            "file": "quic_protection.ivy",
                            "instruction": "        # the length field could grow. Here, we assume the length field format is\n"
                        },
                        {
                            "line": 216,
                            "file": "quic_protection.ivy",
                            "instruction": "        # always two bytes. \n"
                        },
                        {
                            "line": 217,
                            "file": "quic_protection.ivy",
                            "instruction": "        if h_rtt.hdr_long {\n"
                        },
                        {
                            "line": 218,
                            "file": "quic_protection.ivy",
                            "instruction": "            var new_len := to_var_int_16(h_rtt.payload_length+16);\n"
                        },
                        {
                            "line": 219,
                            "file": "quic_protection.ivy",
                            "instruction": "            pkt_rtt := pkt_rtt.set(pnum_pos_rtt-2,new_len.value(0));\n"
                        },
                        {
                            "line": 220,
                            "file": "quic_protection.ivy",
                            "instruction": "            pkt_rtt := pkt_rtt.set(pnum_pos_rtt-1,new_len.value(1));\n"
                        },
                        {
                            "line": 221,
                            "file": "quic_protection.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 222,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 223,
                            "file": "quic_protection.ivy",
                            "instruction": "        var hdr_rtt  := pkt_rtt.segment(0,pnum_pos_rtt);\n"
                        },
                        {
                            "line": 224,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pnum_rtt := pkt_rtt.segment(pnum_pos_rtt,hdr_len_rtt);\n"
                        },
                        {
                            "line": 225,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pyld_rtt := pkt_rtt.segment(hdr_len_rtt,pkt_rtt.end);\n"
                        },
                        {
                            "line": 226,
                            "file": "quic_protection.ivy",
                            "instruction": "        var auth_rtt := pkt_rtt.segment(0,hdr_len_rtt);\n"
                        },
                        {
                            "line": 227,
                            "file": "quic_protection.ivy",
                            "instruction": "        var new_seq_rtt := get_pnum(pnum_rtt,0,pnum_len_rtt);\n"
                        },
                        {
                            "line": 228,
                            "file": "quic_protection.ivy",
                            "instruction": "        new_seq_rtt := correct_pnum(seq,new_seq_rtt,pnum_len_rtt);\n"
                        },
                        {
                            "line": 229,
                            "file": "quic_protection.ivy",
                            "instruction": "        pyld_rtt := tls.encrypt_aead(c,1,pyld_rtt,new_seq_rtt,auth_rtt);\n"
                        },
                        {
                            "line": 230,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 231,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 232,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 233,
                            "file": "quic_protection.ivy",
                            "instruction": "        # start l 3Computing the sample position is a bit tricky. First we\n"
                        },
                        {
                            "line": 234,
                            "file": "quic_protection.ivy",
                            "instruction": "        # assume the length of the pnum is 4, which means the offset\n"
                        },
                        {
                            "line": 235,
                            "file": "quic_protection.ivy",
                            "instruction": "        # of the sample withing the payload is `4 -\n"
                        },
                        {
                            "line": 236,
                            "file": "quic_protection.ivy",
                            "instruction": "        # pnum_len`. However, if there are not enough bytes in the\n"
                        },
                        {
                            "line": 237,
                            "file": "quic_protection.ivy",
                            "instruction": "        # payload, we change it to `payld.end - sample`. Note,\n"
                        },
                        {
                            "line": 238,
                            "file": "quic_protection.ivy",
                            "instruction": "        # however, that we are using natural numbers, so if the\n"
                        },
                        {
                            "line": 239,
                            "file": "quic_protection.ivy",
                            "instruction": "        # position would be negative, it saturates to zero. This is\n"
                        },
                        {
                            "line": 240,
                            "file": "quic_protection.ivy",
                            "instruction": "        # consistent with the statement that you should never sample\n"
                        },
                        {
                            "line": 241,
                            "file": "quic_protection.ivy",
                            "instruction": "        # any bytes from the packet number itself. This leaves the\n"
                        },
                        {
                            "line": 242,
                            "file": "quic_protection.ivy",
                            "instruction": "        # possibility that there are not enough bytes to sample, that\n"
                        },
                        {
                            "line": 243,
                            "file": "quic_protection.ivy",
                            "instruction": "        # is, in the sample, there will be some trailing\n"
                        },
                        {
                            "line": 244,
                            "file": "quic_protection.ivy",
                            "instruction": "        # zeros. Nonetheless, the spec says that the sample size will\n"
                        },
                        {
                            "line": 245,
                            "file": "quic_protection.ivy",
                            "instruction": "        # never be larger than the smallest encrypted payload, so we\n"
                        },
                        {
                            "line": 246,
                            "file": "quic_protection.ivy",
                            "instruction": "        # should be OK.\n"
                        },
                        {
                            "line": 247,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 248,
                            "file": "quic_protection.ivy",
                            "instruction": "        var pn_offset_rtt : stream_pos := 0;\n"
                        },
                        {
                            "line": 249,
                            "file": "quic_protection.ivy",
                            "instruction": "        if h_rtt.hdr_long {\n"
                        },
                        {
                            "line": 250,
                            "file": "quic_protection.ivy",
                            "instruction": "            pn_offset_rtt := hdr_len_rtt - pnum_pos_rtt;\n"
                        },
                        {
                            "line": 251,
                            "file": "quic_protection.ivy",
                            "instruction": "        } else {\n"
                        },
                        {
                            "line": 252,
                            "file": "quic_protection.ivy",
                            "instruction": "            pn_offset_rtt := 1 + 4;\n"
                        },
                        {
                            "line": 253,
                            "file": "quic_protection.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 254,
                            "file": "quic_protection.ivy",
                            "instruction": "\t\n"
                        },
                        {
                            "line": 255,
                            "file": "quic_protection.ivy",
                            "instruction": "        var sample_pos_rtt : stream_pos :=  4 - pnum_len_rtt;  #- pnum_len;\n"
                        },
                        {
                            "line": 256,
                            "file": "quic_protection.ivy",
                            "instruction": "        var new_pyld_rtt := pyld_rtt;\n"
                        },
                        {
                            "line": 257,
                            "file": "quic_protection.ivy",
                            "instruction": "        if sample_pos_rtt + sample_size_rtt > pkt_rtt.end  { #MC CHECK\n"
                        },
                        {
                            "line": 258,
                            "file": "quic_protection.ivy",
                            "instruction": "            var diff := (sample_pos_rtt + sample_size_rtt) - pyld_rtt.end;\n"
                        },
                        {
                            "line": 259,
                            "file": "quic_protection.ivy",
                            "instruction": "            var i : stream_pos := 0;\n"
                        },
                        {
                            "line": 260,
                            "file": "quic_protection.ivy",
                            "instruction": "            while i < diff {\n"
                        },
                        {
                            "line": 261,
                            "file": "quic_protection.ivy",
                            "instruction": "                new_pyld_rtt := new_pyld_rtt.append(0x00);\n"
                        },
                        {
                            "line": 262,
                            "file": "quic_protection.ivy",
                            "instruction": "                i := i + 1\n"
                        },
                        {
                            "line": 263,
                            "file": "quic_protection.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 264,
                            "file": "quic_protection.ivy",
                            "instruction": "            #check with mcmillan vs maxime piraux\n"
                        },
                        {
                            "line": 265,
                            "file": "quic_protection.ivy",
                            "instruction": "            pyld_rtt := new_pyld_rtt;  #[*2*]\n"
                        },
                        {
                            "line": 266,
                            "file": "quic_protection.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 267,
                            "file": "quic_protection.ivy",
                            "instruction": "\t\n"
                        },
                        {
                            "line": 268,
                            "file": "quic_protection.ivy",
                            "instruction": "        var sample_rtt := pyld_rtt.segment(sample_pos_rtt,sample_pos_rtt+sample_size_rtt); \n"
                        },
                        {
                            "line": 269,
                            "file": "quic_protection.ivy",
                            "instruction": "        var mask_rtt := stream_data.empty;\n"
                        },
                        {
                            "line": 270,
                            "file": "quic_protection.ivy",
                            "instruction": "        mask_rtt := tls.encrypt_cipher(c,1,mask_rtt.resize(5,0),sample_rtt,false); # TODO\n"
                        },
                        {
                            "line": 271,
                            "file": "quic_protection.ivy",
                            "instruction": "        var byte0_mask_rtt := bvand(mask_rtt.value(0), 0x0f if h_rtt.hdr_long else 0x1f);\n"
                        },
                        {
                            "line": 272,
                            "file": "quic_protection.ivy",
                            "instruction": "        hdr_rtt := hdr_rtt.set(0,byte_xor(pkt_rtt.value(0),byte0_mask_rtt));\n"
                        },
                        {
                            "line": 273,
                            "file": "quic_protection.ivy",
                            "instruction": "        pnum_rtt := stream_data_xor(pkt_rtt.segment(pnum_pos_rtt,pnum_pos_rtt+pnum_len_rtt),mask_rtt.segment(1,1+pnum_len_rtt));        \n"
                        },
                        {
                            "line": 274,
                            "file": "quic_protection.ivy",
                            "instruction": "        pkt_rtt := hdr_rtt.extend(pnum_rtt).extend(pyld_rtt);\n"
                        },
                        {
                            "line": 275,
                            "file": "quic_protection.ivy",
                            "instruction": "        # ----------------------------------------------------------\n"
                        },
                        {
                            "line": 276,
                            "file": "quic_protection.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 277,
                            "file": "quic_protection.ivy",
                            "instruction": "        pkt := pkt_init.extend(pkt_rtt);\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "c",
                            "type": "tls_id"
                        },
                        {
                            "name": "seq",
                            "type": "pkt_num"
                        },
                        {
                            "name": "pkt",
                            "type": "stream_data"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 411,
                    "action_name": "prot.get_header_info",
                    "implementation": [
                        {
                            "line": 411,
                            "file": "quic_protection.ivy",
                            "instruction": "        h.hdr_long := bvand(0x80,pkt.value(0)) ~= 0;\n"
                        },
                        {
                            "line": 412,
                            "file": "quic_protection.ivy",
                            "instruction": "        h.hdr_type := bfe[0][6](pkt.value(0));\n"
                        },
                        {
                            "line": 413,
                            "file": "quic_protection.ivy",
                            "instruction": "        if h.hdr_long {\n"
                        },
                        {
                            "line": 414,
                            "file": "quic_protection.ivy",
                            "instruction": "            var dcil : stream_pos := bfe[0][7](pkt.value(5));\n"
                        },
                        {
                            "line": 415,
                            "file": "quic_protection.ivy",
                            "instruction": "            h.dcid := bytes_to_cid(pkt.segment(6,6+dcil));\n"
                        },
                        {
                            "line": 416,
                            "file": "quic_protection.ivy",
                            "instruction": "            var scil : stream_pos := bfe[0][7](pkt.value(6+dcil));\n"
                        },
                        {
                            "line": 417,
                            "file": "quic_protection.ivy",
                            "instruction": "            h.scid := bytes_to_cid(pkt.segment(7+dcil,7+dcil+scil));\n"
                        },
                        {
                            "line": 418,
                            "file": "quic_protection.ivy",
                            "instruction": "            if decrypt {\n"
                        },
                        {
                            "line": 419,
                            "file": "quic_protection.ivy",
                            "instruction": "                client_initial_scil := scil;\n"
                        },
                        {
                            "line": 420,
                            "file": "quic_protection.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 421,
                            "file": "quic_protection.ivy",
                            "instruction": "            var pos := 1 + 4 + 1 + dcil + 1 + scil; #7 + dcil + scil;\n"
                        },
                        {
                            "line": 422,
                            "file": "quic_protection.ivy",
                            "instruction": "            var tlen : stream_pos := 0;\n"
                        },
                        {
                            "line": 423,
                            "file": "quic_protection.ivy",
                            "instruction": "            var retry_token_len : stream_pos := 0;\n"
                        },
                        {
                            "line": 424,
                            "file": "quic_protection.ivy",
                            "instruction": "            if bvand(h.hdr_type,0x30) = 0x00 {\n"
                        },
                        {
                            "line": 425,
                            "file": "quic_protection.ivy",
                            "instruction": "                #Initial packet\n"
                        },
                        {
                            "line": 426,
                            "file": "quic_protection.ivy",
                            "instruction": "                tlen := get_var_int_len(pkt,pos);\n"
                        },
                        {
                            "line": 427,
                            "file": "quic_protection.ivy",
                            "instruction": "                retry_token_len := get_var_int(pkt,pos,tlen);\n"
                        },
                        {
                            "line": 428,
                            "file": "quic_protection.ivy",
                            "instruction": "                h.token_length := retry_token_len;\n"
                        },
                        {
                            "line": 429,
                            "file": "quic_protection.ivy",
                            "instruction": "                pos := pos + tlen + retry_token_len;\n"
                        },
                        {
                            "line": 430,
                            "file": "quic_protection.ivy",
                            "instruction": "            } else {\n"
                        },
                        {
                            "line": 431,
                            "file": "quic_protection.ivy",
                            "instruction": "                h.token_length := 0;\n"
                        },
                        {
                            "line": 432,
                            "file": "quic_protection.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 433,
                            "file": "quic_protection.ivy",
                            "instruction": "            var len := get_var_int_len(pkt,pos);\n"
                        },
                        {
                            "line": 434,
                            "file": "quic_protection.ivy",
                            "instruction": "            h.payload_length := get_var_int(pkt,pos,len);\n"
                        },
                        {
                            "line": 435,
                            "file": "quic_protection.ivy",
                            "instruction": "            h.payload_length_pos := pos;\n"
                        },
                        {
                            "line": 436,
                            "file": "quic_protection.ivy",
                            "instruction": "            h.pkt_num_pos := pos + len;\n"
                        },
                        {
                            "line": 437,
                            "file": "quic_protection.ivy",
                            "instruction": "        }\n"
                        },
                        {
                            "line": 438,
                            "file": "quic_protection.ivy",
                            "instruction": "        else {\n"
                        },
                        {
                            "line": 439,
                            "file": "quic_protection.ivy",
                            "instruction": "            #todo check if good for client test too\n"
                        },
                        {
                            "line": 440,
                            "file": "quic_protection.ivy",
                            "instruction": "            if ~decrypt {\n"
                        },
                        {
                            "line": 441,
                            "file": "quic_protection.ivy",
                            "instruction": "                h.dcid := bytes_to_cid(pkt.segment(1,1+client_initial_scil));\n"
                        },
                        {
                            "line": 442,
                            "file": "quic_protection.ivy",
                            "instruction": "                h.payload_length_pos := 1+client_initial_scil;\n"
                        },
                        {
                            "line": 443,
                            "file": "quic_protection.ivy",
                            "instruction": "                h.pkt_num_pos := 1+client_initial_scil;\n"
                        },
                        {
                            "line": 444,
                            "file": "quic_protection.ivy",
                            "instruction": "            } else {\n"
                        },
                        {
                            "line": 445,
                            "file": "quic_protection.ivy",
                            "instruction": "                h.dcid := bytes_to_cid(pkt.segment(1,1+8));\n"
                        },
                        {
                            "line": 446,
                            "file": "quic_protection.ivy",
                            "instruction": "                h.payload_length_pos := 1+8;\n"
                        },
                        {
                            "line": 447,
                            "file": "quic_protection.ivy",
                            "instruction": "                h.pkt_num_pos := 1+8;\n"
                        },
                        {
                            "line": 448,
                            "file": "quic_protection.ivy",
                            "instruction": "            }\n"
                        },
                        {
                            "line": 449,
                            "file": "quic_protection.ivy",
                            "instruction": "        }\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "h",
                        "type": "header_info"
                    },
                    "action_parameters": [
                        {
                            "name": "pkt",
                            "type": "stream_data"
                        },
                        {
                            "name": "decrypt",
                            "type": "bool"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "prot.get_header_info",
                            "component": "quic_shim.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 369,
                    "action_name": "prot.get_level",
                    "implementation": [
                        {
                            "line": 368,
                            "file": "quic_protection.ivy",
                            "instruction": "        if bvand(pkt.value(0),0x80) ~= 0 {\n"
                        },
                        {
                            "line": 369,
                            "file": "quic_protection.ivy",
                            "instruction": "            var hdr_type := bvand(pkt.value(0),0x30); #  : type_bits :=  bfe[0][6](pkt.value(0)); # \n"
                        },
                        {
                            "line": 370,
                            "file": "quic_protection.ivy",
                            "instruction": "            #call show_htype(hdr_type);\n"
                        },
                        {
                            "line": 371,
                            "file": "quic_protection.ivy",
                            "instruction": "            if hdr_type = 0x00 | hdr_type = 0x30 { # | hdr_type = 0x20\n"
                        },
                        {
                            "line": 372,
                            "file": "quic_protection.ivy",
                            "instruction": "                level := 0;\n"
                        },
                        {
                            "line": 373,
                            "file": "quic_protection.ivy",
                            "instruction": "            } \n"
                        },
                        {
                            "line": 374,
                            "file": "quic_protection.ivy",
                            "instruction": "            else if hdr_type = 0x10 {\n"
                        },
                        {
                            "line": 375,
                            "file": "quic_protection.ivy",
                            "instruction": "                # 0RTT\n"
                        },
                        {
                            "line": 376,
                            "file": "quic_protection.ivy",
                            "instruction": "                level := 1;\n"
                        },
                        {
                            "line": 377,
                            "file": "quic_protection.ivy",
                            "instruction": "            } \n"
                        },
                        {
                            "line": 378,
                            "file": "quic_protection.ivy",
                            "instruction": "            else  { # if hdr_type = 0x20, TODO: other packet types\n"
                        },
                        {
                            "line": 379,
                            "file": "quic_protection.ivy",
                            "instruction": "                level := 2;\n"
                        },
                        {
                            "line": 380,
                            "file": "quic_protection.ivy",
                            "instruction": "            }\n"
                        },
                        {
                            "line": 381,
                            "file": "quic_protection.ivy",
                            "instruction": "        } else {\n"
                        },
                        {
                            "line": 382,
                            "file": "quic_protection.ivy",
                            "instruction": "            level := 3;\n"
                        },
                        {
                            "line": 383,
                            "file": "quic_protection.ivy",
                            "instruction": "        }\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "level",
                        "type": "tls.level"
                    },
                    "action_parameters": [
                        {
                            "name": "pkt",
                            "type": "stream_data"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 482,
                    "action_name": "prot.get_pnum",
                    "implementation": [
                        {
                            "line": 481,
                            "file": "quic_protection.ivy",
                            "instruction": "        var data := pkt.segment(pnum_pos,pnum_pos + pnum_len);\n"
                        },
                        {
                            "line": 482,
                            "file": "quic_protection.ivy",
                            "instruction": "        seq := 0;\n"
                        },
                        {
                            "line": 483,
                            "file": "quic_protection.ivy",
                            "instruction": "        var idx:stream_pos := 0;\n"
                        },
                        {
                            "line": 484,
                            "file": "quic_protection.ivy",
                            "instruction": "        while idx < data.end {\n"
                        },
                        {
                            "line": 485,
                            "file": "quic_protection.ivy",
                            "instruction": "            seq := 256 * seq + bfe[0][7](data.value(idx));\n"
                        },
                        {
                            "line": 486,
                            "file": "quic_protection.ivy",
                            "instruction": "            idx := idx.next;\n"
                        },
                        {
                            "line": 487,
                            "file": "quic_protection.ivy",
                            "instruction": "        }\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "seq",
                        "type": "pkt_num"
                    },
                    "action_parameters": [
                        {
                            "name": "pkt",
                            "type": "stream_data"
                        },
                        {
                            "name": "pnum_pos",
                            "type": "stream_pos"
                        },
                        {
                            "name": "pnum_len",
                            "type": "stream_pos"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 475,
                    "action_name": "prot.get_pnum_len",
                    "implementation": [
                        {
                            "line": 474,
                            "file": "quic_protection.ivy",
                            "instruction": "        var len_minus_one : stream_pos := bfe[0][1](pkt.value(0));\n"
                        },
                        {
                            "line": 475,
                            "file": "quic_protection.ivy",
                            "instruction": "        pnum_len := len_minus_one + 1;\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "pnum_len",
                        "type": "stream_pos"
                    },
                    "action_parameters": [
                        {
                            "name": "pkt",
                            "type": "stream_data"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 469,
                    "action_name": "prot.get_pnum_len_b",
                    "implementation": [
                        {
                            "line": 468,
                            "file": "quic_protection.ivy",
                            "instruction": "        <<<\n"
                        },
                        {
                            "line": 469,
                            "file": "quic_protection.ivy",
                            "instruction": "        pnum_len = (pkt[0] & 0x3) + 1;\n"
                        },
                        {
                            "line": 470,
                            "file": "quic_protection.ivy",
                            "instruction": "        >>>\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "pnum_len",
                        "type": "stream_pos"
                    },
                    "action_parameters": [
                        {
                            "name": "pkt",
                            "type": "stream_data"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 510,
                    "action_name": "prot.get_var_int",
                    "implementation": [
                        {
                            "line": 509,
                            "file": "quic_protection.ivy",
                            "instruction": "        var idx:stream_pos := pos;\n"
                        },
                        {
                            "line": 510,
                            "file": "quic_protection.ivy",
                            "instruction": "        val := 0;\n"
                        },
                        {
                            "line": 511,
                            "file": "quic_protection.ivy",
                            "instruction": "        while idx < pos + len {\n"
                        },
                        {
                            "line": 512,
                            "file": "quic_protection.ivy",
                            "instruction": "            var byte := pkt.value(idx);\n"
                        },
                        {
                            "line": 513,
                            "file": "quic_protection.ivy",
                            "instruction": "            if idx = pos {\n"
                        },
                        {
                            "line": 514,
                            "file": "quic_protection.ivy",
                            "instruction": "                byte := bvand(byte,0x3f);\n"
                        },
                        {
                            "line": 515,
                            "file": "quic_protection.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 516,
                            "file": "quic_protection.ivy",
                            "instruction": "            val := 256 * val + bfe[0][7](byte);\n"
                        },
                        {
                            "line": 517,
                            "file": "quic_protection.ivy",
                            "instruction": "            idx := idx.next;\n"
                        },
                        {
                            "line": 518,
                            "file": "quic_protection.ivy",
                            "instruction": "        }\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "val",
                        "type": "stream_pos"
                    },
                    "action_parameters": [
                        {
                            "name": "pkt",
                            "type": "stream_data"
                        },
                        {
                            "name": "pos",
                            "type": "stream_pos"
                        },
                        {
                            "name": "len",
                            "type": "stream_pos"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 494,
                    "action_name": "prot.get_var_int_len",
                    "implementation": [
                        {
                            "line": 493,
                            "file": "quic_protection.ivy",
                            "instruction": "        var code := bvand(0xc0,pkt.value(pos));\n"
                        },
                        {
                            "line": 494,
                            "file": "quic_protection.ivy",
                            "instruction": "        if code = 0 {\n"
                        },
                        {
                            "line": 495,
                            "file": "quic_protection.ivy",
                            "instruction": "            len := 1;\n"
                        },
                        {
                            "line": 496,
                            "file": "quic_protection.ivy",
                            "instruction": "        } else if code = 0x40 {\n"
                        },
                        {
                            "line": 497,
                            "file": "quic_protection.ivy",
                            "instruction": "            len := 2;\n"
                        },
                        {
                            "line": 498,
                            "file": "quic_protection.ivy",
                            "instruction": "        } else if code = 0x80 {\n"
                        },
                        {
                            "line": 499,
                            "file": "quic_protection.ivy",
                            "instruction": "            len := 4;\n"
                        },
                        {
                            "line": 500,
                            "file": "quic_protection.ivy",
                            "instruction": "        } else {\n"
                        },
                        {
                            "line": 501,
                            "file": "quic_protection.ivy",
                            "instruction": "            len := 8;\n"
                        },
                        {
                            "line": 502,
                            "file": "quic_protection.ivy",
                            "instruction": "        }\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "len",
                        "type": "stream_pos"
                    },
                    "action_parameters": [
                        {
                            "name": "pkt",
                            "type": "stream_data"
                        },
                        {
                            "name": "pos",
                            "type": "stream_pos"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 353,
                    "action_name": "prot.retry_integrity_tag",
                    "implementation": [
                        {
                            "line": 351,
                            "file": "quic_protection.ivy",
                            "instruction": "        # TODO useless, call directly  tls.compute_retry_integrity_tag\n"
                        },
                        {
                            "line": 352,
                            "file": "quic_protection.ivy",
                            "instruction": "        var rt := tls.compute_retry_integrity_tag(\n"
                        },
                        {
                            "line": 353,
                            "file": "quic_protection.ivy",
                            "instruction": "                                odcil, cid_to_us(odcid),\n"
                        },
                        {
                            "line": 354,
                            "file": "quic_protection.ivy",
                            "instruction": "                                pversion,\n"
                        },
                        {
                            "line": 355,
                            "file": "quic_protection.ivy",
                            "instruction": "                                dcil, cid_to_us(dcid),\n"
                        },
                        {
                            "line": 356,
                            "file": "quic_protection.ivy",
                            "instruction": "                                scil, cid_to_us(scid),\n"
                        },
                        {
                            "line": 357,
                            "file": "quic_protection.ivy",
                            "instruction": "                                token,seq,h,b);\n"
                        },
                        {
                            "line": 358,
                            "file": "quic_protection.ivy",
                            "instruction": "         cipher := rt;\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "odcil",
                            "type": "stream_pos"
                        },
                        {
                            "name": "odcid",
                            "type": "cid"
                        },
                        {
                            "name": "pversion",
                            "type": "version"
                        },
                        {
                            "name": "dcil",
                            "type": "stream_pos"
                        },
                        {
                            "name": "dcid",
                            "type": "cid"
                        },
                        {
                            "name": "scil",
                            "type": "stream_pos"
                        },
                        {
                            "name": "scid",
                            "type": "cid"
                        },
                        {
                            "name": "token",
                            "type": "stream_data"
                        },
                        {
                            "name": "seq",
                            "type": "pkt_num"
                        },
                        {
                            "name": "h",
                            "type": "stream_pos"
                        },
                        {
                            "name": "b",
                            "type": "bool"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 564,
                    "action_name": "prot.show_header",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "h",
                            "type": "header_info"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 563,
                    "action_name": "prot.show_token_len",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "ver",
                            "type": "stream_pos"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 556,
                    "action_name": "prot.stream_data_xor",
                    "implementation": [
                        {
                            "line": 555,
                            "file": "quic_protection.ivy",
                            "instruction": "        var idx := x.begin;\n"
                        },
                        {
                            "line": 556,
                            "file": "quic_protection.ivy",
                            "instruction": "        while idx < x.end {\n"
                        },
                        {
                            "line": 557,
                            "file": "quic_protection.ivy",
                            "instruction": "            x := x.set(idx,byte_xor(x.value(idx),y.value(idx)));\n"
                        },
                        {
                            "line": 558,
                            "file": "quic_protection.ivy",
                            "instruction": "            idx := idx.next\n"
                        },
                        {
                            "line": 559,
                            "file": "quic_protection.ivy",
                            "instruction": "        }\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "x",
                        "type": "stream_data"
                    },
                    "action_parameters": [
                        {
                            "name": "x",
                            "type": "stream_data"
                        },
                        {
                            "name": "y",
                            "type": "stream_data"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 523,
                    "action_name": "prot.to_var_int_16",
                    "implementation": [
                        {
                            "line": 522,
                            "file": "quic_protection.ivy",
                            "instruction": "        <<<\n"
                        },
                        {
                            "line": 523,
                            "file": "quic_protection.ivy",
                            "instruction": "        bytes.push_back(0x40 | (val >> 8) & 0x3f);\n"
                        },
                        {
                            "line": 524,
                            "file": "quic_protection.ivy",
                            "instruction": "        bytes.push_back(val & 0xff);\n"
                        },
                        {
                            "line": 525,
                            "file": "quic_protection.ivy",
                            "instruction": "        >>>\n"
                        }
                    ],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": {
                        "name": "bytes",
                        "type": "stream_data"
                    },
                    "action_parameters": [
                        {
                            "name": "val",
                            "type": "stream_pos"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "functions": [],
            "relations": []
        }
    ],
    "quic_security.ivy": [
        {
            "actions": {
                "line": 355,
                "action_name": "set_encryption_level",
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [
                        {
                            "line": 357,
                            "file": "quic_security.ivy",
                            "instruction": "    conn_enc_level(src,scid) := e;\n"
                        }
                    ],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "e",
                        "type": "quic_packet_type"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "set_encryption_level",
                        "component": "quic_infer.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 252,
                "action_name": "show_test",
                "action_return": null,
                "exported": false,
                "action_parameters": null,
                "called_from": [],
                "events": true
            }
        },
        {
            "actions": {
                "line": 351,
                "action_name": "show_tls_keys_established_event",
                "action_return": null,
                "exported": false,
                "action_parameters": [
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "e",
                        "type": "quic_packet_type"
                    }
                ],
                "called_from": [
                    {
                        "caller_func": "show_tls_keys_established_event",
                        "component": "quic_security.ivy"
                    }
                ],
                "events": true
            }
        },
        {
            "actions": {
                "line": 158,
                "action_name": "tls_client_0rtt_response",
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [
                        {
                            "line": 742,
                            "file": "quic_shim.ivy",
                            "instruction": "    if nclients > 1 {\n"
                        },
                        {
                            "line": 743,
                            "file": "quic_shim.ivy",
                            "instruction": "        var cdx := clients.clients.begin;\n"
                        },
                        {
                            "line": 744,
                            "file": "quic_shim.ivy",
                            "instruction": "        while cdx < clients.clients.end {\n"
                        },
                        {
                            "line": 745,
                            "file": "quic_shim.ivy",
                            "instruction": "            var cc := clients.clients.value(cdx);\n"
                        },
                        {
                            "line": 746,
                            "file": "quic_shim.ivy",
                            "instruction": "            # call cc.set_ep(src);\n"
                        },
                        {
                            "line": 747,
                            "file": "quic_shim.ivy",
                            "instruction": "            # if some(cf:endpoint) cc *> cf {\n"
                        },
                        {
                            "line": 748,
                            "file": "quic_shim.ivy",
                            "instruction": "            #     cf.set_ep(src); # TODO: migration?\n"
                        },
                        {
                            "line": 749,
                            "file": "quic_shim.ivy",
                            "instruction": "            # }\n"
                        },
                        {
                            "line": 750,
                            "file": "quic_shim.ivy",
                            "instruction": "            cdx := cdx.next;\n"
                        },
                        {
                            "line": 751,
                            "file": "quic_shim.ivy",
                            "instruction": "        }\n"
                        },
                        {
                            "line": 752,
                            "file": "quic_shim.ivy",
                            "instruction": "    } else {\n"
                        },
                        {
                            "line": 753,
                            "file": "quic_shim.ivy",
                            "instruction": "        #client.set_ep(src); # TODO: migration?\n"
                        },
                        {
                            "line": 754,
                            "file": "quic_shim.ivy",
                            "instruction": "        #if ~endpoint_to_pid(src) = endpoint_id.mim {\n"
                        },
                        {
                            "line": 755,
                            "file": "quic_shim.ivy",
                            "instruction": "        call client.set_ep(src);\n"
                        },
                        {
                            "line": 756,
                            "file": "quic_shim.ivy",
                            "instruction": "        #}\n"
                        },
                        {
                            "line": 757,
                            "file": "quic_shim.ivy",
                            "instruction": "    }\n"
                        },
                        {
                            "line": 758,
                            "file": "quic_shim.ivy",
                            "instruction": "    \n"
                        },
                        {
                            "line": 759,
                            "file": "quic_shim.ivy",
                            "instruction": "\tvar ver := bytes_to_version(spkt.segment(1,5));\n"
                        },
                        {
                            "line": 760,
                            "file": "quic_shim.ivy",
                            "instruction": "    var lens := spkt.value(5);\n"
                        },
                        {
                            "line": 761,
                            "file": "quic_shim.ivy",
                            "instruction": "    var dcil : stream_pos := bfe[0][7](spkt.value(5));\n"
                        },
                        {
                            "line": 762,
                            "file": "quic_shim.ivy",
                            "instruction": "    var ikm := cid_to_bytes(0,1); # dcid\n"
                        },
                        {
                            "line": 763,
                            "file": "quic_shim.ivy",
                            "instruction": "\tif(~dcil = 0) {\n"
                        },
                        {
                            "line": 764,
                            "file": "quic_shim.ivy",
                            "instruction": "        client_initial_dcil := dcil;\n"
                        },
                        {
                            "line": 765,
                            "file": "quic_shim.ivy",
                            "instruction": "\t    ikm := spkt.segment(6,6+dcil); # dcid\n"
                        },
                        {
                            "line": 766,
                            "file": "quic_shim.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 767,
                            "file": "quic_shim.ivy",
                            "instruction": "    var scil : stream_pos := bfe[0][7](spkt.value(6+dcil));\n"
                        },
                        {
                            "line": 768,
                            "file": "quic_shim.ivy",
                            "instruction": "    var skm := cid_to_bytes(0,1); # scid\n"
                        },
                        {
                            "line": 769,
                            "file": "quic_shim.ivy",
                            "instruction": "    if(~scil = 0) {\n"
                        },
                        {
                            "line": 770,
                            "file": "quic_shim.ivy",
                            "instruction": "        client_initial_scil := scil;\n"
                        },
                        {
                            "line": 771,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tclient_non_zero_scil := true;\t\n"
                        },
                        {
                            "line": 772,
                            "file": "quic_shim.ivy",
                            "instruction": "\t    skm := spkt.segment(6+dcil+1,6+dcil+1+scil); # scid\n"
                        },
                        {
                            "line": 773,
                            "file": "quic_shim.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 774,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 775,
                            "file": "quic_shim.ivy",
                            "instruction": "    #  When an Initial packet is sent by a client that has not previously\n"
                        },
                        {
                            "line": 776,
                            "file": "quic_shim.ivy",
                            "instruction": "    #    received an Initial or Retry packet from the server, the client\n"
                        },
                        {
                            "line": 777,
                            "file": "quic_shim.ivy",
                            "instruction": "    #    populates the Destination Connection ID field with an unpredictable\n"
                        },
                        {
                            "line": 778,
                            "file": "quic_shim.ivy",
                            "instruction": "    #    value.  This Destination Connection ID MUST be at least 8 bytes in\n"
                        },
                        {
                            "line": 779,
                            "file": "quic_shim.ivy",
                            "instruction": "    #    length\n"
                        },
                        {
                            "line": 780,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 781,
                            "file": "quic_shim.ivy",
                            "instruction": "    require dcil >= 8;\n"
                        },
                        {
                            "line": 782,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 783,
                            "file": "quic_shim.ivy",
                            "instruction": "    client_initial_dcid := bytes_to_cid(ikm);\n"
                        },
                        {
                            "line": 784,
                            "file": "quic_shim.ivy",
                            "instruction": "    client_initial_scid := bytes_to_cid(skm); # skm\n"
                        },
                        {
                            "line": 785,
                            "file": "quic_shim.ivy",
                            "instruction": "    call export_length_cid_extension(scil,dcil);\n"
                        },
                        {
                            "line": 786,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 787,
                            "file": "quic_shim.ivy",
                            "instruction": "    var pkt := pkt_serdes_0rtt.from_bytes(spkt);\n"
                        },
                        {
                            "line": 788,
                            "file": "quic_shim.ivy",
                            "instruction": "    pkt.ptype := quic_packet_type.zero_rtt;\n"
                        },
                        {
                            "line": 789,
                            "file": "quic_shim.ivy",
                            "instruction": "    call recv_0rtt_pkt(src,dst,pkt);\n"
                        },
                        {
                            "line": 790,
                            "file": "quic_shim.ivy",
                            "instruction": "    call infer_tls_events_0rtt(src,dst,pkt);\n"
                        },
                        {
                            "line": 791,
                            "file": "quic_shim.ivy",
                            "instruction": "    #conn_enc_level(src,scid) := quic_packet_type.initial;\n"
                        },
                        {
                            "line": 792,
                            "file": "quic_shim.ivy",
                            "instruction": "    call packet_event_0rtt(src,dst,pkt);       # also an inferred event\n"
                        }
                    ],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "ppkt",
                        "type": "stream_data"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "client.set_ep",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "export_length_cid_extension",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "recv_0rtt_pkt",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "infer_tls_events_0rtt",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "packet_event_0rtt",
                        "component": "quic_shim.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 87,
                "action_name": "tls_client_initial_request",
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [
                        {
                            "line": 371,
                            "file": "quic_shim.ivy",
                            "instruction": "    client_initial_scil := scid_size_pos(false);\n"
                        },
                        {
                            "line": 372,
                            "file": "quic_shim.ivy",
                            "instruction": "    var ikm := cid_to_bytes(nonce,dcid_size_cl(retry_response(the_cid))); \n"
                        },
                        {
                            "line": 373,
                            "file": "quic_shim.ivy",
                            "instruction": "    # call show_set_initial_keys(ikm);\n"
                        },
                        {
                            "line": 374,
                            "file": "quic_shim.ivy",
                            "instruction": "    # call show_version(pversion);\n"
                        },
                        {
                            "line": 375,
                            "file": "quic_shim.ivy",
                            "instruction": "    var salt : stream_data := stream_data.empty;\n"
                        },
                        {
                            "line": 376,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 377,
                            "file": "quic_shim.ivy",
                            "instruction": "    #0xc3 0xee 0xf7 0x12 0xc7 0x2e 0xbb 0x5a 0x11 0xa7 0xd2 0x43 0x2b 0xb4 0x63 0x65 0xbe 0xf9 0xf5 0x02 QUIC-27\n"
                        },
                        {
                            "line": 378,
                            "file": "quic_shim.ivy",
                            "instruction": "\tif pversion = 0xfaceb002 | pversion = 0xff00001b  | pversion = 0xff00001c {\n"
                        },
                        {
                            "line": 379,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xc3);\n"
                        },
                        {
                            "line": 380,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xee);\n"
                        },
                        {
                            "line": 381,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xf7);\n"
                        },
                        {
                            "line": 382,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x12);\n"
                        },
                        {
                            "line": 383,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xc7);\n"
                        },
                        {
                            "line": 384,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x2e);\n"
                        },
                        {
                            "line": 385,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xbb);\n"
                        },
                        {
                            "line": 386,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x5a);\n"
                        },
                        {
                            "line": 387,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x11);\n"
                        },
                        {
                            "line": 388,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xa7);\n"
                        },
                        {
                            "line": 389,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xd2);\n"
                        },
                        {
                            "line": 390,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x43);\n"
                        },
                        {
                            "line": 391,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x2b);\n"
                        },
                        {
                            "line": 392,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xb4);\n"
                        },
                        {
                            "line": 393,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x63);\n"
                        },
                        {
                            "line": 394,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x65);\n"
                        },
                        {
                            "line": 395,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xbe);\n"
                        },
                        {
                            "line": 396,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xf9);\n"
                        },
                        {
                            "line": 397,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xf5);\n"
                        },
                        {
                            "line": 398,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x02);\n"
                        },
                        {
                            "line": 399,
                            "file": "quic_shim.ivy",
                            "instruction": "\t}\n"
                        },
                        {
                            "line": 400,
                            "file": "quic_shim.ivy",
                            "instruction": "    #0xaf bf ec 28 99 93 d2 4c 9e 97 86 f1 9c 61 11 e0 43 90 a8 99 QUIC-29\n"
                        },
                        {
                            "line": 401,
                            "file": "quic_shim.ivy",
                            "instruction": "\telse if pversion = 0xff00001d {\n"
                        },
                        {
                            "line": 402,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xaf);\n"
                        },
                        {
                            "line": 403,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xbf);\n"
                        },
                        {
                            "line": 404,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xec);\n"
                        },
                        {
                            "line": 405,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x28);\n"
                        },
                        {
                            "line": 406,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x99);\n"
                        },
                        {
                            "line": 407,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x93);\n"
                        },
                        {
                            "line": 408,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xd2);\n"
                        },
                        {
                            "line": 409,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x4c);\n"
                        },
                        {
                            "line": 410,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x9e);\n"
                        },
                        {
                            "line": 411,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x97);\n"
                        },
                        {
                            "line": 412,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x86);\n"
                        },
                        {
                            "line": 413,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xf1);\n"
                        },
                        {
                            "line": 414,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x9c);\n"
                        },
                        {
                            "line": 415,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x61);\n"
                        },
                        {
                            "line": 416,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x11);\n"
                        },
                        {
                            "line": 417,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xe0);\n"
                        },
                        {
                            "line": 418,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x43);\n"
                        },
                        {
                            "line": 419,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x90);\n"
                        },
                        {
                            "line": 420,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xa8);\n"
                        },
                        {
                            "line": 421,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x99);\n"
                        },
                        {
                            "line": 422,
                            "file": "quic_shim.ivy",
                            "instruction": "\t}\n"
                        },
                        {
                            "line": 423,
                            "file": "quic_shim.ivy",
                            "instruction": "    # 0x38 0x76 0x2c 0xf7 0xf5 0x59 0x34 0xb3 0x4d 0x17 0x9a 0xe6 0xa4 0xc8 0x0c 0xad 0xcc 0xbb 0x7f 0x0a\n"
                        },
                        {
                            "line": 424,
                            "file": "quic_shim.ivy",
                            "instruction": "    else if pversion = 0x00000001 | pversion = 0xff000022 {\n"
                        },
                        {
                            "line": 425,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x38);\n"
                        },
                        {
                            "line": 426,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x76);\n"
                        },
                        {
                            "line": 427,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x2c);\n"
                        },
                        {
                            "line": 428,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xf7);\n"
                        },
                        {
                            "line": 429,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xf5);\n"
                        },
                        {
                            "line": 430,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x59);\n"
                        },
                        {
                            "line": 431,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x34);\n"
                        },
                        {
                            "line": 432,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xb3);\n"
                        },
                        {
                            "line": 433,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x4d);\n"
                        },
                        {
                            "line": 434,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x17);\n"
                        },
                        {
                            "line": 435,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x9a);\n"
                        },
                        {
                            "line": 436,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xe6);\n"
                        },
                        {
                            "line": 437,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xa4);\n"
                        },
                        {
                            "line": 438,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xc8);\n"
                        },
                        {
                            "line": 439,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x0c);\n"
                        },
                        {
                            "line": 440,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xad);\n"
                        },
                        {
                            "line": 441,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xcc);\n"
                        },
                        {
                            "line": 442,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0xbb);\n"
                        },
                        {
                            "line": 443,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x7f);\n"
                        },
                        {
                            "line": 444,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tsalt := salt.append(0x0a);\n"
                        },
                        {
                            "line": 445,
                            "file": "quic_shim.ivy",
                            "instruction": "\t};\n"
                        },
                        {
                            "line": 446,
                            "file": "quic_shim.ivy",
                            "instruction": "    call tls_api.upper.set_initial_keys(id,salt,ikm);\n"
                        }
                    ],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "nonce",
                        "type": "cid"
                    },
                    {
                        "name": "pversion",
                        "type": "version"
                    },
                    {
                        "name": "id",
                        "type": "tls_api.id"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "tls_client_initial_request",
                        "component": "quic_packet.ivy"
                    },
                    {
                        "caller_func": "tls_client_initial_request",
                        "component": "quic_packet.ivy"
                    },
                    {
                        "caller_func": "tls_api.upper.set_initial_keys",
                        "component": "quic_shim.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 100,
                "action_name": "tls_client_initial_response",
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [
                        {
                            "line": 465,
                            "file": "quic_shim.ivy",
                            "instruction": "    \n"
                        },
                        {
                            "line": 466,
                            "file": "quic_shim.ivy",
                            "instruction": "    if nclients > 1 {\n"
                        },
                        {
                            "line": 467,
                            "file": "quic_shim.ivy",
                            "instruction": "        var cdx := clients.clients.begin;\n"
                        },
                        {
                            "line": 468,
                            "file": "quic_shim.ivy",
                            "instruction": "        while cdx < clients.clients.end {\n"
                        },
                        {
                            "line": 469,
                            "file": "quic_shim.ivy",
                            "instruction": "            var cc := clients.clients.value(cdx);\n"
                        },
                        {
                            "line": 470,
                            "file": "quic_shim.ivy",
                            "instruction": "            # call cc.set_ep(src);\n"
                        },
                        {
                            "line": 471,
                            "file": "quic_shim.ivy",
                            "instruction": "            # cc.ep := src;\n"
                        },
                        {
                            "line": 472,
                            "file": "quic_shim.ivy",
                            "instruction": "            # if some(cf:endpoint) cc *> cf {\n"
                        },
                        {
                            "line": 473,
                            "file": "quic_shim.ivy",
                            "instruction": "            #     cf.set_ep(src); # TODO: migration?\n"
                        },
                        {
                            "line": 474,
                            "file": "quic_shim.ivy",
                            "instruction": "            # }\n"
                        },
                        {
                            "line": 475,
                            "file": "quic_shim.ivy",
                            "instruction": "            cdx := cdx.next;\n"
                        },
                        {
                            "line": 476,
                            "file": "quic_shim.ivy",
                            "instruction": "        }\n"
                        },
                        {
                            "line": 477,
                            "file": "quic_shim.ivy",
                            "instruction": "    } else {\n"
                        },
                        {
                            "line": 478,
                            "file": "quic_shim.ivy",
                            "instruction": "        # client.set_ep(src); # TODO: migration?\n"
                        },
                        {
                            "line": 479,
                            "file": "quic_shim.ivy",
                            "instruction": "        #if ~endpoint_to_pid(src) = endpoint_id.mim {\n"
                        },
                        {
                            "line": 480,
                            "file": "quic_shim.ivy",
                            "instruction": "        call client.set_ep(src);\n"
                        },
                        {
                            "line": 481,
                            "file": "quic_shim.ivy",
                            "instruction": "        #client.ep.interface := ip.lo;\n"
                        },
                        {
                            "line": 482,
                            "file": "quic_shim.ivy",
                            "instruction": "        #}\n"
                        },
                        {
                            "line": 483,
                            "file": "quic_shim.ivy",
                            "instruction": "    }\n"
                        },
                        {
                            "line": 484,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 485,
                            "file": "quic_shim.ivy",
                            "instruction": "    # call show_kk;\n"
                        },
                        {
                            "line": 486,
                            "file": "quic_shim.ivy",
                            "instruction": "    \n"
                        },
                        {
                            "line": 487,
                            "file": "quic_shim.ivy",
                            "instruction": "\tvar version := bytes_to_version(spkt.segment(1,5));\n"
                        },
                        {
                            "line": 488,
                            "file": "quic_shim.ivy",
                            "instruction": "    var lens := spkt.value(5);\n"
                        },
                        {
                            "line": 489,
                            "file": "quic_shim.ivy",
                            "instruction": "    var dcil : stream_pos := bfe[0][7](spkt.value(5));\n"
                        },
                        {
                            "line": 490,
                            "file": "quic_shim.ivy",
                            "instruction": "    var ikm := cid_to_bytes(0,1); # dcid\n"
                        },
                        {
                            "line": 491,
                            "file": "quic_shim.ivy",
                            "instruction": "\tif(~dcil = 0) {\n"
                        },
                        {
                            "line": 492,
                            "file": "quic_shim.ivy",
                            "instruction": "        client_initial_dcil := dcil;\n"
                        },
                        {
                            "line": 493,
                            "file": "quic_shim.ivy",
                            "instruction": "\t    ikm := spkt.segment(6,6+dcil); # dcid\n"
                        },
                        {
                            "line": 494,
                            "file": "quic_shim.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 495,
                            "file": "quic_shim.ivy",
                            "instruction": "    var dcid : cid := bytes_to_cid(ikm);\n"
                        },
                        {
                            "line": 496,
                            "file": "quic_shim.ivy",
                            "instruction": "    var scil : stream_pos := bfe[0][7](spkt.value(6+dcil));\n"
                        },
                        {
                            "line": 497,
                            "file": "quic_shim.ivy",
                            "instruction": "    var skm := cid_to_bytes(0,1); # scid\n"
                        },
                        {
                            "line": 498,
                            "file": "quic_shim.ivy",
                            "instruction": "    if(~scil = 0) {\n"
                        },
                        {
                            "line": 499,
                            "file": "quic_shim.ivy",
                            "instruction": "        client_initial_scil := scil;\n"
                        },
                        {
                            "line": 500,
                            "file": "quic_shim.ivy",
                            "instruction": "\t\tclient_non_zero_scil := true;\t\n"
                        },
                        {
                            "line": 501,
                            "file": "quic_shim.ivy",
                            "instruction": "\t    skm := spkt.segment(6+dcil+1,6+dcil+1+scil); # scid\n"
                        },
                        {
                            "line": 502,
                            "file": "quic_shim.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 503,
                            "file": "quic_shim.ivy",
                            "instruction": "    var scid : cid := bytes_to_cid(skm);\n"
                        },
                        {
                            "line": 504,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 505,
                            "file": "quic_shim.ivy",
                            "instruction": "    if scil = 0 | dcil = 0 {\n"
                        },
                        {
                            "line": 506,
                            "file": "quic_shim.ivy",
                            "instruction": "        issued_zero_length_cid := true;\n"
                        },
                        {
                            "line": 507,
                            "file": "quic_shim.ivy",
                            "instruction": "    }\n"
                        },
                        {
                            "line": 508,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 509,
                            "file": "quic_shim.ivy",
                            "instruction": "    #  When an Initial packet is sent by a client that has not previously\n"
                        },
                        {
                            "line": 510,
                            "file": "quic_shim.ivy",
                            "instruction": "    #    received an Initial or Retry packet from the server, the client\n"
                        },
                        {
                            "line": 511,
                            "file": "quic_shim.ivy",
                            "instruction": "    #    populates the Destination Connection ID field with an unpredictable\n"
                        },
                        {
                            "line": 512,
                            "file": "quic_shim.ivy",
                            "instruction": "    #    value.  This Destination Connection ID MUST be at least 8 bytes in\n"
                        },
                        {
                            "line": 513,
                            "file": "quic_shim.ivy",
                            "instruction": "    #    length\n"
                        },
                        {
                            "line": 514,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 515,
                            "file": "quic_shim.ivy",
                            "instruction": "    require dcil >= 8;\n"
                        },
                        {
                            "line": 516,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 517,
                            "file": "quic_shim.ivy",
                            "instruction": "    if ~retry_sent(dcid) {\n"
                        },
                        {
                            "line": 518,
                            "file": "quic_shim.ivy",
                            "instruction": "        client_initial_dcid := dcid;\n"
                        },
                        {
                            "line": 519,
                            "file": "quic_shim.ivy",
                            "instruction": "        client_initial_scid := scid; # skm\n"
                        },
                        {
                            "line": 520,
                            "file": "quic_shim.ivy",
                            "instruction": "        call export_length_cid_extension(dcil,scil);\n"
                        },
                        {
                            "line": 521,
                            "file": "quic_shim.ivy",
                            "instruction": "        call export_length_cid(dcil,scil);\n"
                        },
                        {
                            "line": 522,
                            "file": "quic_shim.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 523,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 524,
                            "file": "quic_shim.ivy",
                            "instruction": "    if ~tp_client_set | negocation_of_version(src) {\n"
                        },
                        {
                            "line": 525,
                            "file": "quic_shim.ivy",
                            "instruction": "        var extns := tls_extensions.empty;\n"
                        },
                        {
                            "line": 526,
                            "file": "quic_shim.ivy",
                            "instruction": "        extns := extns.append(make_transport_parameters);\n"
                        },
                        {
                            "line": 527,
                            "file": "quic_shim.ivy",
                            "instruction": "        if zero_rtt_client_test {\n"
                        },
                        {
                            "line": 528,
                            "file": "quic_shim.ivy",
                            "instruction": "            call tls_api.upper.create_0rtt_client(0,true,extns);  \n"
                        },
                        {
                            "line": 529,
                            "file": "quic_shim.ivy",
                            "instruction": "        } else {\n"
                        },
                        {
                            "line": 530,
                            "file": "quic_shim.ivy",
                            "instruction": "            call tls_api.upper.create(0,true,extns);  \n"
                        },
                        {
                            "line": 531,
                            "file": "quic_shim.ivy",
                            "instruction": "        }\n"
                        },
                        {
                            "line": 532,
                            "file": "quic_shim.ivy",
                            "instruction": "        # 'true' means this instance of tls is a server\n"
                        },
                        {
                            "line": 533,
                            "file": "quic_shim.ivy",
                            "instruction": "        tp_client_set := true;\n"
                        },
                        {
                            "line": 534,
                            "file": "quic_shim.ivy",
                            "instruction": "\t}; \n"
                        },
                        {
                            "line": 535,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 536,
                            "file": "quic_shim.ivy",
                            "instruction": "    client_initial_version := version;\n"
                        },
                        {
                            "line": 537,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 538,
                            "file": "quic_shim.ivy",
                            "instruction": "    if client_initial_version ~= initial_version & client_initial_version ~= 0xfaceb002 { #initial_version todo\n"
                        },
                        {
                            "line": 539,
                            "file": "quic_shim.ivy",
                            "instruction": "        negocation_of_version(src) := true;\n"
                        },
                        {
                            "line": 540,
                            "file": "quic_shim.ivy",
                            "instruction": "    } \n"
                        },
                        {
                            "line": 541,
                            "file": "quic_shim.ivy",
                            "instruction": "    else if (~initial_keys_set(dcid) & retry_client_test -> retry_sent(dcid)) | negocation_of_version(src) { \n"
                        },
                        {
                            "line": 542,
                            "file": "quic_shim.ivy",
                            "instruction": "        call export_length_cid_extension(dcil,scil);\n"
                        },
                        {
                            "line": 543,
                            "file": "quic_shim.ivy",
                            "instruction": "        negocation_of_version(src) := false;\n"
                        },
                        {
                            "line": 544,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 545,
                            "file": "quic_shim.ivy",
                            "instruction": "        var salt : stream_data := stream_data.empty;\n"
                        },
                        {
                            "line": 546,
                            "file": "quic_shim.ivy",
                            "instruction": "        \n"
                        },
                        {
                            "line": 547,
                            "file": "quic_shim.ivy",
                            "instruction": "        #0xc3 ee f7 12 c7 2e bb 5a 11 a7 d2 43 2b b4 63 65 be f9 f5 02 QUIC-27\n"
                        },
                        {
                            "line": 548,
                            "file": "quic_shim.ivy",
                            "instruction": "\t    if client_initial_version = 0xfaceb002  \n"
                        },
                        {
                            "line": 549,
                            "file": "quic_shim.ivy",
                            "instruction": "         | client_initial_version = 0xff00001b \n"
                        },
                        {
                            "line": 550,
                            "file": "quic_shim.ivy",
                            "instruction": "         | client_initial_version = 0xff00001c {\n"
                        },
                        {
                            "line": 551,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xc3);\n"
                        },
                        {
                            "line": 552,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xee);\n"
                        },
                        {
                            "line": 553,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xf7);\n"
                        },
                        {
                            "line": 554,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x12);\n"
                        },
                        {
                            "line": 555,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xc7);\n"
                        },
                        {
                            "line": 556,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x2e);\n"
                        },
                        {
                            "line": 557,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xbb);\n"
                        },
                        {
                            "line": 558,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x5a);\n"
                        },
                        {
                            "line": 559,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x11);\n"
                        },
                        {
                            "line": 560,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xa7);\n"
                        },
                        {
                            "line": 561,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xd2);\n"
                        },
                        {
                            "line": 562,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x43);\n"
                        },
                        {
                            "line": 563,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x2b);\n"
                        },
                        {
                            "line": 564,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xb4);\n"
                        },
                        {
                            "line": 565,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x63);\n"
                        },
                        {
                            "line": 566,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x65);\n"
                        },
                        {
                            "line": 567,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xbe);\n"
                        },
                        {
                            "line": 568,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xf9);\n"
                        },
                        {
                            "line": 569,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xf5);\n"
                        },
                        {
                            "line": 570,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x02);\n"
                        },
                        {
                            "line": 571,
                            "file": "quic_shim.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 572,
                            "file": "quic_shim.ivy",
                            "instruction": "        #0xaf bf ec 28 99 93 d2 4c 9e 97 86 f1 9c 61 11 e0 43 90 a8 99 QUIC-29\n"
                        },
                        {
                            "line": 573,
                            "file": "quic_shim.ivy",
                            "instruction": "        if client_initial_version = 0xff00001d  {\n"
                        },
                        {
                            "line": 574,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xaf);\n"
                        },
                        {
                            "line": 575,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xbf);\n"
                        },
                        {
                            "line": 576,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xec);\n"
                        },
                        {
                            "line": 577,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x28);\n"
                        },
                        {
                            "line": 578,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x99);\n"
                        },
                        {
                            "line": 579,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x93);\n"
                        },
                        {
                            "line": 580,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xd2);\n"
                        },
                        {
                            "line": 581,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x4c);\n"
                        },
                        {
                            "line": 582,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x9e);\n"
                        },
                        {
                            "line": 583,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x97);\n"
                        },
                        {
                            "line": 584,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x86);\n"
                        },
                        {
                            "line": 585,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xf1);\n"
                        },
                        {
                            "line": 586,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x9c);\n"
                        },
                        {
                            "line": 587,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x61);\n"
                        },
                        {
                            "line": 588,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x11);\n"
                        },
                        {
                            "line": 589,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xe0);\n"
                        },
                        {
                            "line": 590,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x43);\n"
                        },
                        {
                            "line": 591,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x90);\n"
                        },
                        {
                            "line": 592,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xa8);\n"
                        },
                        {
                            "line": 593,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x99);\n"
                        },
                        {
                            "line": 594,
                            "file": "quic_shim.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 595,
                            "file": "quic_shim.ivy",
                            "instruction": "        if client_initial_version = 0x00000001 | client_initial_version = 0xff000022 {\n"
                        },
                        {
                            "line": 596,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x38);\n"
                        },
                        {
                            "line": 597,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x76);\n"
                        },
                        {
                            "line": 598,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x2c);\n"
                        },
                        {
                            "line": 599,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xf7);\n"
                        },
                        {
                            "line": 600,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xf5);\n"
                        },
                        {
                            "line": 601,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x59);\n"
                        },
                        {
                            "line": 602,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x34);\n"
                        },
                        {
                            "line": 603,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xb3);\n"
                        },
                        {
                            "line": 604,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x4d);\n"
                        },
                        {
                            "line": 605,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x17);\n"
                        },
                        {
                            "line": 606,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x9a);\n"
                        },
                        {
                            "line": 607,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xe6);\n"
                        },
                        {
                            "line": 608,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xa4);\n"
                        },
                        {
                            "line": 609,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xc8);\n"
                        },
                        {
                            "line": 610,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x0c);\n"
                        },
                        {
                            "line": 611,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xad);\n"
                        },
                        {
                            "line": 612,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xcc);\n"
                        },
                        {
                            "line": 613,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0xbb);\n"
                        },
                        {
                            "line": 614,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x7f);\n"
                        },
                        {
                            "line": 615,
                            "file": "quic_shim.ivy",
                            "instruction": "            salt := salt.append(0x0a);\n"
                        },
                        {
                            "line": 616,
                            "file": "quic_shim.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 617,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 618,
                            "file": "quic_shim.ivy",
                            "instruction": "        call show_set_initial_keys(ikm);\n"
                        },
                        {
                            "line": 619,
                            "file": "quic_shim.ivy",
                            "instruction": "        call tls_api.upper.set_initial_keys(0,salt,ikm);\n"
                        },
                        {
                            "line": 620,
                            "file": "quic_shim.ivy",
                            "instruction": "        \n"
                        },
                        {
                            "line": 621,
                            "file": "quic_shim.ivy",
                            "instruction": "        initial_keys_set(dcid) := true;\n"
                        },
                        {
                            "line": 622,
                            "file": "quic_shim.ivy",
                            "instruction": "    }\n"
                        }
                    ],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "ppkt",
                        "type": "stream_data"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "client.set_ep",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "export_length_cid_extension",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "export_length_cid",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "tls_api.upper.create_0rtt_client",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "tls_api.upper.create",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "export_length_cid_extension",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "show_set_initial_keys",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "tls_api.upper.set_initial_keys",
                        "component": "quic_shim.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 144,
                "action_name": "tls_client_retry_response",
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [
                        {
                            "line": 721,
                            "file": "quic_shim.ivy",
                            "instruction": "    header_retry := bfe[0][7](spkt.value(0));\n"
                        },
                        {
                            "line": 722,
                            "file": "quic_shim.ivy",
                            "instruction": "    var dcil : stream_pos := bfe[0][7](spkt.value(5));\n"
                        },
                        {
                            "line": 723,
                            "file": "quic_shim.ivy",
                            "instruction": "    var dcid := prot.bytes_to_cid(spkt.segment(6,6+dcil));\n"
                        },
                        {
                            "line": 724,
                            "file": "quic_shim.ivy",
                            "instruction": "    var scil : stream_pos := bfe[0][7](spkt.value(6+dcil));\n"
                        },
                        {
                            "line": 725,
                            "file": "quic_shim.ivy",
                            "instruction": "    var scid := prot.bytes_to_cid(spkt.segment(7+dcil,7+dcil+scil));\n"
                        },
                        {
                            "line": 726,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 727,
                            "file": "quic_shim.ivy",
                            "instruction": "    call export_length_cid_extension(scil,dcil);\n"
                        },
                        {
                            "line": 728,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 729,
                            "file": "quic_shim.ivy",
                            "instruction": "    var pkt := pkt_serdes_retry.from_bytes(spkt);\n"
                        },
                        {
                            "line": 730,
                            "file": "quic_shim.ivy",
                            "instruction": "    pkt.ptype := quic_packet_type.retry;\n"
                        },
                        {
                            "line": 731,
                            "file": "quic_shim.ivy",
                            "instruction": "    call recv_retry_pkt(src,dst,pkt);\n"
                        },
                        {
                            "line": 732,
                            "file": "quic_shim.ivy",
                            "instruction": "    call infer_tls_events_retry(src,dst,pkt);\n"
                        },
                        {
                            "line": 733,
                            "file": "quic_shim.ivy",
                            "instruction": "    retry_token(dcid) := pkt.token;\n"
                        },
                        {
                            "line": 734,
                            "file": "quic_shim.ivy",
                            "instruction": "    if pkt.token.end = 0 {\n"
                        },
                        {
                            "line": 735,
                            "file": "quic_shim.ivy",
                            "instruction": "        zero_length_token := true;\n"
                        },
                        {
                            "line": 736,
                            "file": "quic_shim.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 737,
                            "file": "quic_shim.ivy",
                            "instruction": "    retry_response(dcid) := true;\n"
                        },
                        {
                            "line": 738,
                            "file": "quic_shim.ivy",
                            "instruction": "    call packet_event_retry(src,dst,pkt);       # also an inferred event\n"
                        }
                    ],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "ppkt",
                        "type": "stream_data"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "export_length_cid_extension",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "recv_retry_pkt",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "infer_tls_events_retry",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "packet_event_retry",
                        "component": "quic_shim.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 131,
                "action_name": "tls_client_version_response",
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [
                        {
                            "line": 657,
                            "file": "quic_shim.ivy",
                            "instruction": "    var tls_id := src_tls_id(src);\n"
                        },
                        {
                            "line": 658,
                            "file": "quic_shim.ivy",
                            "instruction": "    var dcil : stream_pos := bfe[0][7](spkt.value(5));\n"
                        },
                        {
                            "line": 659,
                            "file": "quic_shim.ivy",
                            "instruction": "    var dcid := prot.bytes_to_cid(spkt.segment(6,6+dcil));\n"
                        },
                        {
                            "line": 660,
                            "file": "quic_shim.ivy",
                            "instruction": "    var scil : stream_pos := bfe[0][7](spkt.value(6+dcil));\n"
                        },
                        {
                            "line": 661,
                            "file": "quic_shim.ivy",
                            "instruction": "    var scid := prot.bytes_to_cid(spkt.segment(7+dcil,7+dcil+scil));\n"
                        },
                        {
                            "line": 662,
                            "file": "quic_shim.ivy",
                            "instruction": "    var versions_vn := spkt.segment(3 +  4  + dcil + scil,spkt.end);\n"
                        },
                        {
                            "line": 663,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 664,
                            "file": "quic_shim.ivy",
                            "instruction": "    call export_length_cid_extension(dcil,scil);\n"
                        },
                        {
                            "line": 665,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 666,
                            "file": "quic_shim.ivy",
                            "instruction": "    if version_not_found(src) {\n"
                        },
                        {
                            "line": 667,
                            "file": "quic_shim.ivy",
                            "instruction": "        versions_vn := spkt.segment(0,spkt.end);\n"
                        },
                        {
                            "line": 668,
                            "file": "quic_shim.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 669,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 670,
                            "file": "quic_shim.ivy",
                            "instruction": "    var sv := versions.empty;\n"
                        },
                        {
                            "line": 671,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 672,
                            "file": "quic_shim.ivy",
                            "instruction": "    var idx := versions_vn.begin;\n"
                        },
                        {
                            "line": 673,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 674,
                            "file": "quic_shim.ivy",
                            "instruction": "    while (~versions_vn.value(idx) =  0xff | ~versions_vn.value(idx) =  0x00) &  version_not_found(src) {\n"
                        },
                        {
                            "line": 675,
                            "file": "quic_shim.ivy",
                            "instruction": "        idx := idx.next;\n"
                        },
                        {
                            "line": 676,
                            "file": "quic_shim.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 677,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 678,
                            "file": "quic_shim.ivy",
                            "instruction": "    while idx < versions_vn.end {\n"
                        },
                        {
                            "line": 679,
                            "file": "quic_shim.ivy",
                            "instruction": "        var i : stream_pos := 0;\n"
                        },
                        {
                            "line": 680,
                            "file": "quic_shim.ivy",
                            "instruction": "        var v := stream_data.empty;\n"
                        },
                        {
                            "line": 681,
                            "file": "quic_shim.ivy",
                            "instruction": "        while i < 4 {\n"
                        },
                        {
                            "line": 682,
                            "file": "quic_shim.ivy",
                            "instruction": "            v := v.append(versions_vn.value(idx));\n"
                        },
                        {
                            "line": 683,
                            "file": "quic_shim.ivy",
                            "instruction": "            i := i + 1;\n"
                        },
                        {
                            "line": 684,
                            "file": "quic_shim.ivy",
                            "instruction": "            idx := idx.next;\n"
                        },
                        {
                            "line": 685,
                            "file": "quic_shim.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 686,
                            "file": "quic_shim.ivy",
                            "instruction": "        sv := sv.append(v);\n"
                        },
                        {
                            "line": 687,
                            "file": "quic_shim.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 688,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 689,
                            "file": "quic_shim.ivy",
                            "instruction": "    var idxx : index := 0;\n"
                        },
                        {
                            "line": 690,
                            "file": "quic_shim.ivy",
                            "instruction": "    var idxx_bv : index := 0;\n"
                        },
                        {
                            "line": 691,
                            "file": "quic_shim.ivy",
                            "instruction": "    while idxx < sv.end {\n"
                        },
                        {
                            "line": 692,
                            "file": "quic_shim.ivy",
                            "instruction": "        var ii : index := 0 ;\n"
                        },
                        {
                            "line": 693,
                            "file": "quic_shim.ivy",
                            "instruction": "        while ii < supported_versions.end {\n"
                        },
                        {
                            "line": 694,
                            "file": "quic_shim.ivy",
                            "instruction": "            if sv.value(idxx) = supported_versions.value(ii) {\n"
                        },
                        {
                            "line": 695,
                            "file": "quic_shim.ivy",
                            "instruction": "                #call recv_vn_packet_nn(src,dst,spkt);\n"
                        },
                        {
                            "line": 696,
                            "file": "quic_shim.ivy",
                            "instruction": "                #take the most recent supported version\n"
                        },
                        {
                            "line": 697,
                            "file": "quic_shim.ivy",
                            "instruction": "                final_version := supported_versions_bv.value(idxx_bv);\n"
                        },
                        {
                            "line": 698,
                            "file": "quic_shim.ivy",
                            "instruction": "                idxx_bv := idxx_bv.next;\n"
                        },
                        {
                            "line": 699,
                            "file": "quic_shim.ivy",
                            "instruction": "            };\n"
                        },
                        {
                            "line": 700,
                            "file": "quic_shim.ivy",
                            "instruction": "            ii := ii.next;\n"
                        },
                        {
                            "line": 701,
                            "file": "quic_shim.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 702,
                            "file": "quic_shim.ivy",
                            "instruction": "        idxx := idxx.next;\n"
                        },
                        {
                            "line": 703,
                            "file": "quic_shim.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 704,
                            "file": "quic_shim.ivy",
                            "instruction": "\n"
                        },
                        {
                            "line": 705,
                            "file": "quic_shim.ivy",
                            "instruction": "    if final_version ~= 0x00000000 {\n"
                        },
                        {
                            "line": 706,
                            "file": "quic_shim.ivy",
                            "instruction": "        version_negociated := true;\n"
                        },
                        {
                            "line": 707,
                            "file": "quic_shim.ivy",
                            "instruction": "        var pkt := pkt_serdes_vn.from_bytes(spkt);\n"
                        },
                        {
                            "line": 708,
                            "file": "quic_shim.ivy",
                            "instruction": "        pkt.ptype := quic_packet_type.version_negociation; # no real type so hardcode\n"
                        },
                        {
                            "line": 709,
                            "file": "quic_shim.ivy",
                            "instruction": "        call recv_vn_pkt(src,dst,pkt);\n"
                        },
                        {
                            "line": 710,
                            "file": "quic_shim.ivy",
                            "instruction": "        call infer_tls_events_vn(src,dst,pkt);\n"
                        },
                        {
                            "line": 711,
                            "file": "quic_shim.ivy",
                            "instruction": "        call packet_event_vn(src,dst,pkt);       # also an inferred event\n"
                        },
                        {
                            "line": 712,
                            "file": "quic_shim.ivy",
                            "instruction": "    } else {\n"
                        },
                        {
                            "line": 713,
                            "file": "quic_shim.ivy",
                            "instruction": "        version_not_found(src) := true;\n"
                        },
                        {
                            "line": 714,
                            "file": "quic_shim.ivy",
                            "instruction": "        call version_not_found_event;\n"
                        },
                        {
                            "line": 715,
                            "file": "quic_shim.ivy",
                            "instruction": "    };\n"
                        }
                    ],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "ppkt",
                        "type": "stream_data"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "export_length_cid_extension",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "recv_vn_pkt",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "infer_tls_events_vn",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "packet_event_vn",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "version_not_found_event;",
                        "component": "quic_shim.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 69,
                "action_name": "tls_keys_established_event",
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [
                        {
                            "line": 340,
                            "file": "quic_security.ivy",
                            "instruction": "    call show_tls_keys_established_event(scid,e);\n"
                        },
                        {
                            "line": 341,
                            "file": "quic_security.ivy",
                            "instruction": "    if e = quic_packet_type.zero_rtt {\n"
                        },
                        {
                            "line": 342,
                            "file": "quic_security.ivy",
                            "instruction": "        established_0rtt_keys(scid) := true\n"
                        },
                        {
                            "line": 343,
                            "file": "quic_security.ivy",
                            "instruction": "    } else if e = quic_packet_type.handshake {\n"
                        },
                        {
                            "line": 344,
                            "file": "quic_security.ivy",
                            "instruction": "        established_handshake_keys(scid) := true\n"
                        },
                        {
                            "line": 345,
                            "file": "quic_security.ivy",
                            "instruction": "    } else if e = quic_packet_type.one_rtt {\n"
                        },
                        {
                            "line": 346,
                            "file": "quic_security.ivy",
                            "instruction": "        established_1rtt_keys(scid) := true\n"
                        },
                        {
                            "line": 347,
                            "file": "quic_security.ivy",
                            "instruction": "    } \n"
                        }
                    ],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "e",
                        "type": "quic_packet_type"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "tls_keys_established_event",
                        "component": "quic_infer.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "actions": {
                "line": 54,
                "action_name": "tls_recv_event",
                "implementation": [],
                "monitor": {
                    "before": [],
                    "after": [],
                    "around": [
                        {
                            "line": 320,
                            "file": "quic_security.ivy",
                            "instruction": "    require connected(dcid) & connected_to(dcid) = scid;  # [1]\n"
                        },
                        {
                            "line": 321,
                            "file": "quic_security.ivy",
                            "instruction": "    require lo < hi & lo = crypto_pos(dcid,e) & hi <= crypto_length(scid,e);  # [2]\n"
                        },
                        {
                            "line": 322,
                            "file": "quic_security.ivy",
                            "instruction": "    ... \n"
                        },
                        {
                            "line": 323,
                            "file": "quic_security.ivy",
                            "instruction": "    crypto_pos(dcid,e) := hi;  # [3]\n"
                        }
                    ]
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "dcid",
                        "type": "cid"
                    },
                    {
                        "name": "e",
                        "type": "quic_packet_type"
                    },
                    {
                        "name": "lo",
                        "type": "stream_pos"
                    },
                    {
                        "name": "hi",
                        "type": "stream_pos"
                    }
                ],
                "exported": true,
                "events": false,
                "called_from": [],
                "assertions_as_guarantees": {
                    "called_from": [],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [
                        {
                            "caller_func": "Environment",
                            "component": "Environment"
                        }
                    ],
                    "assertions": [
                        {
                            "line": 321,
                            "file": "quic_security.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;  # [1]\n"
                        },
                        {
                            "line": 322,
                            "file": "quic_security.ivy",
                            "assertion": "require lo < hi & lo = crypto_pos(dcid,e) & hi <= crypto_length(scid,e);  # [2]\n"
                        },
                        {
                            "line": 658,
                            "file": "quic_frame.ivy",
                            "assertion": "require connected(dcid) & connected_to(dcid) = scid;\n"
                        },
                        {
                            "line": 660,
                            "file": "quic_frame.ivy",
                            "assertion": "require ~(e = quic_packet_type.initial) & ~(e = quic_packet_type.handshake); #& ~(e = quic_packet_type.handshake)\n"
                        },
                        {
                            "line": 661,
                            "file": "quic_frame.ivy",
                            "assertion": "require ~conn_closed(scid);\n"
                        },
                        {
                            "line": 664,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.handshake -> established_handshake_keys(scid);  # [4]\n"
                        },
                        {
                            "line": 665,
                            "file": "quic_frame.ivy",
                            "assertion": "require e = quic_packet_type.one_rtt -> established_1rtt_keys(scid);  # [4]\n"
                        },
                        {
                            "line": 668,
                            "file": "quic_frame.ivy",
                            "assertion": "require ~(e = quic_packet_type.version_negociation) & ~(e = quic_packet_type.retry) & ~(e = quic_packet_type.zero_rtt);\n"
                        },
                        {
                            "line": 670,
                            "file": "quic_frame.ivy",
                            "assertion": "require num_queued_frames(scid) > 0 -> e = queued_level(scid);\n"
                        },
                        {
                            "line": 676,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.ack_ranges.end > 0;\n"
                        },
                        {
                            "line": 680,
                            "file": "quic_frame.ivy",
                            "assertion": "require idx > 0 -> ack_range.gap < last - 1;\n"
                        },
                        {
                            "line": 682,
                            "file": "quic_frame.ivy",
                            "assertion": "require ack_range.ranges <= upper;\n"
                        },
                        {
                            "line": 686,
                            "file": "quic_frame.ivy",
                            "assertion": "require sent_pkt(dcid,e,jdx);  # [1]\n"
                        },
                        {
                            "line": 700,
                            "file": "quic_frame.ivy",
                            "assertion": "require some_new_ack;\n"
                        },
                        {
                            "line": 701,
                            "file": "quic_frame.ivy",
                            "assertion": "require f.largest_acked = max_acked(dcid,e);\n"
                        },
                        {
                            "line": 274,
                            "file": "ivy_quic_client_behavior.ivy",
                            "assertion": "require scid = the_cid;\n"
                        }
                    ]
                }
            }
        },
        {
            "actions": {
                "line": 33,
                "action_name": "tls_send_event",
                "implementation": [],
                "monitor": {
                    "before": [
                        {
                            "line": 254,
                            "file": "quic_security.ivy",
                            "instruction": "    \n"
                        },
                        {
                            "line": 255,
                            "file": "quic_security.ivy",
                            "instruction": "    var jdx := data.begin;\n"
                        },
                        {
                            "line": 256,
                            "file": "quic_security.ivy",
                            "instruction": "    if retry_sent(scid) & ~crypto_reset(dcid) { # TODO retest\n"
                        },
                        {
                            "line": 257,
                            "file": "quic_security.ivy",
                            "instruction": "        call show_test;\n"
                        },
                        {
                            "line": 258,
                            "file": "quic_security.ivy",
                            "instruction": "        crypto_handler_pos(C,L) := 0;\n"
                        },
                        {
                            "line": 259,
                            "file": "quic_security.ivy",
                            "instruction": "        crypto_data(scid,e) := stream_data.empty;\n"
                        },
                        {
                            "line": 260,
                            "file": "quic_security.ivy",
                            "instruction": "        while jdx < data.end {\n"
                        },
                        {
                            "line": 261,
                            "file": "quic_security.ivy",
                            "instruction": "            var cpos := pos+jdx;\n"
                        },
                        {
                            "line": 262,
                            "file": "quic_security.ivy",
                            "instruction": "            crypto_data_present(scid,e,cpos) := false;\n"
                        },
                        {
                            "line": 263,
                            "file": "quic_security.ivy",
                            "instruction": "            jdx := jdx.next\n"
                        },
                        {
                            "line": 264,
                            "file": "quic_security.ivy",
                            "instruction": "        };\n"
                        },
                        {
                            "line": 265,
                            "file": "quic_security.ivy",
                            "instruction": "        crypto_reset(dcid) := true;\n"
                        },
                        {
                            "line": 266,
                            "file": "quic_security.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 267,
                            "file": "quic_security.ivy",
                            "instruction": "    var end := pos + data.end;\n"
                        },
                        {
                            "line": 268,
                            "file": "quic_security.ivy",
                            "instruction": "    if end > crypto_data(scid,e).end {\n"
                        },
                        {
                            "line": 269,
                            "file": "quic_security.ivy",
                            "instruction": "        crypto_data(scid,e) := crypto_data(scid,e).resize(end,0);\n"
                        },
                        {
                            "line": 270,
                            "file": "quic_security.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 271,
                            "file": "quic_security.ivy",
                            "instruction": "    jdx := data.begin;\n"
                        },
                        {
                            "line": 272,
                            "file": "quic_security.ivy",
                            "instruction": "    while jdx < data.end {\n"
                        },
                        {
                            "line": 273,
                            "file": "quic_security.ivy",
                            "instruction": "        var cpos := pos+jdx;\n"
                        },
                        {
                            "line": 274,
                            "file": "quic_security.ivy",
                            "instruction": "        var byte := data.value(jdx);\n"
                        },
                        {
                            "line": 275,
                            "file": "quic_security.ivy",
                            "instruction": "        require crypto_data_present(scid,e,cpos) -> crypto_data(scid,e).value(cpos) = byte;\n"
                        },
                        {
                            "line": 276,
                            "file": "quic_security.ivy",
                            "instruction": "        crypto_data_end(scid,e) := end;\n"
                        },
                        {
                            "line": 277,
                            "file": "quic_security.ivy",
                            "instruction": "\t    crypto_data(scid,e) := crypto_data(scid,e).set(cpos,byte);  # [4]\n"
                        },
                        {
                            "line": 278,
                            "file": "quic_security.ivy",
                            "instruction": "        crypto_data_present(scid,e,cpos) := true;\n"
                        },
                        {
                            "line": 279,
                            "file": "quic_security.ivy",
                            "instruction": "\t    jdx := jdx.next\n"
                        },
                        {
                            "line": 280,
                            "file": "quic_security.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 281,
                            "file": "quic_security.ivy",
                            "instruction": "    crypto_data_end(scid,e) := crypto_data(scid,e).end; # - 1;\n"
                        },
                        {
                            "line": 282,
                            "file": "quic_security.ivy",
                            "instruction": "    var max_present : stream_pos := 0;\n"
                        },
                        {
                            "line": 283,
                            "file": "quic_security.ivy",
                            "instruction": "    while max_present < crypto_data_end(scid,e) & crypto_data_present(scid,e,max_present) {\n"
                        },
                        {
                            "line": 284,
                            "file": "quic_security.ivy",
                            "instruction": "        max_present := max_present.next\n"
                        },
                        {
                            "line": 285,
                            "file": "quic_security.ivy",
                            "instruction": "    };\n"
                        },
                        {
                            "line": 286,
                            "file": "quic_security.ivy",
                            "instruction": "    #require conn_open(src,dcid);  # [3]\n"
                        },
                        {
                            "line": 287,
                            "file": "quic_security.ivy",
                            "instruction": "    var avail := crypto_data(scid,e).segment(crypto_handler_pos(scid,e),max_present);\n"
                        },
                        {
                            "line": 288,
                            "file": "quic_security.ivy",
                            "instruction": "    var res := tls.handshake_parser.deserialize(avail,0); #quicgo\n"
                        },
                        {
                            "line": 289,
                            "file": "quic_security.ivy",
                            "instruction": "    var hs := res.value;\n"
                        },
                        {
                            "line": 290,
                            "file": "quic_security.ivy",
                            "instruction": "    call tls.handshake_data_event(src,dst,avail.segment(0,res.pos));\n"
                        },
                        {
                            "line": 291,
                            "file": "quic_security.ivy",
                            "instruction": "    crypto_handler_pos(scid,e) := crypto_handler_pos(scid,e) + res.pos;\n"
                        },
                        {
                            "line": 292,
                            "file": "quic_security.ivy",
                            "instruction": "    var idx := hs.begin;\n"
                        },
                        {
                            "line": 293,
                            "file": "quic_security.ivy",
                            "instruction": "    while idx < hs.end {\n"
                        },
                        {
                            "line": 294,
                            "file": "quic_security.ivy",
                            "instruction": "        var h := hs.value(idx);\n"
                        },
                        {
                            "line": 295,
                            "file": "quic_security.ivy",
                            "instruction": "        call tls.handshake_event(src,dst,h);\n"
                        },
                        {
                            "line": 296,
                            "file": "quic_security.ivy",
                            "instruction": "        call handle_tls_handshake(src,dst,scid,dcid,h);  #[2]\n"
                        },
                        {
                            "line": 297,
                            "file": "quic_security.ivy",
                            "instruction": "        idx := idx.next\n"
                        },
                        {
                            "line": 298,
                            "file": "quic_security.ivy",
                            "instruction": "    };\n"
                        }
                    ],
                    "after": [
                        {
                            "line": 316,
                            "file": "quic_shim.ivy",
                            "instruction": "    call show_tls_send_event(src,dst,scid,dcid,data,pos,e, tls_id);\n"
                        }
                    ],
                    "around": []
                },
                "action_return": null,
                "action_parameters": [
                    {
                        "name": "src",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "dst",
                        "type": "ip.endpoint"
                    },
                    {
                        "name": "scid",
                        "type": "cid"
                    },
                    {
                        "name": "dcid",
                        "type": "cid"
                    },
                    {
                        "name": "data",
                        "type": "stream_data"
                    },
                    {
                        "name": "pos",
                        "type": "stream_pos"
                    },
                    {
                        "name": "e",
                        "type": "quic_packet_type"
                    },
                    {
                        "name": "tls_id",
                        "type": "tls_api.id"
                    }
                ],
                "exported": false,
                "events": false,
                "called_from": [
                    {
                        "caller_func": "show_tls_send_event",
                        "component": "quic_shim.ivy"
                    },
                    {
                        "caller_func": "tls_send_event",
                        "component": "quic_infer.ivy"
                    }
                ],
                "assertions_as_guarantees": {
                    "called_from": [
                        {
                            "caller_func": "infer_tls_events",
                            "component": "quic_infer.ivy"
                        }
                    ],
                    "assertions": []
                },
                "assertions_as_assumption": {
                    "called_from": [],
                    "assertions": []
                }
            }
        },
        {
            "functions": [
                {
                    "name": "crypto_data(C:cid,L:quic_packet_type) : stream_data\n",
                    "comment": "",
                    "line": 204,
                    "file": "quic_security.ivy"
                },
                {
                    "name": "crypto_data_end(C:cid,L:quic_packet_type) : stream_pos\n",
                    "comment": "",
                    "line": 206,
                    "file": "quic_security.ivy"
                },
                {
                    "name": "crypto_length(C:cid,L:quic_packet_type) : stream_pos\n",
                    "comment": "",
                    "line": 207,
                    "file": "quic_security.ivy"
                },
                {
                    "name": "crypto_pos(C:cid,L:quic_packet_type) : stream_pos\n",
                    "comment": "",
                    "line": 208,
                    "file": "quic_security.ivy"
                },
                {
                    "name": "crypto_handler_pos(C:cid,L:quic_packet_type) : stream_pos\n",
                    "comment": "",
                    "line": 209,
                    "file": "quic_security.ivy"
                },
                {
                    "name": "conn_enc_level(E:ip.endpoint,C:cid) : quic_packet_type\n",
                    "comment": "",
                    "line": 210,
                    "file": "quic_security.ivy"
                }
            ],
            "relations": [
                {
                    "name": "crypto_data_present(C:cid,L:quic_packet_type,P:stream_pos)\n",
                    "comment": "",
                    "line": 205,
                    "file": "quic_security.ivy"
                },
                {
                    "name": "established_1rtt_keys(C:cid)\n",
                    "comment": "",
                    "line": 211,
                    "file": "quic_security.ivy"
                },
                {
                    "name": "established_0rtt_keys(C:cid)\n",
                    "comment": "",
                    "line": 212,
                    "file": "quic_security.ivy"
                },
                {
                    "name": "established_handshake_keys(C:cid)\n",
                    "comment": "",
                    "line": 213,
                    "file": "quic_security.ivy"
                },
                {
                    "name": "crypto_reset(C:cid)\n",
                    "comment": "",
                    "line": 214,
                    "file": "quic_security.ivy"
                }
            ]
        }
    ],
    "tls_protocol.ivy": [
        {
            "tls_name": "tls",
            "tls_object": [
                {
                    "name": "handshakes",
                    "type": "vector(handshake)\n",
                    "instance": true
                },
                {
                    "name": "handshake_parser",
                    "type": "deserializer(stream_pos,stream_data,handshakes,tls_deser)\n",
                    "instance": true
                }
            ],
            "tls_module": null,
            "actions": [
                {
                    "line": 41,
                    "action_name": "tls.handshake_data_event",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [
                            {
                                "line": 352,
                                "file": "quic_shim.ivy",
                                "instruction": "    if dst_is_generated_tls(dst) {\n"
                            },
                            {
                                "line": 353,
                                "file": "quic_shim.ivy",
                                "instruction": "        call tls_api.lower.recv(src_tls_id(dst),data,0); # TODO: fill in the encryption level\n"
                            },
                            {
                                "line": 354,
                                "file": "quic_shim.ivy",
                                "instruction": "    }\n"
                            }
                        ],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "src",
                            "type": "ip.endpoint"
                        },
                        {
                            "name": "dst",
                            "type": "ip.endpoint"
                        },
                        {
                            "name": "data",
                            "type": "stream_data"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [
                        {
                            "caller_func": "tls_api.lower.recv",
                            "component": "quic_shim.ivy"
                        },
                        {
                            "caller_func": "tls.handshake_data_event",
                            "component": "quic_security.ivy"
                        },
                        {
                            "caller_func": "tls.handshake_event",
                            "component": "quic_security.ivy"
                        },
                        {
                            "caller_func": "handle_tls_handshake",
                            "component": "quic_security.ivy"
                        }
                    ],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                },
                {
                    "line": 31,
                    "action_name": "tls.handshake_event",
                    "implementation": [],
                    "monitor": {
                        "before": [],
                        "after": [],
                        "around": []
                    },
                    "action_return": null,
                    "action_parameters": [
                        {
                            "name": "src",
                            "type": "ip.endpoint"
                        },
                        {
                            "name": "dst",
                            "type": "ip.endpoint"
                        },
                        {
                            "name": "h",
                            "type": "handshake"
                        }
                    ],
                    "exported": false,
                    "events": false,
                    "called_from": [],
                    "assertions_as_guarantees": {
                        "called_from": [],
                        "assertions": []
                    },
                    "assertions_as_assumption": {
                        "called_from": [],
                        "assertions": []
                    }
                }
            ]
        },
        {
            "functions": [],
            "relations": []
        }
    ],
    "ivy_quic_shim_client.ivy": [
        {
            "functions": [],
            "relations": []
        }
    ]
}