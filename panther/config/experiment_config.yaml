tests:
  - name: "QUIC Client-Server Communication Test"
    description: "Verify that the Picoquic client can communicate with the Picoquic server over Docker Compose network."
    protocol: "quic"  # Protocol name should match the folder name in plugins/
    network_environment: "docker_compose"  # Environment plugin name
    execution_environment: None 
    services:
      picoquic_server:
        name: "picoquic_server"  # Added 'name' key
        implementation: "picoquic"
        version: "rfc9000"
        parameters:
          role: "server"
        ports:
          - "4443:4443"
          - "8080:8080"  # Health check endpoint
      picoquic_client:
        name: "picoquic_client"  # Added 'name' key
        implementation: "picoquic"
        version: "rfc9000"
        parameters:
          role: "client"
          ticket-file: "/path/to/ticket.pem"  # Added 'ticket-file' if required
          target: "picoquic_server"  # Docker Compose service name
          message: "Hello from Picoquic Client!"
        ports:
          - "5000:5000"  # Example port if needed
          - "8081:8081"  # Changed to avoid port conflict
    steps:
      wait:
        duration: 10  # seconds to wait during the test
    assertions:
      - type: "service_responsive"
        service: "picoquic_server"
        endpoint: "8080/health"  # Adjust based on health endpoint
        expected_status: 200
      - type: "service_responsive"
        service: "picoquic_client"
        endpoint: "8081/health"  # Adjust based on health endpoint
        expected_status: 200