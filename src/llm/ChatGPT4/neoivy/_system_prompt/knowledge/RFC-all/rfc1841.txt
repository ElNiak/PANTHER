





Network Working Group                                         J. Chapman
Request For Comments: 1841                           Cisco Systems, Inc.
Category: Informational                                          D. Coli
                                                     Cisco Systems, Inc.
                                                               A. Harvey
                                                     Cisco Systems, Inc.
                                                               B. Jensen
                                                     Cisco Systems, Inc.
                                                               K. Rowett
                                                     Cisco Systems, Inc.
                                                          September 1995


            PPP Network Control Protocol for LAN Extension

Status of Memo

   This memo provides information for the Internet community.  This memo
   does not specify an Internet standard of any kind.  Distribution of
   this memo is unlimited.

Abstract

   Telecommunications infrastructure is improving to offer higher
   bandwidth connections at lower cost. Access to the network is
   changing from modems to more intelligent devices. This informational
   RFC discusses a PPP Network Control Protocol for one such intelligent
   device. The protocol is the LAN extension interface protocol.

Table of Contents

   1.0    Introduction ...........................................    3
      1.1   LAN Extension Interface Topology .....................    4
      1.2   LAN Extension Interface Architecture .................    5
      1.3   LAN Extension Interface Protocol .....................    6

   2.0    LAN Extension Interface Protocol Control Packets........    8
      2.1   Startup Options ......................................    8
      2.2   Remote Command Options ...............................   14
      2.3   Conditions for Sending PPP-LEX Packet ................   17

   3.0    Filter Protocol Type ...................................   18
      3.1   LEX_RCMD_REQUEST - Filter Protocol Type...............   19
      3.2   Response Packets - Filter Protocol Type...............   21

   4.0    Filter MAC Address .....................................   22
      4.1   LEX_RCMD_REQUEST - Filter MAC Address ................   23
      4.2   Response Packets - Filter MAC Address.................   25



Chapman, et al               Informational                      [Page 1]

RFC 1841           LAN Extension Interface Protocol       September 1995


   5.0    Set Priority ...........................................   27
      5.1   LEX_RCMD_REQUEST - Set Priority ......................   27
      5.2   Response Packets - Set Priority ......................   29

   6.0    Disable LAN Extension Ethernet Interface ...............   30
      6.1   LEX_RCMD_REQUEST - Disable LAN Extension
            Ethernet Interface ...................................   31
      6.2   Response Packets - Disable LAN Extension
            Ethernet Interface ...................................   32

   7.0    Enable LAN Extension Ethernet Interface ................   33
      7.1   LEX_RCMD_REQUEST - Enable LAN Extension
            Ethernet Interface ...................................   33
      7.2   Response Packets - Enable LAN Extension
            Ethernet Interface ...................................   34

   8.0    Reboot LAN Extension Interface Unit ....................   35
      8.1   LEX_RCMD_REQUEST - Reboot LAN Extension Interface
            Unit .................................................   35
      8.2   Response Packets - Reboot LAN Extension
            Interface Unit .......................................   36

   9.0    Request Statistics .....................................   37
      9.1   LEX_RCMD_REQUEST - Request Statistics ................   37
      9.2   LEX_RCMD_ACK - Request Statistics ....................   39
      9.3   LEX_RCMD_NAK/LEX_RCMD_REJ - Request Statistics .......   44

   10.0    Download Request ......................................   45
      10.1   LEX_RCMD_REQUEST - Download Request .................   46
      10.2   Response Packets - Download Request..................   48

   11.0    Download Data .........................................   49
      11.1   LEX_RCMD_REQUEST - Download Request .................   49
      11.2   Response Packets - Download Data ....................   51

   12.0    Download Status .......................................   52
      12.1   LEX_RCMD_REQUEST - Download Status ..................   53
      12.2   LEX_RCMD_ACK - Download Status ......................   54
      12.3   LEX_RCMD_NAK/LEX_RCMD_REJ - Download Status .........   56

   13.0    Inventory Request .....................................   56
      13.1   LEX_RCMD_REQUEST - Inventory Request ................   57
      13.2   LEX_RCMD_ACK - Inventory Request ....................   58
      13.3   LEX_RCMD_NAK/LEX_RCMD_REJ - Inventory Request .......   61

   14.0    LAN Extension Interface Protocol Data Packets .........   62
      14.1   Frame Format ........................................   62
      14.2   Summary Field Descriptions...........................   63



Chapman, et al               Informational                      [Page 2]

RFC 1841           LAN Extension Interface Protocol       September 1995


   NOTES ......................................................      65
   REFERENCES .................................................      65
   SECURITY CONSIDERATIONS ....................................      66
   AUTHORS' ADDRESSES .........................................      66

1.0 Introduction

   An increasing number of corporations allow their employees to
   telecommute to work due to local government regulations on traffic
   and air pollution. Additionally, many businesses are run out of
   internetworked home offices and small branch offices. With these
   changes in the workplace, more people and businesses require Internet
   access from small LANs.

   Today, routers serve the LAN-to-LAN traffic using high-speed WAN
   links such as leased lines, ISDN, or Frame Relay. This new breed of
   Internet users from home offices and small branch offices may have a
   different, less network-literate skill set than those connecting up
   to the Internet today. These new users need an alternative to the
   complex and hard-to-configure routers currently employed for
   connectivity. One such alternative is a LAN extension interface unit.

   A LAN extension interface unit is a hardware device installed at
   remote sites (such as a home office or small branch office) that
   connects a LAN across a WAN link to a router at a central site. The
   following sections introduce a LAN extension interface topology,
   architecture, and protocol.
























Chapman, et al               Informational                      [Page 3]

RFC 1841           LAN Extension Interface Protocol       September 1995


1.1 LAN Extension Interface Topology

   Figure 1 shows the topology of LAN extension interfaces. The figure
   shows two LAN extension interface units connected via a WAN link to a
   central or "host router."

                 Figure 1 LAN Extension Interface Topology

                  -----------------------------------------
                                    Router
                  -----------------------------------------
                     Virtual Interface   Virtual Interface
                        123.123.78.1        123.123.89.1
                  .........................................
                           Serial 0           Serial n
                  -----------------------------------------
                             |<---- WAN Link ---->|
                ------------------                    ------------------
                | LAN Extension  |                    | LAN Extension  |
                | Interface Unit |                    | Interface Unit |
                ------------------                    ------------------
                        |                                     |
                ------------------                    ------------------
                  |                                      |
                ------------                          ------------
                | End node |                          | End node |
                ------------                          ------------
                123.123.78.2                          123.123.46.2

   Each LAN extension interface unit maps to a virtual interface at the
   host router. The virtual interface mirrors the characteristics of the
   LAN extension interface unit. To the routing protocols, the virtual
   interface looks just like a local interface, but with the bandwidth
   of a serial line. The virtual interface keeps the state (up or down)
   of the LAN extension interface unit, and identifies each LAN
   extension interface unit by its MAC address.

   A LAN extension interface protocol transfers MAC frames from the LAN
   extension interface unit across the serial line to the host router.
   At the termination point in the router, the router routes the
   packets. This topology uses only one subnet per remote LAN rather
   than two, as is the case when routers exist on both ends of a WAN
   link. Figure 1 shows this subnetting structure. The IP addresses of
   the virtual interfaces on the router are in the same subnet as the IP
   addresses of the end nodes on the LAN of the LAN extension interface
   unit. The LAN extension interface unit itself has no IP address.





Chapman, et al               Informational                      [Page 4]

RFC 1841           LAN Extension Interface Protocol       September 1995


   LAN extension interface units resemble bridges, but with the
   following distinct differences:

   *  LAN extension interface units always depend on a host router.
      They cannot operate standalone or even back-to-back with other
      LAN extension interface units.

   *  LAN extension interface units need not employ any spanning tree
      algorithm.

   *  (LAN extension interface units transfer MAC frames across a
      serial line (like bridges), but a router can either route or
      bridge the LAN extension interface data packets.

1.2 LAN Extension Interface Architecture

   Figure 2 shows the basic LAN extension interface architecture.

               Figure 2 LAN Extension Interface Architecture

                 Router                        LAN Extension Interface
          -------------------                  -------------------
          |   Network Layer |                  |     MAC Layer   |
          -------------------                  -------------------
                  |                                       |
          -------------------                  -------------------
     |    |Virtual Interface|                  |       Filters   |   |
     |    -------------------                  -------------------   |
     |            |                                 |                |
     |    -------------------                  -------------         |
     |    |      PPP        |                  |   RCMD    |         |
     |    |                 |                  |   Handler |         |
     |    -------------------                  -------------         |
     |            |                                 |                |
     |    -------------------                  -------------------   |
     |    |Serial Interface |                  |        PPP      |   |
     |    -------------------                  -------------------   |
     |            |                                      |           |
     |            |                            -------------------   |
     |            |                            | Serial Interface|   |
     |            |                            -------------------   |
     |            |          WAN Link                    |           |
     |            ---------------------------------------            |
     |                                                               |
     |   Outbound                                          Inbound   |
     -------------->                                  <---------------





Chapman, et al               Informational                      [Page 5]

RFC 1841           LAN Extension Interface Protocol       September 1995


   In the inbound direction (from the remote LAN, to the LAN extension
   interface unit, across the WAN link, to the host router), the LAN
   extension interface unit can filter received frames to optimize WAN
   utilization. The LAN extension interface unit can filter frames by
   protocol type or by MAC address. Frames that pass through the LAN
   extension interface filters go to the WAN protocol state machine. In
   Figure 2, this state machine is PPP. The LAN extension interface unit
   adds PPP encapsulation and forwards the packet to the router via the
   WAN serial link.

   Upon receiving the frame, the host router decapsulates the PPP header
   and passes the packet to the virtual interface. From there the
   virtual interface handles the packet like any packet received on a
   local interface -- by routing or bridging the packet to another
   interface, depending on configuration.

   In the outbound direction (from the host router, across the WAN link,
   to the LAN extension interface unit, to the LAN), the host router's
   virtual interface builds the full MAC header, before adding PPP
   encapsulation. The router then sends the packet across the WAN serial
   link to the LAN extension interface unit. The LAN extension interface
   unit strips the PPP header and forwards the packet directly onto the
   LAN. The host router has already determined that the packet needs to
   be forwarded to the LAN extension interface unit, hence there is no
   need for additional filtering or processing at that end.

   Embedded in the data stream is a control stream for configuring and
   managing the LAN extension interface unit from the host router. The
   virtual interface makes the remote LAN extension interface unit
   appear like a local router interface to the routing protocols.

   Configuration commands and statistics gathering commands are issued
   on the router to the virtual interface. The virtual interface formats
   the LAN extension interface remote commands into encoded messages and
   transfers them in-band with the data packets. The LAN extension
   interface unit decodes the remote commands and executes them.
   Responses are similarly formatted messages sent by the LAN extension
   interface unit to the host router. The remote command messages use a
   different encapsulation type than the data packets, as described
   later in this document in the "LAN Extension Interface Protocol
   Control Packets" and "LAN Extension Interface Protocol Data Packets"
   sections.

1.3 LAN Extension Interface Protocol

   To accommodate this LAN extension interface architecture, a new
   Network Control Protocol (NCP) for PPP exists. This NCP is called
   PPP-LEX. The basic functionality of PPP-LEX is to encapsulate LAN



Chapman, et al               Informational                      [Page 6]

RFC 1841           LAN Extension Interface Protocol       September 1995


   extension interface control and data packets. The IETF has assigned
   two new protocol types for these functions, as shown in Table 1.

                 Table 1  IETF Protocol Types for PPP-LEX

   Protocol Type       Function

   0x8041              Encapsulates control packets
   0x0041              Encapsulates data packets (MAC frames)

   PPP is a natural choice for a LAN extension interface protocol
   because it allows for negotiating a specific control protocol and
   options at connection time. This means that network administrators do
   not have to statically configure the router interface for remote
   interfaces. Rather, remote interfaces negotiate the link at
   connection time.

   The LAN extension interface protocol employs PPP link operation as
   described in RFC 1331, which reads as follows:

      In order to establish communications of a point-to-point link,
      each end of the PPP link must first send [Link Control Protocol]
      LCP packets to configure and test the data link. After the link
      has been established,the peer may be authenticated. Then PPP must
      send NCP packets to choose and configure one or more network layer
      protocols. Once each of the chosen network-layer protocols has
      been configured, datagrams from each network layer protocol can be
      sent over the link.

      The link will remain configured for communications until explicit
      LCP or NCP packets close the link down, or until some external
      event occurs (an inactivity timer expires or network administrator
      intervention). (References, [1])

   Thus, the LAN extension interface unit and the host router exchange
   PPP-LCP packets at connection time to dynamically configure and test
   the WAN serial link. Once the link reaches an "opened" state, the LAN
   extension interface unit and host router exchange PPP-LEX NCP packets
   to configure the LAN extension interface protocol. Once it is
   configured, the NCP (PPP-LEX) reaches an "opened" state, and PPP
   carries the PPP-LEX control and data packets across the serial link.
   At this point, link traffic is a any combination of LCPs, PPP-LEX
   NCPs, PPP-LEX control packets, and PPP-LEX data packets.

   Note that the LAN extension interface protocol is not a bridging
   protocol. The only similarity to the PPP Bridging Control Protocol
   (References. [2]) is that the LAN extension interface protocol also
   encapsulates MAC frames.



Chapman, et al               Informational                      [Page 7]

RFC 1841           LAN Extension Interface Protocol       September 1995


   The following sections detail PPP-LEX control packets and data
   packets.

2.0 LAN Extension Interface Protocol Control Packets

   There are two types of PPP-LEX control packets, as follows:

      *  Startup options packet
      *  Remote command options packets

   The startup options packet is the first PPP-LEX NCP packet that the
   LAN extension interface unit sends to the host router after the LCP
   has reached an "opened" state. This required startup options packet
   configures the LAN extension interface protocol and puts the PPP-LEX
   NCP in an "opened" state.

   Remote command options are the PPP-LEX NCP packets that control the
   functioning and statistics gathering of the LAN extension interface
   protocol.

2.1 Startup Options

   The LAN extension interface unit sends a startup options packet to
   the host router to negotiate the following startup options:

      *  MAC Type
      *  MAC Address
      *  LAN Extension

   The MAC Type startup option informs the host router of the type of
   media that the LAN extension interface unit is connected to. For
   example, the LAN extension interface unit may be connected to an
   Ethernet LAN or a Token Ring LAN. Currently, only Ethernet is
   supported. The MAC type tells the host router what type of traffic
   the LAN extension interface unit is prepared to receive. If the host
   router rejects the MAC type, the LAN extension interface unit sends
   the Configure-Request again.

   The MAC Address startup option sends the MAC address of the LAN
   extension interface unit to the host router to authenticate the LAN
   extension interface unit and bind it to the corresponding virtual
   interface at the host router. The host router also inserts the MAC
   address in outbound packets. The MAC address is represented in IEEE
   802.3 canonical format.

   The LAN Extension startup option establishes the network layer
   protocol (NCP) as PPP-LEX and provides the host router with the LAN
   extension interface protocol version number.



Chapman, et al               Informational                      [Page 8]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Each startup option is transmitted in a series of three fields:
   Option-Type, Option-Length, and Option-Data fields. The fields are
   concatenated in the startup options Configure-Request packet.

   Frame Format

   Figure 3 shows a summary of the frame format for the startup options
   packet. The LAN extension interface unit sends this startup options
   packet to the host router. The LAN extension interface unit transmits
   these fields from left to right.

        Figure 3  Startup Options Frame Format (Configure-Request)

                     PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Address    |     Control   |          Protocol Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     (1 octet)          (1)                      (2)

               LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Code      |   Identifier  |             Length            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     (1 octet)         (1)                      (2)

            LAN Extension Interface Startup Options
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  | Option-Length |          Option-Data          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     (1 octet)          (1)

   Address

   This PPP-specified field is one octet and contains the binary
   sequence 11111111 (hexadecimal 0xFF), the All-Stations address. PPP
   does not assign individual station addresses. The All-Stations
   address must be recognized and received by all devices. For more
   information on this field, refer to "The Point-to-Point Protocol
   (PPP) for the Transmission of Multi-protocol Datagrams over Point-
   to-Point Links." (References, [1])





Chapman, et al               Informational                      [Page 9]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Control

   This PPP-specified field is one octet and contains the binary
   sequence 00000011 (hexadecimal 0x03), the Unnumbered Information (UI)
   command with the P/F bit set to zero.

   For more information on this field, refer to "The Point-to-Point
   Protocol (PPP) for the Transmission of Multi-protocol Datagrams over
   Point-to Point Links." (References, [1])

   Protocol-Type

   The Protocol-Type field is two octets and contains the IETF-assigned
   protocol type value. Valid LAN extension interface protocol type
   values are as follows:

      *  0x8041 (for control packets)
      *  0x0041 (for data packets)

   Because the startup options packet encapsulates LAN extension
   interface control data, the valid value for this field is 0x8041.

   Code

   The Code field is one octet and identifies the type of LCP packet
   that the LAN extension interface packet is sending. Valid values are
   as follows:

      *  0x01 - Configure-Request
      *  0x02 - Configure-Ack
      *  0x03 - Configure-Nak
      *  0x04 - Configure-Rej

   The LAN extension interface unit initiates the startup options
   packet; therefore, the valid value for this field is 1.

   Identifier

   The Identifier field is one octet and contains a randomly generated
   value. The value aids matching requests and replies. It is
   recommended that a non-zero value be used for the identifier. That
   is, zero could be used in the future for unsolicited messages from
   the LAN extension interface unit. Valid values are 0x01-0xFF.








Chapman, et al               Informational                     [Page 10]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Length

   The Length field is two octets and indicates the length of the entire
   packet in octets, including the Code, Identifier, Length, and startup
   options fields.

   Option-Type

   The Option-Type field is one octet and identifies the startup option
   being negotiated. Valid values are as follows:

      *  0x01 - MAC Type
      *  0x03 - MAC Address
      *  0x05 - LAN Extension

   Option-Length

   The Option-Length field is one octet and specifies the length of the
   startup option fields, including the Option-Type, Option-Data, and
   Option-Length fields.

   Option-Data

   The Option-Data field contains the data relating to the value
   specified in the Option-Type field. That is, if the Option-Type field
   specifies MAC type (0x01), then the Option-Data field contains the
   MAC type (Ethernet, Token Ring, and so on). If the Option-Type field
   specifies MAC address (0x03), then the Option-Data field contains the
   actual MAC address. If the Option-Type field specifies LAN Extension
   (0x05), then the Option-Data field contains LAN extension interface
   software information. The following table defines the contents of the
   Option-Data field for each possible Option-Type field value:

   Option-Type Field Value   Option-Data

   0x01 (MAC Type)           The most up-to-date value of the MAC type as
                             specified in the most recent "Assigned
                             Numbers" RFC. The current valid value from
                             that RFC follows:
                             *  0x01: IEEE 802.3/Ethernet with canonical
                                addresses
   0x03 (MAC Address)        The burned-in MAC address in IEEE 802.3
                              canonical format.
   0x05 (LAN Extension)      The LAN extension interface protocol version
                             number. 0x01 is the current protocol version
                             supported.





Chapman, et al               Informational                     [Page 11]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Example

   In the Configure-Request packet that it sends to the host router, the
   LAN extension interface unit concatenates the Option-Type, Option-
   Data, and Option-Length fields for each startup option, as shown in
   Figure 4. The LAN extension interface unit transmits these fields
   from left to right.

         Figure 4 Sample Startup Options Configure-Request Packet

                         PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      0xFF     |      0x03     |             0x8041            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Address          Control             Protocol-Type

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     0x01      |      0x09     |             0x12              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   Option-Type      Identifier               Length

              LAN Extension Interface Startup Options
<------------------------------------------------
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      0x01     |               0x03            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   Option-Type             Option-Length

                                  ------------------------------>
                                  4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
                                 -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                               0x01             |
                                 -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                             Option-Data











Chapman, et al               Informational                     [Page 12]

RFC 1841           LAN Extension Interface Protocol       September 1995


 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      0x03     |               0x08            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   Option-Type             Option-Length        |

                                  4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
                                 -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                    0A  0A  0A  0A  0B  0C      |
                                 -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                 ---------- Option-Data --------|

 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      0x05     |               0x03            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   Option-Type             Option-Length

                                  4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
                                 -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                                0x01            |
                                 -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                           Option-Data

   In Figure 4, the Address field always contains 0xFF, and the Control
   field always contains 0x03. The Protocol-Type field value is 0x8041
   because the startup options packet is a LAN extension interface
   control packet. The Code field value is 0x01 because the LAN
   extension interface unit is sending an LCP Configure-Request packet
   to configure or negotiate PPP-LEX. The Identifier field contains a
   randomly generated number. The Length field gives the total length of
   the entire packet.

   The first startup option is the MAC Type startup option. The Option-
   Type value for MAC Type is 0x01. The Option-Length field value for
   the MAC type startup option is 3 octets. The Option-Data field value
   is 0x01 because, in this example, the LAN extension interface unit
   connects to an Ethernet LAN using 802.3 canonical addresses.

   The next startup option transmitted is the MAC Address. Its Option-
   Type field value is 0x03, its Option-Length field value is 8 octets,
   and its Option-Data field value is the actual MAC address.

   Lastly, the LAN Extension startup option is transmitted. Its Option-
   Type field value is 0x05, its Option-Length field value is 3 octets,
   and its Option-Data field value is the LAN extension interface
   protocol version number (0x01).




Chapman, et al               Informational                     [Page 13]

RFC 1841           LAN Extension Interface Protocol       September 1995


   The host router responds to this LCP Configure-Request packet with an
   LCP Configure-Ack packet, Configure-Nak packet, or Configure-Rej
   packet. For more information on these packets, refer to "The Point-
   to-Point Protocol (PPP) for the Transmission of Multi-protocol
   Datagrams over Point-to-Point Links" RFC. (References, [1])

2.2 Remote Command Options

   Once the host router responds to the startup options Configure-
   Request packet with a Configure-Ack packet, the PPP-LEX NCP is in an
   "opened" state, and the LAN extension interface unit and the host
   router freely exchange PPP-LEX data packets and remote command
   options packets.

   The host router initiates PPP-LEX remote command options packets to
   control the configuration of the LAN extension interface unit and to
   gather statistics. There are 11 types of remote command options that
   the host router can send in a LEX_RCMD_REQUEST packet to the LAN
   extension interface unit. The LAN extension interface unit responds
   to a LEX_RCMD_REQUEST packet with a LEX_RCMD_ACK, LEX_RCMD_NAK, or
   LEX_RCMD_REJ packet.

   Frame Format

   Figure 5 shows a summary of the frame format for a remote command
   options packet. These fields are transmitted from left to right.

               Figure 5 Remote Command Options Frame Format

                        PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Address    |     Control   |          Protocol Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     (1 octet)          (1)                      (2)

                  LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Code      |   Identifier  |             Length            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     (1 octet)          (1)                      (2)







Chapman, et al               Informational                     [Page 14]

RFC 1841           LAN Extension Interface Protocol       September 1995


               LAN Extension Interface Remote Command Options
<--------------------------------
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     (1 octet)          (1)

                 ---------------------------------------------->
                 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
                 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                          Option-Length        |  Option-Data  |
                 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                (2)

   Address

   This PPP-specified field is a single octet and contains the binary
   sequence 11111111 (hexadecimal 0xFF), the All-Stations address. PPP
   does not assign individual station addresses. The All-Stations
   address must be recognized and received by all devices. For more
   information on this field, refer to "The Point-to-Point Protocol
   (PPP) for the Transmission of Multi-protocol Datagrams over Point-
   to-Point Links." (References, [1])

   Control

   This PPP-specified field is a single octet and contains the binary
   sequence 00000011 (hexadecimal 0x03), the Unnumbered Information (UI)
   command with the P/F bit set to zero.

   For more information on this field, refer to "The Point-to-Point
   Protocol (PPP) for the Transmission of Multi-protocol Datagrams over
   Point-to Point Links." (References, [1])

   Note:  Hereafter the Address and Control fields will be represented
   together as a 2-octet field containing "0xFF03".

   Protocol-Type

   The Protocol-Type field is two octets and contains the IETF-assigned
   protocol type value. Valid LAN extension interface protocol type
   values follow:

      *  0x8041 (for control packets)
      *  0x0041 (for data packets)





Chapman, et al               Informational                     [Page 15]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Because the remote command options packet encapsulates LAN extension
   interface control data, the valid value for this field is 0x8041.

   Code

   The Code field is one octet and identifies the type of PPP-LEX
   packet. Valid values are as follows:

      *  0x40 - LEX_RCMD_REQUEST packet
      *  0x41 - LEX_RCMD_ ACK packet
      *  0x42 - LEX_RCMD_NAK packet
      *  0x43 - LEX_RCMD_REJ packet

   The host router sends the LEX_RCMD_REQUEST packet, and the LAN
   extension interface unit sends the LEX_RCMD_ACK, LEX_RCMD_NAK, and
   LEX_RCMD_REJ packets.

   Identifier

   The Identifier field is one octet and contains a randomly generated
   value. The value aids matching requests and replies. It is
   recommended that a non-zero value be used for the identifier. That
   is, zero could be used in the future for unsolicited messages from
   the LAN extension interface unit. Valid values are 0x01-0xFF.

   Length

   The Length field is two octets and indicates the length in octets of
   the entire packet, including the Code, Identifier, Length, and remote
   command options fields.

   Option-Type

   The Option-Type field is one octet and identifies the remote command
   option being transmitted. Valid values are as follows:

      *  0x01 - Filter Protocol Type
      *  0x02 - Filter MAC Address
      *  0x03 - Set Priority
      *  0x04 - Disable LAN Extension Ethernet Interface
      *  0x05 - Enable LAN Extension Ethernet Interface
      *  0x06 - Reboot LAN Extension Interface Unit
      *  0x07 - Request Statistics
      *  0x08 - Download Request
      *  0x09 - Download Data
      *  0x0A - Download Status
      *  0x0B- Inventory Request




Chapman, et al               Informational                     [Page 16]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Each remote command option is discussed in detail in its own section
   later in this document.

   Option-Flags

   This field is one octet and further specifies the remote command
   option, containing specific actions that must be followed.

   Option-Length

   The Option-Length field is two octets and specifies the length in
   octets of the remote command option fields, including the Option-
   Type, Option-Flags, Option-Length, and Option-Data fields.

   Option-Data

   Option-Data field contains data relating to the remote command option
   specified in the Option-Type field.

2.3 Conditions for Sending PPP-LEX Packet

   This section describes the general conditions under which PPP-LEX
   packet types are sent. For specific information by remote command,
   refer to the appropriate remote command section later in this
   document.

   LEX RCMD_REQUEST Packet

   The host router sends LEX_RCMD_REQUEST packets to the LAN extension
   interface unit to initiate a remote command request. Until the host
   router receives a LEX_RCMD_ACK, LEX_RCMD_NAK, or LEX_RCMD_REJ packet
   from the LAN extension interface unit, the host router continues to
   send the LEX_RCMD_REQUEST packet a default number of times, at which
   point the host router times out.

   LEX_RCMD_ACK Packet

   The LAN extension interface unit responds to a LEX_RCMD_REQUEST
   packet with a LEX_RCMD_ACK packet when it correctly receives the
   request and is able to perform the request.

   LEX RCMD_NAK Packet

   The LAN extension interface unit responds to a LEX_RCMD_REQUEST
   packet with a LEX_RCMD_NAK packet when the LAN extension interface
   unit recognizes all the elements of the remote command option, but
   some elements are not acceptable. Upon receipt of a LEX_RCMD_NAK
   packet, the host router immediately stops sending the request.



Chapman, et al               Informational                     [Page 17]

RFC 1841           LAN Extension Interface Protocol       September 1995


   LEX RCMD_REJ Packet

   The LAN extension interface unit responds to a LEX_RCMD_REQUEST
   packet with a LEX_RCMD_REJ packet when the Option-Type value in the
   request packet is invalid. Invalid Option-Type values are those less
   than 0x01 or greater than 0x0B. Currently, this is the only condition
   under which the LAN extension interface unit sends a LEX_RCMD_REJ
   packet. Upon receipt of a LEX_RCMD_REJ packet, the host router
   immediately stops sending the request.

   The following sections detail each of the 11 remote command options.
   The sections provide a general description of the option and then
   specify the option's Option-Type, Option-Flags, Option-Length, and
   Option-Data fields. In addition, the sections describe the return
   messages from the LAN extension interface unit.

3.0 Filter Protocol Type

   The host router sends a LEX_RCMD_REQUEST packet with an Option-Type
   of 0x01 to the LAN extension interface unit to configure the LAN
   extension interface unit to filter inbound packets by protocol type.
   A protocol type filter determines whether or not the LAN extension
   interface unit forwards packets of a specific protocol type to the
   host router. A protocol type filter consists of a 16-bit value, 16-
   bit mask, and a permit or deny field. (See the "Option-Data Field
   Descriptions" section for more information on these filter fields.)

   A LEX_RCMD_REQUEST packet can contain 0 to 200 (depending on MTU
   size) protocol type filters. When a LEX_RCMD_REQUEST packet contains
   multiple filters, they are concatenated.

   The LAN extension interface unit applies the protocol type filters to
   each inbound packet's protocol type field in the order in which the
   filters exist in the filter table. A packet must be permitted by one
   of the filters before the LAN extension interface unit can forward
   the packet across the serial link.

   The following example is a filtering algorithm:

   if (protocol_type_field & (~filter_mask)) == filter_value)
    if (permit/deny_field == PERMIT) <forward packet on serial LAN>
   else <DROP PACKET>

   The protocol type filter should also be applied to the DIX type code
   field of Ethernet II frames as well as to IEEE 802.2 SNAP packets.






Chapman, et al               Informational                     [Page 18]

RFC 1841           LAN Extension Interface Protocol       September 1995


3.1 LEX RCMD_REQUEST-Filter Protocol Type

   Figure 6 shows a frame format summary of a LEX_RCMD_REQUEST packet
   for the Filter Protocol Type remote command option. The host router
   transmits the fields from left to right.

   Figure 6 LEX_RCMD_REQUEST Packet Frame Format - Filter Protocol Type

                              PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |             Length            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)                    (2)

                   LAN Extension Interface Remote Command Options
<--------------------------------
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)

                 ---------------------------------------------->
                 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        Option-Length          |  Option-Data  |
                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                              (2)

   Where the Option-Data field contains the following fields:

 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Value (16 bits)       |          Value (16 bits)      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Permit/Deny (16 bits)     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




Chapman, et al               Informational                     [Page 19]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Summary Field Descriptions

   For a complete description of the fields in the PPP Header, the LAN
   Extension Interface Protocol Header, and the LAN Extension Interface
   Remote Command Options, refer to the "Remote Command Options" section
   earlier in this document. The following table provides a summary of
   these fields when sending a LEX_RCMD_REQUEST packet that configures
   the LAN extension interface unit to filter by protocol type.

   Table 2  Field Values for LEX_RCMD_REQUEST Packet-Filter Protocol Type
   Field               Value
   Address/Control     0xFF03 (Broadcast address/Unnumbered
                       information)
   Protocol-Type       0x8041 (Control packet)
   Code                0x40 (LEX_RCMD_REQUEST packet)
   Identifier          Valid values: 0x01-0xFF
   Length              Minimum length = 12 octets
                       Maximum length = 1212 octets
   Option-Type         0x01 (Filter Protocol Type)
   Option-Flags        None
   Option-Length       Minimum length = 4 octets
                       Maximum length = 1204 octets
   Option-Data         Zero or more filters to be applied at
                       the LAN extension interface unit. See the
                       following "Option-Data Field Descriptions"
                       for details.

   Option-Data Field Descriptions

   The following three Option-Data fields are used in conjunction to
   specify a protocol type filter:

   *  Value

   The Value field contains a 16-bit value that is any Ethernet type
   code. Refer to the "Assigned Numbers" RFC for valid Ethernet type
   codes. (References, [4]).

   *  Mask

   The Mask field contains a 16-bit "wild card" mask. That is, this
   field contains a 16-bit number whose ones bits correspond to the type
   code bits to be ignored during the comparison. Thus, the mask
   excludes bits from the comparison in the protocol type filter.







Chapman, et al               Informational                     [Page 20]

RFC 1841           LAN Extension Interface Protocol       September 1995


   *  Permit/Deny

   The Permit/Deny field determines whether a protocol type filter
   permits or denies inbound frames to pass to the host router. A permit
   value is a non-zero value that allows frames of a specific protocol
   type to pass to the host router. A deny value is a zero value that
   does not allow frames of a specific protocol type to pass to the host
   router.

   Implementation Notes

   Each LEX_RCMD_REQUEST packet is a complete specification of all
   protocol type filters and replaces any previously established
   filters.

   Note the following special cases:

   *  A LEX_RCMD_REQUEST packet with an Option-Length field equal
      to four (without any filter entries) instructs the LAN extension
      interface unit to turn off protocol type filtering. All MAC
      protocol types are forwarded.

   *  A LEX_RCMD_REQUEST packet with a filter entry of 0x0000 in the
      Value field, 0xFFFF in the Mask field, and a positive value in the
      Permit/Deny field means that if previous filters in the filter list
      do not permit the inbound packet then this filter entry will. This
      filter entry is typically the last filter in a list of filters
      contained within the Option-Data field.

   *  A LEX_RCMD_REQUEST packet with a filter entry of 0x0000 in the
      Value field, 0xFFFF in the Mask field, and a zero in the
      Permit/Deny field, means that the LAN extension interface unit must
      deny all protocol types. This filter is typically the last filter in
      a list of filters contained within the Option-Data field.

3.2 Response Packets - Filter Protocol Type

   The following packets are valid responses to the Filter Protocol Type
   LEX_RCMD_REQUEST packet:

   *  LEX_RCMD_ACK - Filter Protocol Type

   The LAN extension interface unit sends a LEX_RCMD_ACK packet in
   response to the Filter Protocol Type LEX_RCMD_REQUEST packet when the
   LAN extension interface unit correctly receives the Filter Protocol
   Type remote command option and applies all filter entries to its
   filter table. All filter entries are returned to the host router in
   the LEX_RCMD_ACK packet.



Chapman, et al               Informational                     [Page 21]

RFC 1841           LAN Extension Interface Protocol       September 1995


   *  LEX_RCMD_NAK - Filter Protocol Type

   The LAN extension interface unit sends a LEX_RCMD_NAK packet in
   response to the Filter Protocol Type LEX_RCMD_REQUEST packet when the
   request contains an incorrect number of bytes in the filter or when
   there are no more filter entries available. The LAN extension
   interface unit continues to use the previous filter table (that is,
   the filter table that existed prior to the receipt of the request).
   The host router should signal an error to the user/network
   administrator. All filter entries are returned to the host router in
   the LEX_RCMD_NAK packet.

   *  LEX_RCMD-REJ - Filter Protocol Type

   See the "Conditions for Sending PPP-LEX Packets" section earlier in
   this document for more information on this packet type.

   Table 3 summarizes the field values of Filter Protocol Type
   LEX_RCMD_ACK, LEX_RCMD_NAK, and LEX_RCMD_REJ packets.

     Table 3  Field Values for Response Packets - Filter Protocol Type

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 Valid values:
                        * 0x41 (LEX_RCMD_ACK packet)
                        * 0x42 (LEX_RCMD_NAK packet)
                        * 0x43 (LEX_RCMD_REJ packet)
   Identifier           The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Length               The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Option-Type          0x01 (Filter Protocol Type)
   Option-Flags         None
   Option-Length        The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Option-Data          The filter entries sent in the
                        LEX_RCMD_REQUEST packet

4.0 Filter MAC Address

   The host router sends a LEX_RCMD_REQUEST packet with an Option-Type
   of 0x02 to the LAN extension interface unit to configure the LAN
   extension interface unit to filter inbound packets by source MAC
   address. A MAC address filter determines whether or not the LAN
   extension interface unit forwards packets with a specific source MAC



Chapman, et al               Informational                     [Page 22]

RFC 1841           LAN Extension Interface Protocol       September 1995


   address to the host router. A MAC address filter consists of MAC
   address, a MAC address mask, and a permit or deny field. (See the
   "Option-Data Field Descriptions" section later in this section for
   more information on these filter fields.)

   A LEX_RCMD_REQUEST packet can contain 0 to 100 (depending on MTU
   size) MAC address filters. When a LEX_RCMD_REQUEST packet contains
   multiple filters, they are concatenated.

   The LAN extension interface unit applies MAC address filters to each
   inbound packet's source MAC address in the order in which the filters
   exist in the filter entry list. A packet must be permitted by one of
   the filters before the LAN extension interface unit can forward the
   packet across the serial link.

4.1 LEX RCMD_REQUEST - Filter MAC Address

   Figure 7 shows a frame format summary of a LEX_RCMD_REQUEST packet
   for the Filter MAC Address remote command option. The host router
   transmits the fields from left to right.

    Figure 7 LEX_RCMD_REQUEST Packet Frame Format - Filter MAC Address

                            PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |              Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)                     (2)













Chapman, et al               Informational                     [Page 23]

RFC 1841           LAN Extension Interface Protocol       September 1995


                   LAN Extension Interface Remote Command Options
<--------------------------------
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)

                 ---------------------------------------------->
                 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
                 -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
                         Option-Length          |  Option-Data |
                 -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
                               (2)

Where the Option-Data field contains the following fields:

 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      MAC Address (48 bits)....
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      MAC Address Mask (48 bits)....
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Permit/Deny (16 bits)    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Summary Field Descriptions

   For a complete description of the fields in the PPP Header, the LAN
   Extension Interface Protocol Header, and the LAN Extension Interface
   Remote Command Options, refer to the "Remote Command Options" section
   earlier in this document. Table 4 provides a summary of these fields
   when sending a LEX_RCMD_REQUEST packet that configures the LAN
   extension interface unit to filter by source MAC address.

   Table 4  Field Values for LEX_RCMD_REQUEST Packet - Filter MAC Address

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 0x40 (LEX_RCMD_REQUEST packet)
   Identifier           Valid values: 0x01-0xFF
   Length               Minimum length = 12 octets
                        Maximum length = 1412 octets
   Option-Type          0x02 (Filter MAC Address)
   Option-Flags         None
   Option-Length        Minimum length = 4 octets



Chapman, et al               Informational                     [Page 24]

RFC 1841           LAN Extension Interface Protocol       September 1995


                        Maximum length = 1404 octets
   Option-Data          Zero or more filters to be applied at the
                        LAN extension interface unit. See the
                        following "Option-Data Field Description
                        section for details.

   Option-Data Field Descriptions

   The following three Option-Data fields are used in conjunction to
   specify a MAC address filter:

   *  MAC Address

   The MAC Address field contains a 48-bit IEEE 802.3 MAC address in
   canonical format.

   *  MAC Address Mask

   The MAC Address Mask field contains a "wild card" mask. The mask is a
   48-bit hexadecimal number whose ones bits correspond to the MAC
   address bits to be ignored during the comparison. The mask excludes
   bits from the comparison in the MAC address filter.

   *  Permit/Deny

   The Permit/Deny field determines whether or not a MAC address filter
   permits or denies inbound frames of a specific MAC address to pass to
   the host router. A permit value is a non-zero value that allows
   frames of a specific MAC address to pass to the host router. A deny
   value is a zero value that does not allow frames of a specific MAC
   address to pass to the host router.

   Implementation Notes

   Each LEX_RCMD_REQUEST packet is a complete specification of all MAC
   address filters and replaces any previously established filters.

   A LEX_RCMD_REQUEST packet with an Option-Length field equal to four
   (without any filter entries) instructs the LAN extension interface
   unit to turn off filtering. All MAC addresses, except local
   destination addresses cached in the self-learning filter, are
   forwarded.

4.2 Response Packets - Filter MAC Address

   The following packets are valid responses to the Filter MAC Address
   LEX_RCMD_REQUEST packet:




Chapman, et al               Informational                     [Page 25]

RFC 1841           LAN Extension Interface Protocol       September 1995


   *  LEX_RCMD_ACK - Filter MAC Address

   The LAN extension interface unit sends a LEX_RCMD_ACK packet in
   response to a Filter MAC Address LEX_RCMD_REQUEST packet when the LAN
   extension interface unit correctly receives the Filter MAC Address
   remote command option and applies the entries to its filter table.
   All MAC address filter entries are returned in the LEX_RCMD_ACK
   packet.

   *  LEX_RCMD_NAK - Filter MAC Address

   The LAN extension interface unit sends a LEX_RCMD_NAK packet in
   response to the Filter MAC Address LEX_RCMD_REQUEST packet when the
   request contains an incorrect number of bytes in the filter or when
   there are no more filter entries available. The LAN extension
   interface unit continues to use the previous filter table (that is,
   the filter table that existed prior to the receipt of the request).
   The host router should signal an error to the user/network
   administrator. All filter entries are returned in the LEX_RCMD_NAK
   packet.

   *  LEX_RCMD-REJ - Filter MAC Address

   See the "Conditions for Sending PPP-LEX Packets" section earlier in
   this document for more information on this packet type.

   Table 5 summarizes the field values of Filter MAC Address
   LEX_RCMD_ACK, LEX_RCMD_NAK, and LEX_RCMD_REJ packets.

      Table 5  Field Values for Response Packets - Filter MAC Address

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 Valid values:
                        * 0x41 (LEX_RCMD_ACK packet)
                        * 0x42 (LEX_RCMD_NAK packet)
                        * 0x43 (LEX_RCMD_REJ packet)
   Identifier           The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Length               The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Option-Type          0x02 (Filter MAC Address)
   Option-Flags         None
   Option-Length        The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Option-Data          The filter entries sent in the



Chapman, et al               Informational                     [Page 26]

RFC 1841           LAN Extension Interface Protocol       September 1995


                        LEX_RCMD_REQUEST packet

5.0 Set Priority

   The host router sends a LEX_RCMD_ REQUEST with an Option-Type of 0x03
   to the LAN extension interface unit to establish the sending priority
   of different protocol type packets from the LAN extension interface
   unit to host router. There are four levels of priority:

      *  High
      *  Medium
      *  Normal
      *  Low

   Packets are classified according to protocol type and then are queued
   to one of four output queues on the LAN extension interface unit that
   correspond to the above priority levels. When the LAN extension
   interface unit is ready to transmit a packet, it scans the priority
   queues in order, from the highest to lowest, to find the highest
   priority packet.

5.1 LEX RCMD_REQUEST - Set Priority

   To establish priority queues for each protocol type, the host router
   sends a Set Priority LEX_RCMD_REQUEST packet. Figure 8 shows a frame
   format summary of such a LEX_RCMD_REQUEST packet. The host router
   transmits the fields from left to right.

       Figure 8 LEX_RCMD_REQUEST Packet Frame Format - Set Priority

                            PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |              Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)                     (2)






Chapman, et al               Informational                     [Page 27]

RFC 1841           LAN Extension Interface Protocol       September 1995


                   LAN Extension Interface Remote Command Options
<--------------------------------
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)

                 ---------------------------------------------->
                 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
                 -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
                         Option-Length          |  Option-Data |
                 -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
                               (2)

   Where the Option-Data field contains the following fields:

 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Protocol Type (16 bits)   |    Protocol Value (16 bits)   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Summary Field Descriptions

   For a complete descriptions of the fields in the PPP Header, the LAN
   Extension Interface Protocol Header, and the LAN Extension Interface
   Remote Command Options, refer to the "Remote Command Options" section
   earlier in this document. The following table provides a summary of
   these fields when sending a LEX_RCMD_REQUEST packet that sets
   priority queuing.

     Table 6  Field Values for LEX_RCMD_REQUEST Packet - Set Priority

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 0x40 (LEX_RCMD_REQUEST packet)
   Identifier           Valid values: 0x01-0xFF
   Length               Minimum length = 12 octets
                        Maximum length = 1028 octets
   Option-Type          0x03 (Set Priority)
   Option-Flags         None
   Option-Length        Minimum length = 4 octets
                        Maximum length = 1020 octets
   Option-Data          Protocol Type and Priority Value. See the
                        following "Option-Data Field Description"
                        section for details.



Chapman, et al               Informational                     [Page 28]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Option-Data Field Descriptions

   The following Option-Data fields set the priority queuing of
   different protocol type packets.

   *  Protocol Type

   The Protocol Type field contains a 16-bit number that is any Ethernet
   type code. See the most recent "Assigned Numbers" RFC for the correct
   Ethernet type code.

   *  Priority Value

   The Priority Value field specifies the priority queue for the
   protocol type specified in the Protocol Type field. Valid values are
   as follows:

      - 0 - High priority queue
      - 1 - Medium priority queue
      - 2 - Normal priority queue
      - 3 - Low priority queue

   Sending a LEX_RCMD_REQUEST packet with an Option-Length of four (no
   priority entries) disables priority queuing. When disabled, the LAN
   extension interface unit transfers all packets at a normal (2)
   priority level. When a new priority is specified, it overwrites the
   previous setting.

5.2 Response Packets - Set Priority

   The following packets are valid responses to the Set Priority

   LEX_RCMD_REQUEST packet.

   *  LEX_RCMD_ACK - Set Priority

   See the "Conditions for Sending PPP-LEX Packets" section earlier in
   this document for more information on this packet type.

   *  LEX_RCMD_NAK - Set Priority

   The LAN extension interface unit sends a LEX_RCMD_NAK packet in
   response to the Set Priority LEX_RCMD_REQUEST packet when the request
   contains an incorrect number of bytes in the message, when necessary
   resources are not available, or when the specified priority is
   invalid.





Chapman, et al               Informational                     [Page 29]

RFC 1841           LAN Extension Interface Protocol       September 1995


   *  LEX_RCMD-REJ - Set Priority

   See the "Conditions for Sending PPP-LEX Packets" section earlier in
   this document for more information on this packet type.  Table 7
   summarizes the field values of Set Priority LEX_RCMD_ACK,
   LEX_RCMD_NAK, and LEX_RCMD_REJ packets.

         Table 7  Field Values for Response Packets - Set Priority

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 Valid values:
                        * 0x41 (LEX_RCMD_ACK packet)
                        * 0x42 (LEX_RCMD_NAK packet)
                        * 0x43 (LEX_RCMD_REJ packet)
   Identifier           A randomly generated value that aids in
                        matching requests with replies
   Length               Minimum length = 12 octets
                        Maximum length = 1028 octets
   Option-Type          0x03 (Set Priority)
   Option-Flags         None
   Option-Length        Minimum length = 4 octets
                        Maximum length = 1020 octets
   Option-Data          Protocol Type and Priority Value sent
                        in the LEX_RCMD_REQUEST packet

6.0 Disable LAN Extension Ethernet Interface

   The host router sends a LEX_RCMD_ REQUEST with an Option-Type of 0x04
   to the LAN extension interface unit to disable the LAN extension
   Ethernet interface. This remote command option stops data traffic
   from the LAN extension interface unit to the host router for
   troubleshooting or for reconfiguring the LAN extension interface
   unit. This remote command option only affects data traffic. PPP-LEX
   control packets can still be transferred over the serial link.














Chapman, et al               Informational                     [Page 30]

RFC 1841           LAN Extension Interface Protocol       September 1995


6.1 LEX RCMD_REQUEST - Disable LAN Extension Ethernet Interface

   Figure 9 shows a frame format summary of a LEX_RCMD_REQUEST packet
   for the Disable LAN Extension Ethernet Interface remote command
   option. The host router transmits the fields from left to right.

             Figure 9  LEX_RCMD_REQUEST Packet Frame Format -
                 Disable LAN Extension Ethernet Interface

                            PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |              Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)                     (2)

            LAN Extension Interface Remote Command Options
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |        Option-Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)                    (2)

   Summary Field Descriptions

   For complete descriptions of the fields in the PPP Header, the LAN
   Extension Interface Protocol Header, and the LAN Extension Interface
   Remote Command Option, refer to the "Remote Command Options" section
   earlier in this document. The following table provides a summary of
   these fields when sending a LEX_RCMD_REQUEST packet that disables the
   LAN extension interface unit.










Chapman, et al               Informational                     [Page 31]

RFC 1841           LAN Extension Interface Protocol       September 1995


           Table 8  Field Values for LEX_RCMD_REQUEST Packet -
                 Disable LAN Extension Ethernet Interface

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 0x40 (LEX_RCMD_REQUEST packet)
   Identifier           Valid values: 0x01-0xFF
   Length               12 octets
   Option-Type          0x04 (Disable LAN Extension Ethernet
                        Interface)
   Option-Flags         None
   Option-Length        4 octets
   Option-Data          None

6.2 Response Packets - Disable LAN Extension Ethernet Interface

   LEX_RCMD_ACK, LEX_RCMD_NAK, and LEX_RCMD-REJ packets are valid
   responses to the Disable LAN Extension Ethernet Interface
   LEX_RCMD_REQUEST packet. Refer to the "Conditions for Sending PPP-LEX
   Packets" section earlier in this document for more information on
   when the LAN extension interface unit sends each of these response
   packets. Note that the LAN extension interface unit sends the
   LEX_RCMD_ACK packet after shutting down the interface.

   Table 9 summarizes the field values of Disable LAN Extension Ethernet
   Interface LEX_RCMD_ACK, LEX_RCMD_NAK, and LEX_RCMD_REJ packets.

               Table 9  Field Values for Response Packets -
                 Disable LAN Extension Ethernet Interface

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 Valid values:
                        * 0x41 (LEX_RCMD_ACK packet)
                        * 0x42 (LEX_RCMD_NAK packet)
                        * 0x43 (LEX_RCMD_REJ packet)
   Identifier           The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Length               12 octets
   Option-Type          0x04 (Disable LAN Extension Ethernet
                        Interface)
   Option-Flags         None
   Option-Length        4 octets
   Option-Data          None



Chapman, et al               Informational                     [Page 32]

RFC 1841           LAN Extension Interface Protocol       September 1995


7.0 Enable LAN Extension Ethernet Interface

   The host router sends a LEX_RCMD_ REQUEST with an Option-Type of 0x05
   to the LAN extension interface unit to enable the LAN extension
   Ethernet interface. This remote command option allows LAN traffic to
   flow into the LAN extension interface unit after the interface has
   been disabled.

7.1 LEX RCMD_REQUEST - Enable LAN Extension Ethernet Interface

   Figure 10 shows a frame format summary of a LEX_RCMD_REQUEST packet
   for an Enable LAN Extension Ethernet Interface remote command option.
   The host router transmits the fields from left to right.

   Figure 10 LEX_RCMD_REQUEST Packet Frame Format - Enable LAN Extension
   Ethernet Interface

                            PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |              Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)                     (2)

            LAN Extension Interface Remote Command Options
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |        Option-Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)                    (2)

   Summary Field Descriptions

   For complete descriptions of the fields in the PPP Header, the LAN
   Extension Interface Protocol Header, and the LAN Extension Interface
   Remote Command Option, refer to the "Remote Command Options" section
   earlier in this document. Table 10 provides a summary of these fields
   when sending a LEX_RCMD_REQUEST packet that enables the LAN extension



Chapman, et al               Informational                     [Page 33]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Ethernet interface.

           Table 10  Field Values for LEX_RCMD_REQUEST Packet -
                  Enable LAN Extension Ethernet Interface

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 0x40 (LEX_RCMD_REQUEST packet)
   Identifier           Valid values: 0x01-0xFF
   Length               12octets
   Option-Type          0x05 (Enable LAN Extension Ethernet
                        Interface)
   Option-Flags         None
   Option-Length        4 octets
   Option-Data          None

7.2 Response Packets - Enable LAN Extension Ethernet Interface

   LEX_RCMD_ACK, LEX_RCMD_NAK, and LEX_RCMD-REJ packets are valid
   responses to the Enable LAN Extension Ethernet Interface
   LEX_RCMD_REQUEST packet. Refer to the "Conditions for Sending PPP-LEX
   Packets" section earlier in this document for more information on
   when the LAN extension interface unit sends each of these response
   packets. Note that the LAN extension interface unit sends the
   LEX_RCMD_ACK packet after enabling the interface.

   The frame format of the response packets mirrors that of the request.
   Table 11 summarizes the field values of Enable LAN Extension Ethernet
   Interface LEX_RCMD_ACK, LEX_RCMD_NAK, and LEX_RCMD_REJ packets.

              Table 11  Field Values for Response Packets -
                  Enable LAN Extension Ethernet Interface

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 Valid values:
                        * 0x41 (LEX_RCMD_ACK packet)
                        * 0x42 (LEX_RCMD_NAK packet)
                        * 0x43 (LEX_RCMD_REJ packet)
   Identifier           The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Length               12 octets
   Option-Type          0x05 (Enable LAN Extension Ethernet
                        Interface)



Chapman, et al               Informational                     [Page 34]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Option-Flags         None
   Option-Length        4 octets
   Option-Data          None

8.0 Reboot LAN Extension Interface Unit

   The host router sends a LEX_RCMD_REQUEST packet with an Option-Type
   of 0x06 to the LAN extension interface unit to cause the LAN
   extension interface unit to reboot itself. The Option-Flags field
   specifies the boot mode for the LAN extension interface unit. There
   are two boot modes:

   * The first boot mode (Option-Flag 0x00) is the default. The
     default boot mode causes the LAN extension interface unit to
     check for a valid Flash image and to boot from it if it exists.
     If a valid Flash image does not exist, the default boot mode
     causes the LAN extension interface unit to boot from the PROM
     image. Similarly, if the Flash image is bad, then the LAN
     extension interface unit recovers by booting from the PROM image.

   * The second boot mode (Option-Flag 0x01) forces the LAN extension
     interface unit to boot from the PROM image.

8.1 LEX RCMD_REQUEST - Reboot LAN Extension  Interface Unit

   Figure 11 shows a frame format summary of a LEX_RCMD_REQUEST packet
   for a Reboot LAN Extension Interface Unit remote command option. The
   host router transmits the fields from left to right.

             Figure 11 LEX_RCMD_REQUEST Packet Frame Format -
                    Reboot LAN Extension Interface Unit

                            PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)                   (2)




Chapman, et al               Informational                     [Page 35]

RFC 1841           LAN Extension Interface Protocol       September 1995


            LAN Extension Interface Remote Command Options
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |        Option-Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)                    (2)

   Summary Field Descriptions

   For complete descriptions of the fields in the PPP Header, the LAN
   Extension Interface Protocol Header, and the LAN Extension Interface
   Remote Command Option, refer to the "Remote Command Options" section
   earlier in this document. Table 12 provides a summary of these fields
   when sending a LEX_RCMD_REQUEST packet that instructs the LAN
   extension interface unit to reboot.

           Table 12  Field Values for LEX_RCMD_REQUEST Packet -
                    Reboot LAN Extension Interface Unit

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 0x40 (LEX_RCMD_REQUEST packet)
   Identifier           Valid values: 0x01-0xFF
   Length               12 octets
   Option-Type          0x06 (Reboot LAN Extension Interface Unit)
   Option-Flags         Valid values:
                        * 0x00 - Reboot from Flash image if it
                          exists. If not, reboot from PROM. (This
                          value does not force the LAN extension
                          interface unit to reboot from PROM.)
                        * 0x01 - Reboot from PROM explicitly.
   Option-Length        4 octets
   Option-Data          None

8.2 Response Packets - Reboot LAN Extension Interface Unit

   LEX_RCMD_ACK, LEX_RCMD_NAK, and LEX_RCMD-REJ packets are valid
   responses to the Reboot LAN Extension Interface Unit LEX_RCMD_REQUEST
   packet. Refer to the "Conditions for Sending PPP-LEX Packets" section
   earlier in this document for more information on when the LAN
   extension interface unit sends each of these response packets. Note
   that the LAN extension interface unit reboots after sending the
   LEX_RCMD_ACK packet.





Chapman, et al               Informational                     [Page 36]

RFC 1841           LAN Extension Interface Protocol       September 1995


   The frame format for the response packets mirrors that of the
   request. Table 13 summarizes the field values for Reboot LAN
   Extension Interface Unit LEX_RCMD_ACK, LEX_RCMD_NAK, and LEX_RCMD_REJ
   packets.

              Table 13  Field Values for Response Packets -
                    Reboot LAN Extension Interface Unit

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 Valid values:
                        * 0x41 (LEX_RCMD_ACK packet)
                        * 0x42 (LEX_RCMD_NAK packet)
                        * 0x43 (LEX_RCMD_REJ packet)
   Identifier           The same value as that sent in the
                        LEX_RCMD_REQUEST packet
   Length               12 octets
   Option-Type          0x06 (Reboot LAN Extension Interface Unit)
   Option-Flags         Valid values:
                        * 0x00 - Reboot from Flash image if it
                          exists. If not, reboot from PROM. (This
                          value does not force the LAN extension
                          interface unit to reboot from PROM.)
                        * 0x01 - Reboot from PROM explicitly.
   Option-Length        4 octets
   Option-Data          None

9.0 Request Statistics

   The host router issues a LEX_RCMD_REQUEST packet with an Option-Type
   of 0x07 to obtain statistics information from the LAN extension
   interface unit. The host router may want statistics information about
   the following:

      *  Serial interface only
      *  LAN interface only
      *  Both the serial and LAN interfaces

   The host router may also send a Statistics Request LEX_RCMD_REQUEST
   packet to reset statistics in the LAN extension interface unit.

9.1 LEX RCMD_REQUEST - Request Statistics

   Figure 12 shows a summary frame format of a LEX_RCMD_REQUEST packet
   for a Statistics Request remote command option. The host router
   transmits the fields from left to right.



Chapman, et al               Informational                     [Page 37]

RFC 1841           LAN Extension Interface Protocol       September 1995


    Figure 12 LEX_RCMD_REQUEST Packet Frame Format - Request Statistics

                            PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |              Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        (1)             (1)                     (2)

            LAN Extension Interface Remote Command Option
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 0 1 2
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |        Option-Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)                    (2)

Summary Field Descriptions

   For complete descriptions of the fields in the PPP Header, the LAN
   Extension Interface Protocol Header, and the LAN Extension Interface
   Remote Command Option, refer to the "Remote Command Options" section
   earlier in this document. Table 14 provides a summary of these fields
   when sending a LEX_RCMD_REQUEST packet that requests statistics of
   the LAN extension interface unit.

           Table 14  Field Values for LEX_RCMD_REQUEST Packet -
                            Request Statistics

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 0x40 (LEX_RCMD_REQUEST packet)
   Identifier           Valid values: 0x01-0xFF
   Length               12 octets
   Option-Type          0x07 (Request Statistics)
   Option-Flags         Valid values:
                        * 0x01 - Resets serial statistics in the LAN



Chapman, et al               Informational                     [Page 38]

RFC 1841           LAN Extension Interface Protocol       September 1995


                          extension interface unit
                        * 0x02 - Returns serial statistics from the
                          LAN extension interface unit
                        * 0x04 - Returns LAN statistics from the LAN
                          extension interface unit
                        * 0x08 - Resets LAN statistics in the LAN
                        * extension interface unit
                        If both serial and LAN statistics are
                        desired, the corresponding bits of this
                        field should be set (that is, 0x06). The
                        serial interface statistics appear in the
                        response packet before the LAN statistics.
   Option-Length        4 octets
   Option-Data          None

9.2 LEX RCMD_ACK - Request Statistics

   The normal response to a Statistics Request LEX_RCMD_REQUEST packet
   is a LEX_RCMD_ACK packet. This acknowledgment packet has an Option-
   Type, an Option-Flags, and an Option-Length field followed by one or
   two blocks of statistics data. The value in the Option-Flags field
   indicates whether the packet has one or two blocks of statistics. For
   more information on these values, see the following "Summary Field
   Descriptions" section.

   The frame format for the Statistics Request LEX_RCMD_ACK packet
   follows. The LAN extension interface unit transmits the fields from
   left to right.

      Figure 13 LEX_RCMD_ACK Packet Frame Format - Request Statistics

                            PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |              Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        (1)             (1)                     (2)





Chapman, et al               Informational                     [Page 39]

RFC 1841           LAN Extension Interface Protocol       September 1995


            LAN Extension Interface Remote Command Options
<--------------------------------
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)

                ----------------------------------------------->
                 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                       Option-Length          |  Option-Data   |
                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                              (2)

   Where the Option-Data fields contains one or both of the following
   statistics blocks:

   Serial Interface Statistics Block:

                       (32 bits)
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Input, Number of Packets Received                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Input, Number of CRC Erros                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Input, Number of Framing Errors                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Input, Number of Overruns                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Input, Number of Packets Dropped                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Input, Number of Frame Aborts                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Input, Number of Packets in Error                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Input, Number of Packets Dropped Due to Lack of   |
| Buffer Descriptors                                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Input, Time of Last Packet Received               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Input, Average Data Rate                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Input, Average Packet Rate                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Input, Number of Octets Received                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Input, Number of Packets Dropped Due to No Buffers|



Chapman, et al               Informational                     [Page 40]

RFC 1841           LAN Extension Interface Protocol       September 1995


+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Number of Packets Transmitted             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Number of Packets with Error Transmissions|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Number of Under-run Errors                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Number of Packets in Low Priority Queue   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Size of Low Priority Queue                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Number of Packets Dropped in Low Priority |
| Queue                                                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Number of Packets in Normal Priority Queue|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Size of Normal Priority Queue             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Number of Packets Dropped in Normal       |
| Priority Queue                                                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Number of Packets in Medium Priority Queue|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Size of Medium Priority Queue             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Number of Packets Dropped in              |
| Medium Priority Queue                                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Number of Packets in High Priority Queue  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Size of High Priority Queue               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Number of Packets Dropped in High         |
| Priority Queue                                                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Time of Last Packet Transmitted           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Number of Carrier Transitions             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Transmitted Data Rate                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Serial Line Output, Number of Octets Transmitted              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+






Chapman, et al               Informational                     [Page 41]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Lan Interface Statistics Block:

                        (32 bits)
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Number of Packets Received                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Number of Packets Received with CRC Errors         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Number of Packets Received with Framing Errors     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Number of Overruns                                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Number of Packets Dropped Due to Congestion        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Number of Frame Aborts                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Number of Broadcast Packets Received               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Number of Packets Received with Errors             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Number of Packets Dropped Due to Lack of Buffer    |
| Descriptors                                                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Number of Runts (Too Small Packets) Received       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Time of Last Packet Received                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Average Data Rate                                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Average Packet Rate                                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Number of Octets Received                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Input, Number of Packets Dropped Due to Lack of Buffers   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Output, Number of Packets Transmitted                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Output, Number of Packets Transmitted with Errors         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Output, Number of Under-runs                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Output, Number of Collisions (Ethernet)                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Output, Number of Packets in Queue                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



Chapman, et al               Informational                     [Page 42]

RFC 1841           LAN Extension Interface Protocol       September 1995


| LAN Output, Queue Size                                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Output, Number of Packets Dropped in Queue                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Output, Time of Last Packet Transmitted                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Output, Transmit Data Rate                                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Output, Transmit Packet Rate                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN Output, Number of Octets Transmitted                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| LAN, Number of Interface Resets                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Note:  Counts are cumulative since last counter reset. Time stamps
   are in milliseconds since last given event. Packet rates are in
   packets per second (averaged).

   Summary Field Descriptions

   For complete descriptions of the fields in the PPP Header, the LAN
   Extension Protocol Header, and the LAN Extension Remote Command
   Option, refer to the "Remote Command Options" section earlier in this
   document. The following table provides a summary of these fields for
   a LEX_RCMD_ACK packet that sends statistics to the host router.

    Table 15  Field Values for LEX_RCMD_ACK Packet - Request Statistics

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 0x41 (LEX_RCMD_ACK packet)
   Identifier           The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Length               Minimum length = 120 octets
                        Maximum length = 140 octets
   Option-Type          0x07 (Request Statistics)
   Option-Flags         The LAN extension interface unit always sets
                        this field to reflect the actions taken in
                        response to the LEX_RCMD_ACK packet. Valid
                        values:
                        * 0x01 - Reset serial statistics in the LAN
                          extension interface unit
                        * 0x02 - Return serial statistics from the
                          LAN extension interface unit
                        * 0x04 - Return LAN statistics from the LAN



Chapman, et al               Informational                     [Page 43]

RFC 1841           LAN Extension Interface Protocol       September 1995


                          extension interface unit
                        * 0x08 - Reset LAN statistics in the LAN
                          extension interface unit
                          If both serial and LAN statistics are
                          returned, the corresponding bits of this
                          field should are set (that is, 0x06). The
                          serial interface statistics appear in the
                          response packet before the LAN statistics.
   Option-Length        Minimum length = 116 octets
                        Maximum length = 136 octets
   Option-Data          The Serial Interface Statistics Block, the
                        LAN Interface Statistics Block, or both the
                        Serial Interface and LAN Interface
                        Statistics blocks. When the Option-Data
                        contains both blocks, the Serial Interface
                        Block precedes the LAN Interface Block.
                        Statistics values that the LAN extension
                        interface unit does not collect/support
                        are retuned with a value of zero.

   Implementation Notes

   If the LAN extension interface unit does not implement the capability
   of sending the serial and LAN interface statistics blocks separately,
   the implementation may always return both statistics blocks (with the
   Option-Flags and Option-Length fields containing the appropriate
   corresponding values).

   An implementation, such as a Token Ring LAN implementation, can
   collect a different set of statistics than shown above by defining a
   new statistics request type remote command option.

9.3 LEX RCMD_NAK/LEX RCMD_REJ - Request Statistics

   The LAN extension interface unit sends a LEX_RCMD_NAK packet when the
   Statistics Request LEX_RCMD_REQUEST packet did not specify the type
   of statistics the host router wants. That is, the request's Option-
   Flags field equals zero.

   Refer to the "Conditions for Sending PPP-LEX Packets" section earlier
   in this document for information on when the LAN extension interface
   unit sends a Request Statistics LEX_RCMD_REJ packet.

   The frame format for the LEX_RCMD_NAK and LEX_RCMD_REJ packets is the
   same as that of the Statistics Request LEX_RCMD_REQUEST packet. Table
   16 summarizes the appropriate field values for the Statistics Request
   LEX_RCMD_NAK and LEX_RCMD_REJ packets.




Chapman, et al               Informational                     [Page 44]

RFC 1841           LAN Extension Interface Protocol       September 1995


      Table 16  Field Values for LEX_RCMD_NAK/LEX_RCMD_REJ Packets -
                            Request Statistics

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 Valid values:
                        * 0x42 (LEX_RCMD_NAK packet)
                        * 0x43 (LEX_RCMD_REJ packet)
   Identifier           The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Length               12 octets
   Option-Type          0x07 (Request Statistics)
   Option-Flags         The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Option-Length        4 octets
   Option-Data          None

10.0 Download Request

   The host router sends a LEX_RCMD_REQUEST packet with an Option-Type
   of 0x08 to alert the LAN extension interface unit that the host
   router will be issuing a software download to Flash memory. When the
   LAN extension interface unit acknowledges the command, the host
   router starts sending download data.

























Chapman, et al               Informational                     [Page 45]

RFC 1841           LAN Extension Interface Protocol       September 1995


10.1 LEX RCMD_REQUEST - Download Request

   Figure 14 shows a summary frame format of a LEX_RCMD_REQUEST packet
   for a Download Request remote command option. The host router
   transmits the fields from left to right.

    Figure 14  LEX_RCMD_REQUEST Packet Frame Format - Download Request

                          PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |              Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        (1)             (1)                     (2)

            LAN Extension Interface Remote Command Option
<--------------------------------
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)

                ----------------------------------------------->
                 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        Option-Length          |  Option-Data  |
                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                              (2)

   Where the Option-Data field contains the following fields:

 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Block Number (16 bits)    |        File Size (32 bits)....
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Filename (Max. 64 octets).......
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




Chapman, et al               Informational                     [Page 46]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Summary Field Descriptions

   For a complete description of the fields in the PPP Header, the LAN
   Extension Interface Protocol Header, and the LAN Extension Interface
   Remote Command Option, refer to the "Remote Command Options" section
   earlier in this document. Table 17 provides a summary of these fields
   when sending a LEX_RCMD_REQUEST packet that informs the LAN extension
   interface unit of an upcoming software download to Flash memory.

   Table 17  Field Values for LEX_RCMD_REQUEST Packet - Download Request

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 0x40 (LEX_RCMD_REQUEST packet)
   Identifier           Valid values: 0x01-0xFF
   Length               Variable depending on size of filename in
                        the Filename field. Valid range:
                        Minimum length = 19 octets
                        Maximum length = 82 octets
   Option-Type          0x08 (Download Request)
   Option-Flags         None
   Option-Length        Variable depending on size of filename in
                        the Filename field. Valid range:
                        Minimum length = 11 octets
                        Maximum length = 74 octets
   Option-Data          Block Number, File Size, and Filename of
                        the code/image to be downloaded. See the
                        following "Option-Data Field Descriptions"
                        section for details.

   Option-Data Field Descriptions

   The Option-Data field contains the following fields:

   *  Block Number

   The Block Number field contains a value that identifies a contiguous
   group of code bits to be downloaded to the LAN extension interface
   unit. In the LEX_RCMD_REQUEST packet, the Block Number is always
   zero.

   *  File Size

   The File Size field contains the size (in octets) of the code to be
   downloaded to the LAN extension interface unit.




Chapman, et al               Informational                     [Page 47]

RFC 1841           LAN Extension Interface Protocol       September 1995


   *  Filename

   The Filename field contains the name of the image to be transferred
   to the LAN extension interface unit.

10.2 Response Packets - Download Request

   The following packets are valid responses to a Download Request
   LEX_RCMD_REQUEST packet:

   *  LEX_RCMD_ACK - Download Request

   Refer to the "Conditions for Sending PPP-LEX Packets" section earlier
   in this document for more information on when the LAN extension
   interface unit sends this packet.

   *  LEX_RCMD_NAK - Download Request

   The LAN extension interface unit sends a Download Request
   LEX_RCMD_NAK packet when the LAN Extension interface unit is
   currently programming Flash, when the File Size field value in the
   request is greater than the unit's available Flash bytes, when the
   LAN extension interface unit is out of memory, or when the Block
   Number field value in the request is not zero.

   *  LEX_RCMD_REJ - Download Request

   Refer to the "Conditions for Sending PPP-LEX Packets" section earlier
   in this document for more information on when the LAN extension
   interface unit sends this packet.

   Table 18 summarizes the field values of the Download Request
   LEX_RCMD_ACK, LEX_RCMD_NAK, and LEX_RCMD_REJ packets.

      Table 18  Field Values for Response Packets - Download Request

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 Valid values:
                        * 0x41 (LEX_RCMD_ACK packet)
                        * 0x42 (LEX_RCMD_NAK packet)
                        * 0x43 (LEX_RCMD_REJ packet)
   Identifier           The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Length               The same value as that sent by the
                        LEX_RCMD_REQUEST packet



Chapman, et al               Informational                     [Page 48]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Option-Type          0x08 (Download Request)
   Option-Flags         None
   Option-Length        The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Option-Data          Block Number, File Size, and Filename of
                        the code/image to be downloaded.

11.0 Download Data

   Once the host router receives a Download Request LEX_RCMD_ACK packet
   from the LAN extension interface unit, the host router downloads the
   data to be written to Flash memory by sending a LEX_RCMD_REQUEST
   packet with an Option-Type of 0x09. The host router sends multiple
   Download Data LEX_RCMD_REQUEST packets, each with 512 octets of
   Option-Data containing the binary data to be programmed into Flash
   memory.

   A packet containing Option-Data with less than 512 octets signals the
   end of the download data (that is, the end of tile). If the size of
   the file being downloaded is an even multiple of 512 bytes, then the
   last packet transferred should have an Option-Length of 6. That is,
   the last packet transferred should have Option-Data containing the
   Block Number field value but no data. A Block Number field value
   without data alerts the LAN extension interface unit that this is the
   last block to be transmitted.

11.1 LEX RCMD_REQUEST - Download Data

   The frame format for the Download Data LEX_RCMD_REQUEST packet is
   similar to a TFTP frame format. Figure 15 shows a summary frame
   format. The host router transmits the fields from left to right.

      Figure 15 LEX_RCMD_REQUEST Packet Frame Format - Download Data

                           PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)










Chapman, et al               Informational                     [Page 49]

RFC 1841           LAN Extension Interface Protocol       September 1995


                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |              Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        (1)             (1)                     (2)

            LAN Extension Interface Remote Command Option
<--------------------------------
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)

                ----------------------------------------------->
                 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        Option-Length          |  Option-Data  |
                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                              (2)

   Where the Option-Data field contains the following fields:

 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Block Number (16 bits)    |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|       Binary Download Data (Max. 512 octets).....             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Summary Field Descriptions

   For a complete descriptions of the fields in the PPP Header, the LAN
   Extension Interface Protocol Header, and the LAN Extension Interface
   Remote Command Option, refer to the "Remote Command Options" section
   earlier in this document. The following table provides a summary of
   these fields when sending a LEX_RCMD_REQUEST packet that download
   software to the LAN extension interface unit.

      Table 19  Field Values for LEX_RCMD_REQUEST Packet - Download Data

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 0x40 (LEX_RCMD_REQUEST packet)



Chapman, et al               Informational                     [Page 50]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Identifier           Valid values: 0x01-0xFF
   Length               Minimum length = 14 octets
                        Maximum length = 526 octets
   Option-Type          0x09 (Download Data)
   Option-Flags         None
   Option-Length        Minimum length = 6 octets (signals end of
                        data transfer for a file with a file size
                        of an even multiple of 512 bytes)
                        Maximum length = 518 octets
   Option-Data          Block Number and Download Data. See the
                        following "Option-Data Field Descriptions"
                        section for details.

   Option-Data Field Descriptions

   The following Option-Data fields provide the LAN extension interface
   unit with download data:

   *  Block Number

   The Block Number identifies the contiguous group of code bits to be
   downloaded. The host router automatically generates this number. The
   first Download Data packet gets a block number of one. The host
   router increments this Block Number value by one with every Download
   Data LEX_RCMD_REQUEST packet sent to the LAN extension interface
   unit. The maximum value of the Block Number is dependent on the
   unit's Flash memory size.

   *  Download Data

   The Download Data are the actual code bits being downloaded to the
   LAN extension interface unit. A maximum of 512 octets of download
   data can sent in one Download Data LEX_RCMD_REQUEST packet.

11.2 Response Packets - Download Data

   The following packets are valid responses to a Download Data
   LEX_RCMD_REQUEST packet:

   *  LEX_RCMD_ACK - Download Data

   Refer to the "Conditions for Sending PPP-LEX Packets" section earlier
   in the document for more information on this packet.








Chapman, et al               Informational                     [Page 51]

RFC 1841           LAN Extension Interface Protocol       September 1995


   *  LEX_RCMD_NAK - Download Data

   The LAN extension interface unit sends a Download Data LEX_RCMD_NAK
   packet when the LAN extension interface unit is not in the proper
   state or when accepting the data will over-run the download buffer.

   *  LEX_RCMD_REJ - Download Data

   Refer to the "Conditions for Sending PPP-LEX Packets" section earlier
   in the document for more information on this packet.

   Table 20 summarizes the field values of the Download Data
   LEX_RCMD_ACK, LEX_RCMD_NAK, and LEX_RCMD_REJ packets.

       Table 20  Field Values for Response Packets - Download Data

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 Valid values:
                        * 0x41 (LEX_RCMD_ACK packet)
                        * 0x42 (LEX_RCMD_NAK packet)
                        * 0x43 (LEX_RCMD_REJ packet)
   Identifier           The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Length               14 octets
   Option-Type          0x09 (Download Data)
   Option-Flags         None
   Option-Length        6 octets
   Option-Data          Block Number only

12.0 Download Status

   Upon completion of a Download Data sequence, the host router issues a
   LEX_RCMD_REQUEST packet with an Option-Type of 0x0A to request status
   of the success or failure of the download. A bad checksum of the
   image or a malfunctioning Flash memory could cause the download to
   fail.












Chapman, et al               Informational                     [Page 52]

RFC 1841           LAN Extension Interface Protocol       September 1995


12.1 LEX RCMD_REQUEST - Download Status

   Figure 16 shows the frame format summary of a LEX_RCMD_REQUEST packet
   for a Download Status remote command option. The host router
   transmits the fields from left to right.

    Figure 16  LEX_RCMD_REQUEST Packet Frame Format - Download Status

                           PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |              Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        (1)             (1)                     (2)

            LAN Extension Interface Remote Command Option
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |        Option-Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)                    (2)

   Summary Field Descriptions

   For a complete descriptions of the fields in the PPP Header, the LAN
   Extension Interface Protocol Header, and the LAN Extension Interface
   Remote Command Option, refer to the "Remote Command Options" section
   earlier in this document. Table 21 provides a summary of these fields
   when sending a LEX_RCMD_REQUEST packet that requests the download
   status of the LAN extension interface unit.

   Table 21  Field Values for LEX_RCMD_REQUEST Packet - Download Status

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 0x40 (LEX_RCMD_REQUEST packet)



Chapman, et al               Informational                     [Page 53]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Identifier           Valid values: 0x01-0xFF
   Length               12 octets
   Option-Type          0x0A (Download Status)
   Option-Flags         None
   Option-Length        4 octets
   Option-Data          None

12.2 LEX RCMD_REQUEST - Download Status

   When the LAN extension interface unit correctly receives the Download
   Status LEX_RCMD_REQUEST packet, it returns a LEX_RCMD_ACK packet
   containing the appropriate status information in the Option-Data
   field.

   Figure 17 shows the frame format for the Download Status LEX_RCMD_ACK
   packet. The LAN extension interface unit transmits the fields from
   left to right.

      Figure 17  LEX_RCMD_ACK Packet Frame Format - Download Status

                            PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |              Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        (1)             (1)                     (2)
















Chapman, et al               Informational                     [Page 54]

RFC 1841           LAN Extension Interface Protocol       September 1995


            LAN Extension Interface Remote Command Option
<--------------------------------
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)

                ----------------------------------------------->
                 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        Option-Length          |  Option-Data  |
                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                              (2)

   Where the Option-Data field contains the following fields:

 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Status (16 bits)       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Summary Field Descriptions

   For a complete descriptions of the fields in the PPP Header, the LAN
   Extension Interface Protocol Header, and the LAN Extension Interface
   Remote Command Option, refer to the "Remote Command Options" section
   earlier in this document. Table 22 provides a summary of these fields
   when sending a status information to the host router.

     Table 22  Field Values for LEX_RCMD_ACK Packet - Download Status

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 0x41 (LEX_RCMD_ACK packet)
   Identifier           The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Length               14 octets
   Option-Type          0x0A (Download Status)
   Option-Flags         None
   Option-Length        6 octets
   Option-Data          Status information. See the following
                        "Option-Data Field Descriptions" section
                        for details.





Chapman, et al               Informational                     [Page 55]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Option-Data Field Descriptions

   The Option-Data field uses the Status field to send the download
   status to the host router. The Status field reports the following
   status information:

      *  1 - Acknowledgment that no errors occurred
      *  3 - Sequence error occurred
      *  6 - Flash write error occurred
      *  7 - Checksum error

12.3 LEX RCMD_NAK/LEX RCMD_REJ - Download Status

   Refer to the "Conditions for Sending PPP-LEX Packets" section earlier
   in this document for information on when the LAN extension interface
   unit sends a Download Status LEX_RCMD_NAK packet and Download Status
   LEX_RCMD_REJ packet.

   The frame format for these two response packets mirror the frame
   format of the Download Status LEX_RCMD_REQUEST packet. Table 23
   summarizes the field values of the Download Status LEX_RCMD_NAK and
   LEX_RCMD_REJ packets.

   Table 23  Field Values for LEX_RCMD_NAK/LEX_RCMD_REJ Packets - Download
   Status

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 Valid values:
                        * 0x42 (LEX_RCMD_NAK packet)
                        * 0x43 (LEX_RCMD_REJ packet)
   Identifier           The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Length               12 octets
   Option-Type          0x0A (Download Status)
   Option-Flags         None
   Option-Length        4 octets
   Option-Data          None

13.0 Inventory Request

   The host router sends a LEX_RCMD_REQUEST packet with an Option-Type
   of 0x0B to the LAN extension interface unit to request inventory
   information. The host router may use this remote command option to
   accomplish the following:




Chapman, et al               Informational                     [Page 56]

RFC 1841           LAN Extension Interface Protocol       September 1995


   *  Distinguish between different versions of the LAN extension
      interface unit for determining their capabilities

   *  Determine whether a new version of Flash code should be downloaded

13.1 LEX RCMD_REQUEST - Inventory Request

   Figure 18 shows the frame format for a LEX_RCMD_REQUEST packet with
   an Inventory Request remote command option. The host router transmits
   the fields from left to right.

   Figure 18  LEX_RCMD_REQUEST Packet Frame Format - Inventory Request

                           PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |              Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        (1)             (1)                     (2)

            LAN Extension Interface Remote Command Option
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |        Option-Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)                    (2)

   Summary Field Descriptions

   For a complete description of the fields in the PPP Header, the LAN
   Extension Interface Protocol Header, and the LAN Extension Interface
   Remote Command Option, refer to the "Remote Command Options" section
   earlier in this document. Table 24 provides a summary of these fields
   when sending a LEX_RCMD_REQUEST packet that requests inventory
   information.






Chapman, et al               Informational                     [Page 57]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Table 24  Field Values for LEX_RCMD_REQUEST Packet-Inventory Request

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 0x40 (LEX_RCMD_REQUEST packet)
   Identifier           Valid values: 0x01-0xFF
   Length               12 octets
   Option-Type          0x0B (Inventory Request)
   Option-Flags         None
   Option-Length        4 octets
   Option-Data          None

13.2 LEX RCMD_ACK - Inventory Request

   When it correctly receives the Inventory Request remote command
   option and retrieves the inventory information, the LAN extension
   interface unit responds with an acknowledgment. This acknowledgment
   contains the requested inventory information in the Option-Data
   field.

   Figure 19 shows the frame format for the Inventory Request
   LEX_RCMD_ACK packet.

      Figure 19 LEX_RCMD_ACK Packet Frame Format - Inventory Request

                            PPP Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              0xFF03           |          Protocol-Type        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              (2 octets)                         (2)

                LAN Extension Interface Protocol Header
<-------------------------------------------------------------->
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Code     |   Identifier  |              Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        (1)             (1)                     (2)









Chapman, et al               Informational                     [Page 58]

RFC 1841           LAN Extension Interface Protocol       September 1995


            LAN Extension Interface Remote Command Option
<--------------------------------
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option-Type  |  Option-Flags |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         (1)            (1)

                ----------------------------------------------->
                 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        Option-Length          |  Option-Data  |
                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                              (2)

   Where the Option-Data field contains the following fields:

                            (32 bits)
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Flash Size                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Serial Number                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  HW Version   | PROM Major Ver| PROM Minor Ver|Flash Major Ver|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Flash Minor Ver|     FLAGS     | RAM Major Ver | RAM Minor Ver |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+   Mac Address (6 octets)      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Summary Field Descriptions

   For a complete description of the fields in the PPP Header, the LAN
   Extension Interface Protocol Header, and the LAN Extension Interface
   Remote Command Option, refer to the "Remote Command Options" section
   earlier in this document. Table 25 provides a summary of these fields
   when acknowledging a LEX_RCMD_REQUEST packet that requests inventory
   information.

    Table 25  Field Values for LEX_RCMD_ACK Packet - Inventory Request

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 0x41 (LEX_RCMD_ACK packet)



Chapman, et al               Informational                     [Page 59]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Identifier           The same value as that sent by
                        LEX_RCMD_REQUEST packet
   Length               34 octets
   Option-Type          0x0B (Inventory Request)
   Option-Flags         None
   Option-Length        26 octets
   Option-Data          Inventory data. See the following
                        "Option-Data Field Descriptions" section
                        for details.

   Option-Data Field Descriptions

   The Option-Data field of the LEX_RCMD_ACK packet uses the following
   fields to send inventory data to the host router about the LAN
   extension interface unit.

   *  Flash Size

   This field contains the LAN extension interface unit's Flash size in
   bytes.

   *  Serial Number

   This field provides the LAN extension interface unit's serial number.
   This is an unassigned, 32-bit number.

   *  HW Version

   This field contains the version number of the LAN extension interface
   hardware unit.

   *  PROM Major Ver

   This field contains part of the version number of the PROM image.
   "Major" indicates which major software release this revision belongs
   to. For example, if the PROM version number is 1.2, then the major
   version number is 1.

   *  PROM Minor Ver

   This field contains part of the version number of the PROM image.
   "Minor" indicates which minor software release this revision belongs
   to. For example, if the PROM version number is 1.2, then the minor
   version number is 2.







Chapman, et al               Informational                     [Page 60]

RFC 1841           LAN Extension Interface Protocol       September 1995


   *  Flash Major Ver

   This field contains the "major" version number of the Flash image.
   For example, if the Flash image version number is 1.2, then the major
   version number is 1.

   *  Flash Minor Ver

   This field contains the "minor" version number of the Flash image.
   For example, if the Flash image version number is 1.2, then the minor
   version number is 2.

   *  FLAGS

   FLAGS report the boot status of the LAN extension interface unit. The
   flags are as follows:

   - 0x01 - Running PROM image
   - 0x02 - Running Flash image
   - 0x04 - PROM image passed checksum
   - 0x08 - Flash image passed checksum

   *  RAM Major Ver

   This field contains the "major" version number of the running image
   in RAM. For example, if the RAM image version number is 1.2, then the
   major version number is 1.

   *  RAM Minor Ver

   This field contains the "minor" version number of the running image
   in RAM. For example, if the RAM image version number is 1.2, then the
   minor version number is 2.

   *  MAC Address

   The MAC Address is the LAN extension interface unit's burned-in MAC
   address in canonical format. This field is six octets.

13.3 LEX RCMD_NAK/LEX RCMD_REJ - Inventory Request

   Refer to the "Conditions for Sending PPP-LEX Packets" section earlier
   in this document for information on when the LAN extension interface
   unit sends an Inventory Request LEX_RCMD_NAK packet and Inventory
   Request LEX_RCMD_REJ packet.

   The frame format of these two response packets mirrors that of the
   request. Table 26 summarizes the field values for such Inventory



Chapman, et al               Informational                     [Page 61]

RFC 1841           LAN Extension Interface Protocol       September 1995


   Request LEX_RCMD_NAK/LEX_RCMD_REJ packets.

      Table 26  Field Values for LEX_RCMD_NAK/LEX_RCMD_REJ Packets -
                             Inventory Request

   Field                Value
   Address/Control      0xFF03 (Broadcast address/Unnumbered
                        information)
   Protocol-Type        0x8041 (Control packet)
   Code                 Valid values:
                        * 0x42 (LEX_RCMD_NAK packet)
                        * 0x43 (LEX_RCMD_REJ packet)
   Identifier           The same value as that sent by the
                        LEX_RCMD_REQUEST packet
   Length               12 octets
   Option-Type          0x0B (Inventory Request)
   Option-Flags         None
   Option-Length        4 octets
   Option-Data          None

14.0 LAN Extension Interface Protocol Data Packets

   When the PPP-LEX NCP is in an "opened" state, the LAN extension
   interface unit and the host router also exchange PPP-LEX data packets
   (as well as control packets). There is only one type of PPP-LEX data
   packet. This data packet is a subset of the PPP-BCP packet format.

   The format subsetting is such that a PPP-BCP implementation will
   successfully process a LAN extension interface protocol packet. The
   differences are as follows:

      *  LAN ID field will not be present.
      *  LAN FCS field will never be present (that is, the F flag will
         always be off [=0]).
      *  LAN ID flag (I) will always be off.
      *  Pad field for the serial link will never be present, and the
         count field will be 0.

   For detailed information on PPP-BCP packets, refer to the "PPP
   Bridging Control Protocol (BCP)" RFC. (References, [2])

14.1 Frame Format

   Figure 20 shows the frame format for a PPP-LEX data packet. The MAC
   frame is transferred except for the FCS field. The LAN extension
   interface unit computes the FCS for packets transferred to the LAN
   and strips the FCS for packets destined for the host router.




Chapman, et al               Informational                     [Page 62]

RFC 1841           LAN Extension Interface Protocol       September 1995


                Figure 20  PPP-LEX Data Packet Frame Format

    (8 bits)         (8 bits)      (8 bits)         (8 bits)
+-+-+-+-+-+-+-+-+
|   HDLC FLAG   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     0xFF      |      0x03     |             0x0041            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| F|I|Z|0| Pad  |    Mac Type   |    Destination MAC Address    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Destination MAC Address                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Source MAC Address                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Source MAC Address      |           Length/Type         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           LLC Data                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       ...                                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       (Serial) HDLC CRC       |  HDLC FLAG    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

14.2 Summary Field Descriptions

   HDLC FLAG

   HDLC Frame delimiter.

   0xFF

   This Address field contains the broadcast address.

   0x03

   This Control field contains unnumbered information.

   0x0041

   This field contains the IETF-assigned protocol type value for a
   PPP-LEX data packet. In this case this field will always contain
   0x0041.

   Flags

   The flags F, I, Z, 0 have the following meanings:





Chapman, et al               Informational                     [Page 63]

RFC 1841           LAN Extension Interface Protocol       September 1995


      * F: Set bit F if the LAN FCS field is present. Because PPP-LEX
        data packets do not contain the LAN FCS field, this bit should
        not be set (field=0).

      * I: Set bit I if the LAN ID field is present. Because PPP-LEX
        data packets do not contain the field, this bit should not be
        set (field=0).

      * Z: Set bit Z if IEEE 802.3 Pad must be zero filled to minimum
        size.

      * 0: Reserved, must be zero.

   Pad

   Any PPP frame may have padding inserted in the Optional Data Link
   Layer Padding field. The value tells the receiving system how many
   pad octets to strip off. The LAN extension interface protocol does
   not support the Optional Data Link Layer Padding field, so the
   value of this field should be zero.

   MAC Type

   This field contains the most up-to-date value of the MAC type as
   specified in the most recent "Assigned Numbers" RFC. The current
   value is as follows:

      *  1: IEEE 802.3/Ethernet with canonical addresses

   Destination MAC Address

   This field is 6 octets and contains the MAC address of the
   destination system as defined by IEEE. The MAC Type field defines
   the bit ordering.

   Source MAC Address

   This field is 6 octets and contains the MAC address of the
   destination system as defined by IEEE. The MAC Type field defines
   the bit ordering.

   Length/Type

   This field is any Ethernet protocol type (See RFC 1700 in the
   references "Assigned Numbers").  For IEEE 802.3 frames, this is a
   length field.





Chapman, et al               Informational                     [Page 64]

RFC 1841           LAN Extension Interface Protocol       September 1995


   LLC Data

   This field is the remainder of the MAC frame which is (or would be
   if it were present) protected by the LAN FCS.

   (Serial) HDLC CRC

   This is a 16 bit Cyclic Redundancy Check field.

   For complete information on the above fields and their relationship
   to PPP-BCP packets, refer to the "PPP Bridging Control Protocol
   (BCP)" RFC. (References, [2])

Notes

   1. The LAN extension interface protocol does allow the segmentation
      of individual LAN packets across the serial link. Each LAN
      packet must be transmitted across the serial link as one PPP-LEX
      encapsulation.

   2. MAC addresses in PPP-LEX packets should be in canonical format.

References

   [1] Simpson, W., "The Point-To-Point Protocol (PPP) for the
       Transmission of Multi-protocol Datagrams over Point-To-Point
       Links", RFC 1331, Daydreamer, May 1992.

   [2] Baker, F., and R. Bowen, "PPP Bridging Control Protocol (BCP)",
       RFC 1638, ACC, IBM, June 1994.

   [3] Lloyd, B., and W. Simpson, "PPP Authentication Protocols", RFC
       1334, Lloyd & Associates, Daydreamer, October 1992.

   [4] Reynolds, J., and J. Postel, "Assigned Numbers", STD 2, RFC 1700,
       USC/Information Sciences Institute, October 1994.

   [5] Reynolds, J., and J. Postel, "Standard for the transmission of IP
       datagrams over IEEE 802 networks", RFC 1042, USC/Information
       Sciences Institute, February 1988.











Chapman, et al               Informational                     [Page 65]

RFC 1841           LAN Extension Interface Protocol       September 1995


Security Considerations

   Security issues are not discussed in this memo.

Authors' Addresses

   Joelle Bafile Chapman, Technical Writer
   Cisco Systems, Inc.
   170 West Tasman Drive
   San Jose, CA 95134-1706

   EMail: joelle@cisco.com


   Dave Coli, Software Engineer
   Cisco Systems, Inc.
   170 West Tasman Drive
   San Jose, CA 95134-1706

   EMail: dcoli@cisco.com


   Andy Harvey, Software Engineer
   Cisco Systems, Inc.
   170 West Tasman Drive
   San Jose, CA 95134-1706

   EMail: agh@cisco.com


   Bent Jensen, Engineering Manager
   Cisco Systems, Inc.
   170 West Tasman Drive
   San Jose, CA 95134-1706

   EMail: bent@cisco.com


   Kevin Rowett, Software Engineer
   Cisco Systems, Inc.
   170 West Tasman Drive
   San Jose, CA 95134-1706

   EMail: krowett@cisco.com







Chapman, et al               Informational                     [Page 66]

